
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
        
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Solid and Procedural Texturing</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Texture.html">Texture</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Solid and Procedural Texturing</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Texture/Image_Texture.html">(Previous: Image Texture)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>10.5 Solid and Procedural Texturing</h2><p>


</p>
<p>Once one starts to think of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg> texture coordinates used by 2D
texture functions as quantities that can be computed by arbitrary functions
and not just from the parametric coordinates of the surface, it is
natural to generalize texture functions to be defined over 
3D domains (often called <em>solid textures</em>) rather than
just 2D <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg>.  One reason solid textures are particularly convenient is that all
objects have a natural 3D texture mapping&mdash;object space
position.  This is a substantial advantage for texturing objects that don&rsquo;t
have a natural 2D parameterization (e.g., triangle meshes and
implicit surfaces) and for objects that have a distorted parameterization
(e.g., near the poles of a sphere).  In preparation for this idea,
Section&nbsp;<a href="../Texture/Texture_Coordinate_Generation.html#sec:3d-texture-mapping">10.2.5</a> defined a general
<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping3D"><tt>TextureMapping3D</tt></a> interface to compute 3D texture coordinates as well
as a <a href="../Texture/Texture_Coordinate_Generation.html#TransformMapping3D"><tt>TransformMapping3D</tt></a> implementation.

</p>
<p>Solid textures introduce a new problem, however: texture representation.  A
3D image map takes up a fair amount of storage space and is
much harder to acquire than a 2D texture map, which can be
extracted from photographs or painted by an artist.  Therefore, procedural
texturing&mdash;the idea that programs could be executed to generate texture
values at arbitrary positions on surfaces in the scene&mdash;came into use at
the same time that solid texturing was developed.  A simple example of
procedural texturing is a procedural sine wave.  If we wanted to use a sine
wave for bump mapping (for example, to simulate waves in water), it would
be inefficient and potentially inaccurate to precompute values of the function at a
grid of points and then store them in an image map.  Instead, it makes much more
sense to evaluate the <tt>sin()</tt> function at points on the surface as
needed.

</p>
<p>If we can find a 3D function that describes the colors of
the grain in a solid block of wood, for instance, then we can generate images
of complex objects that appear to be carved from wood.  Over the years,
procedural texturing has grown in application considerably as techniques have
been developed to describe more and more complex surfaces procedurally.

</p>
<p>Procedural texturing has a number of interesting implications.
First, it can be used to reduce memory requirements for rendering, by
reducing the need for the storage of large, high-resolution texture maps.
In addition, procedural shading gives the promise of potentially infinite
detail; as the viewer approaches an object, the texturing function is
evaluated at the points being shaded, which naturally leads to the right
amount of detail being visible.  In contrast, image texture maps 
become blurry when the viewer is too close to them.  On the other hand,
subtle details of the appearance of procedural textures can be much more
difficult to control than when image maps are used.

</p>
<p>Another challenge with procedural textures is antialiasing.  Procedural
textures are often expensive to evaluate, and  sets of point samples that
fully characterize their behavior aren&rsquo;t available as they are
for image maps.  Because we would like to remove high-frequency
information in the texture function before we take samples from it, we need
to be aware of the frequency content of the various steps we take along the
way so we can avoid introducing high frequencies.  Although this sounds
daunting, there are a handful of techniques that work well to handle this
issue.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#UVTexture"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="UVTexture"></span><h3>10.5.1  UV Texture</h3><p>


</p>
<p>Our first procedural texture converts the surface&rsquo;s <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> coordinates
into the red and green components of a <a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum"><tt>Spectrum</tt></a>
(Figure&nbsp;<a href="#fig:uv-texture-example">10.17</a>).  It is especially useful when
debugging the parameterization of a new <a href="../Shapes/Basic_Shape_Interface.html#Shape"><tt>Shape</tt></a>, for example.  It is
defined in <a href="https://github.com/mmp/pbrt-v3/tree/master/src/textures/uv.h"><tt>textures/uv.h</tt></a> <span class="anchor" id="texturesuv.h"></span> and
<a href="https://github.com/mmp/pbrt-v3/tree/master/src/textures/uv.cpp"><tt>textures/uv.cpp</tt></a>.<span class="anchor" id="texturesuv.cpp"></span>

</p>
<p>
</p>
<span class="anchor" id="fig:uv-texture-example"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="uvtex.png" style="max-width: 100%; height: auto;" width=1369 height=1076>
</div>
<p>

</p>
<figcaption class="caption">Figure 10.17: The UV Texture Applied to 
All of <tt>pbrt</tt>&rsquo;s Quadric Shapes. <span class="legend">  The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
</g>
</svg> parameter is mapped to the
red channel, and the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 485.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
</g>
</svg> parameter is mapped to green.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-UVTextureDeclarations-0"></span><div class="fragmentname">&lt;&lt;UVTexture Declarations&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="UVTexture"></span>UVTexture : public <a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;<a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum" class="code">Spectrum</a>&gt; {
public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-UVTexturePublicMethods-0">UVTexture Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1072" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1072"><i></i></a><div id="fragbit-1072" class="collapse"><div class="fragmentcode">       UVTexture(std::unique_ptr&lt;TextureMapping2D&gt; <a href="#UVTexture::mapping" class="code">mapping</a>) : <a href="#UVTexture::mapping" class="code">mapping</a>(std::move(<a href="#UVTexture::mapping" class="code">mapping</a>)) { }
       <a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum" class="code">Spectrum</a> Evaluate(const <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> &amp;si) const {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> dstdx, dstdy;
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> st = <a href="#UVTexture::mapping" class="code">mapping</a>-&gt;<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping2D::Map" class="code">Map</a>(si, &amp;dstdx, &amp;dstdy);
           Float rgb[3] =
               { st[0] - std::floor(st[0]), st[1] - std::floor(st[1]), 0 };
           return <a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum" class="code">Spectrum</a>::FromRGB(rgb);
       }</div></div>
private:
    std::unique_ptr&lt;TextureMapping2D&gt; <span class="anchor" id="UVTexture::mapping"></span>mapping;
};</div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-UVTexturePublicMethods-0"></span><div class="fragmentname">&lt;&lt;UVTexture Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum" class="code">Spectrum</a> Evaluate(const <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> &amp;si) const {
    <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> dstdx, dstdy;
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> st = <a href="#UVTexture::mapping" class="code">mapping</a>-&gt;<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping2D::Map" class="code">Map</a>(si, &amp;dstdx, &amp;dstdy);
    Float rgb[3] =
        { st[0] - std::floor(st[0]), st[1] - std::floor(st[1]), 0 };
    return <a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum" class="code">Spectrum</a>::FromRGB(rgb);
}</div><p>


</p>
<p>

</p>
<p>
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Checkerboard"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="Checkerboard"></span><h3>10.5.2  Checkerboard</h3><p>


</p>
<p>The checkerboard is the canonical procedural texture
(Figure&nbsp;<a href="#fig:checkerboard-example">10.18</a>).  The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg> texture coordinates are
used to break up parameter space into square regions that are shaded with
alternating patterns.  Rather than just supporting checkerboards that switch
between two fixed colors, the implementation here allows the user to pass in
two textures to color the alternating regions.  The traditional black-and-white
checkerboard is obtained by passing two <a href="../Texture/Texture_Interface_and_Basic_Textures.html#ConstantTexture"><tt>ConstantTexture</tt></a>s.  Its
implementation is in the files <a href="https://github.com/mmp/pbrt-v3/tree/master/src/textures/checkerboard.h"><tt>textures/checkerboard.h</tt></a>
<span class="anchor" id="texturescheckerboard.h"></span> and
<a href="https://github.com/mmp/pbrt-v3/tree/master/src/textures/checkerboard.cpp"><tt>textures/checkerboard.cpp</tt></a>.
<span class="anchor" id="texturescheckerboard.cpp"></span>

</p>
<p>
</p>
<span class="anchor" id="fig:checkerboard-example"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="checkerboard-tex.png" style="max-width: 100%; height: auto;" width=671 height=527>
</div>
<p>

</p>
<figcaption class="caption">Figure 10.18: The Checkerboard Texture Applied to All
of <tt>pbrt</tt>&rsquo;s Quadric Shapes.</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-CheckerboardTextureDeclarations-0"></span><div class="fragmentname">&lt;&lt;CheckerboardTexture Declarations&gt;&gt;=&nbsp;<a href="#fragment-CheckerboardTextureDeclarations-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt; class <span class="anchor" id="Checkerboard2DTexture"></span>Checkerboard2DTexture : public <a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt; {
public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Checkerboard2DTexturePublicMethods-0">Checkerboard2DTexture Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1073" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1073"><i></i></a><div id="fragbit-1073" class="collapse"><div class="fragmentcode">       Checkerboard2DTexture(std::unique_ptr&lt;TextureMapping2D&gt; <a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>,
               const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>,
               const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>, <a href="#AAMethod::None" class="code">AAMethod</a> <a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a>)
           : <a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>(std::move(<a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>)), <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>(<a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>), <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>(<a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>),
             <a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a>(<a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a>) { }
       T Evaluate(const <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> &amp;si) const {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> dstdx, dstdy;
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> st = <a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>-&gt;<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping2D::Map" class="code">Map</a>(si, &amp;dstdx, &amp;dstdy);
           if (<a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a> == <a href="#AAMethod::None" class="code">AAMethod</a>::None) {
               &lt;&lt;<span class="fragmentname"><a href="#fragment-PointsamplemonoCheckerboard2DTexture-0">Point sample <tt>Checkerboard2DTexture</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1074" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1074"><i></i></a><div id="fragbit-1074" class="collapse"><div class="fragmentcode">                  if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
                      return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
                  return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div>
           } else {
               &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeclosed-formbox-filteredmonoCheckerboard2DTexturevalue-0">Compute closed-form box-filtered <tt>Checkerboard2DTexture</tt> value</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1075" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1075"><i></i></a><div id="fragbit-1075" class="collapse"><div class="fragmentcode">                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Evaluatesinglecheckiffilterisentirelyinsideoneofthem-0">Evaluate single check if filter is entirely inside one of them</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1076" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1076"><i></i></a><div id="fragbit-1076" class="collapse"><div class="fragmentcode">                     Float ds = std::max(std::abs(dstdx[0]), std::abs(dstdy[0]));
                     Float dt = std::max(std::abs(dstdx[1]), std::abs(dstdy[1]));
                     Float s0 = st[0] - ds, s1 = st[0] + ds;
                     Float t0 = st[1] - dt, t1 = st[1] + dt;
                     if (std::floor(s0) == std::floor(s1) &amp;&amp;
                         std::floor(t0) == std::floor(t1)) {
                         &lt;&lt;<span class="fragmentname"><a href="#fragment-PointsamplemonoCheckerboard2DTexture-0">Point sample <tt>Checkerboard2DTexture</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1077" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1077"><i></i></a><div id="fragbit-1077" class="collapse"><div class="fragmentcode">                            if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
                                return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
                            return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div>
                     }</div></div>
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Applyboxfiltertocheckerboardregion-0">Apply box filter to checkerboard region</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1078" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1078"><i></i></a><div id="fragbit-1078" class="collapse"><div class="fragmentcode">                     auto bumpInt = [](Float x) {
                         return (int)std::floor(x / 2) +
                                2 * std::max(x / 2 - (int)std::floor(x / 2) - (Float)0.5,
                                             (Float)0); };
                     Float sint = (bumpInt(s1) - bumpInt(s0)) / (2 * ds);
                     Float tint = (bumpInt(t1) - bumpInt(t0)) / (2 * dt);
                     Float area2 = sint + tint - 2 * sint * tint;
                     if (ds &gt; 1 || dt &gt; 1) 
                         area2 = .5f;
                     return (1 - area2) * <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si) +
                            area2       * tex2-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div></div></div>
           }
       }</div></div>
private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Checkerboard2DTexturePrivateData-0">Checkerboard2DTexture Private Data</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1079" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1079"><i></i></a><div id="fragbit-1079" class="collapse"><div class="fragmentcode">       std::unique_ptr&lt;TextureMapping2D&gt; mapping;
       const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; tex1, tex2;
       const AAMethod aaMethod;</div></div>
};</div><p>


</p>
<p>For simplicity, the frequency of the check function is 1 in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg> space:
checks are one unit wide in each direction.  The effective frequency can
always be changed by the <a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping2D"><tt>TextureMapping2D</tt></a> class with an appropriate
scale of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg> coordinates.

</p>
<p></p>
<span class="anchor" id="fragment-Checkerboard2DTexturePublicMethods-0"></span><div class="fragmentname">&lt;&lt;Checkerboard2DTexture Public Methods&gt;&gt;=&nbsp;<a href="#fragment-Checkerboard2DTexturePublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Checkerboard2DTexture(std::unique_ptr&lt;TextureMapping2D&gt; <a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>,
        const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>,
        const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>, AAMethod <a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a>)
    : <a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>(std::move(<a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>)), <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>(<a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>), <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>(<a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>),
      <a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a>(<a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a>) { }</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-Checkerboard2DTexturePrivateData-0"></span><div class="fragmentname">&lt;&lt;Checkerboard2DTexture Private Data&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">std::unique_ptr&lt;TextureMapping2D&gt; <span class="anchor" id="Checkerboard2DTexture::mapping"></span>mapping;
const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; <span class="anchor" id="Checkerboard2DTexture::tex1"></span>tex1, <span class="anchor" id="Checkerboard2DTexture::tex2"></span>tex2;
const AAMethod <span class="anchor" id="Checkerboard2DTexture::aaMethod"></span>aaMethod;</div><p>


</p>
<p>The checkerboard is good for demonstrating trade-offs
between various antialiasing approaches for procedural textures.  The
implementation here supports both simple point sampling (no antialiasing)
and a closed-form box filter evaluated over the filter region.  The image
sequence in Figure&nbsp;<a href="#fig:checkerboard-filtering">10.22</a> at the end of this
section shows the results of these approaches. The <tt>aaMethod</tt>
enumerant selects which approach is used.

</p>
<p></p>
<span class="anchor" id="fragment-AAMethodDeclaration-0"></span><div class="fragmentname">&lt;&lt;AAMethod Declaration&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">enum class <span class="anchor" id="AAMethod"></span>AAMethod { <span class="anchor" id="AAMethod::None"></span>None, <span class="anchor" id="AAMethod::ClosedForm"></span>ClosedForm };</div><p>


</p>
<p>The evaluation routine does the usual texture coordinate and differential
computation and then uses the appropriate fragment to compute an
antialiased checkerboard value (or not antialiased, if point sampling has been
selected).

</p>
<p></p>
<span class="anchor" id="fragment-Checkerboard2DTexturePublicMethods-1"></span><div class="fragmentname">&lt;&lt;Checkerboard2DTexture Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-Checkerboard2DTexturePublicMethods-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">T <span class="anchor" id="Checkerboard2DTexture::Evaluate"></span>Evaluate(const <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> &amp;si) const {
    <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> dstdx, dstdy;
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> st = <a href="#Checkerboard2DTexture::mapping" class="code">mapping</a>-&gt;<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping2D::Map" class="code">Map</a>(si, &amp;dstdx, &amp;dstdy);
    if (<a href="#Checkerboard2DTexture::aaMethod" class="code">aaMethod</a> == <a href="#AAMethod::None" class="code">AAMethod</a>::None) {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-PointsamplemonoCheckerboard2DTexture-0">Point sample <tt>Checkerboard2DTexture</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1080" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1080"><i></i></a><div id="fragbit-1080" class="collapse"><div class="fragmentcode">           if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
               return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
           return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div>
    } else {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeclosed-formbox-filteredmonoCheckerboard2DTexturevalue-0">Compute closed-form box-filtered <tt>Checkerboard2DTexture</tt> value</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1081" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1081"><i></i></a><div id="fragbit-1081" class="collapse"><div class="fragmentcode">           &lt;&lt;<span class="fragmentname"><a href="#fragment-Evaluatesinglecheckiffilterisentirelyinsideoneofthem-0">Evaluate single check if filter is entirely inside one of them</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1082" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1082"><i></i></a><div id="fragbit-1082" class="collapse"><div class="fragmentcode">              Float ds = std::max(std::abs(dstdx[0]), std::abs(dstdy[0]));
              Float dt = std::max(std::abs(dstdx[1]), std::abs(dstdy[1]));
              Float s0 = st[0] - ds, s1 = st[0] + ds;
              Float t0 = st[1] - dt, t1 = st[1] + dt;
              if (std::floor(s0) == std::floor(s1) &amp;&amp;
                  std::floor(t0) == std::floor(t1)) {
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-PointsamplemonoCheckerboard2DTexture-0">Point sample <tt>Checkerboard2DTexture</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1083" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1083"><i></i></a><div id="fragbit-1083" class="collapse"><div class="fragmentcode">                     if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
                         return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
                     return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div>
              }</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Applyboxfiltertocheckerboardregion-0">Apply box filter to checkerboard region</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1084" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1084"><i></i></a><div id="fragbit-1084" class="collapse"><div class="fragmentcode">              auto bumpInt = [](Float x) {
                  return (int)std::floor(x / 2) +
                         2 * std::max(x / 2 - (int)std::floor(x / 2) - (Float)0.5,
                                      (Float)0); };
              Float sint = (bumpInt(s1) - bumpInt(s0)) / (2 * ds);
              Float tint = (bumpInt(t1) - bumpInt(t0)) / (2 * dt);
              Float area2 = sint + tint - 2 * sint * tint;
              if (ds &gt; 1 || dt &gt; 1) 
                  area2 = .5f;
              return (1 - area2) * <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si) +
                     area2       * tex2-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div></div></div>
    }
}</div><p>


</p>
<p>The simplest case is to ignore antialiasing and just point-sample the
checkerboard texture at the point.  For this case, after
getting the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg> texture coordinates from the <a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping2D"><tt>TextureMapping2D</tt></a>, 
the integer checkerboard coordinates for that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2055.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis s comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1665" y="0"></use>
</g>
</svg> position 
are computed, added together, and checked for odd or even parity to
determine which of the two textures
 to evaluate.

</p>
<p></p>
<span class="anchor" id="fragment-PointsamplemonoCheckerboard2DTexture-0"></span><div class="fragmentname">&lt;&lt;Point sample <tt>Checkerboard2DTexture</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
    return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div><p>


</p>
<p>Given how bad aliasing can be in a point-sampled checkerboard texture, we will
invest some effort to antialias it properly.  The easiest case happens when
the entire filter region lies inside a single check
(Figure&nbsp;<a href="#fig:checkerboard-easy">10.19</a>).  In this case, we simply need to
determine which of the check types we are inside and evaluate that one.  As
long as the <a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture"><tt>Texture</tt></a> inside that check does appropriate antialiasing
itself, the result for this case will be properly antialiased.

</p>
<p></p>
<span class="anchor" id="fig:checkerboard-easy"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="Checkerboard%20easy%20case.svg" title=""><img src="Checkerboard%20easy%20case.svg" width=217 height=217 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 10.19: The Easy Case for Filtering the
Checkerboard. <span class="legend"> If the filter region around the lookup point is entirely in
one check, the checkerboard texture doesn&rsquo;t need to worry about
antialiasing and can just evaluate the texture for that check.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>
</p>
<span class="anchor" id="fragment-Computeclosed-formbox-filteredmonoCheckerboard2DTexturevalue-0"></span><div class="fragmentname">&lt;&lt;Compute closed-form box-filtered <tt>Checkerboard2DTexture</tt> value&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname"><a href="#fragment-Evaluatesinglecheckiffilterisentirelyinsideoneofthem-0">Evaluate single check if filter is entirely inside one of them</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1085" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1085"><i></i></a><div id="fragbit-1085" class="collapse"><div class="fragmentcode">   Float ds = std::max(std::abs(dstdx[0]), std::abs(dstdy[0]));
   Float dt = std::max(std::abs(dstdx[1]), std::abs(dstdy[1]));
   Float s0 = st[0] - ds, s1 = st[0] + ds;
   Float t0 = st[1] - dt, t1 = st[1] + dt;
   if (std::floor(s0) == std::floor(s1) &amp;&amp;
       std::floor(t0) == std::floor(t1)) {
       &lt;&lt;<span class="fragmentname"><a href="#fragment-PointsamplemonoCheckerboard2DTexture-0">Point sample <tt>Checkerboard2DTexture</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1086" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1086"><i></i></a><div id="fragbit-1086" class="collapse"><div class="fragmentcode">          if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
              return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
          return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div>
   }</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Applyboxfiltertocheckerboardregion-0">Apply box filter to checkerboard region</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1087" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1087"><i></i></a><div id="fragbit-1087" class="collapse"><div class="fragmentcode">   auto bumpInt = [](Float x) {
       return (int)std::floor(x / 2) +
              2 * std::max(x / 2 - (int)std::floor(x / 2) - (Float)0.5,
                           (Float)0); };
   Float sint = (bumpInt(s1) - bumpInt(s0)) / (2 * ds);
   Float tint = (bumpInt(t1) - bumpInt(t0)) / (2 * dt);
   Float area2 = sint + tint - 2 * sint * tint;
   if (ds &gt; 1 || dt &gt; 1) 
       area2 = .5f;
   return (1 - area2) * <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si) +
          area2       * tex2-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div></div><p>


</p>
<p>
It&rsquo;s straightforward to check if the entire filter region is inside a 
single check by computing its bounding box and seeing if its extent
lies inside the same check.  For the remainder of this section, we will
use the axis-aligned bounding box of the filter region given by the partial
derivatives <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential s slash partial-differential x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1556" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="2143" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.117ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2633.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential s slash partial-differential y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1556" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="2143" y="0"></use>
</g>
</svg>, and so on, as the area to filter over, rather than
trying to filter over the ellipse defined by the partial derivatives as the
EWA filter did (Figure&nbsp;<a href="#fig:filter-bbox">10.20</a>).

</p>
<p></p>
<span class="anchor" id="fig:filter-bbox"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="AABB%20filtering.svg" title=""><img src="AABB%20filtering.svg" width=446 height=228 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 10.20: <span class="legend"> It is often convenient to use the
axis-aligned bounding box around the texture evaluation point and the
offsets from its partial derivatives as the region to filter over.  Here,
it&rsquo;s easy to see that the lengths of sides of the box are <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.73ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10216.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 max left-parenthesis StartAbsoluteValue partial-differential s slash partial-differential x EndAbsoluteValue comma StartAbsoluteValue partial-differential s slash partial-differential y EndAbsoluteValue right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(667,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-6D"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="2529" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="2919" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="3197" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D460" x="3784" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="4253" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="4754" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="5340" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="5913" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="6191" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="6636" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="6915" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D460" x="7501" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="7971" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="8471" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D466" x="9058" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="9548" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="9827" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.228ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10000.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 max left-parenthesis StartAbsoluteValue partial-differential t slash partial-differential x EndAbsoluteValue comma StartAbsoluteValue partial-differential t slash partial-differential y EndAbsoluteValue right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(667,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-6D"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="2529" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="2919" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="3197" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D461" x="3784" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="4145" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="4646" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="5232" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="5805" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="6083" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="6528" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="6807" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D461" x="7393" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="7755" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2202" x="8255" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D466" x="8842" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="9332" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="9611" y="0"></use>
</g>
</svg>.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Filtering over the bounding box simplifies the
implementation here, although somewhat increases the blurriness of the
filtered values.  The variables <tt>ds</tt> and <tt>dt</tt> in the following hold half the
filter width in each direction, so the total area filtered over
ranges from <tt>(s-ds, t-dt)</tt> to <tt>(s+ds, t+dt)</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-Evaluatesinglecheckiffilterisentirelyinsideoneofthem-0"></span><div class="fragmentname">&lt;&lt;Evaluate single check if filter is entirely inside one of them&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float ds = std::max(std::abs(dstdx[0]), std::abs(dstdy[0]));
Float dt = std::max(std::abs(dstdx[1]), std::abs(dstdy[1]));
Float s0 = st[0] - ds, s1 = st[0] + ds;
Float t0 = st[1] - dt, t1 = st[1] + dt;
if (std::floor(s0) == std::floor(s1) &amp;&amp;
    std::floor(t0) == std::floor(t1)) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-PointsamplemonoCheckerboard2DTexture-0">Point sample <tt>Checkerboard2DTexture</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1088" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1088"><i></i></a><div id="fragbit-1088" class="collapse"><div class="fragmentcode">       if (((int)std::floor(st[0]) + (int)std::floor(st[1])) % 2 == 0)
           return <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
       return <a href="#Checkerboard2DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div></div>
}</div><p>


</p>
<p>Otherwise, the lookup method approximates the filtered value by first
computing a floating-point value that indicates what fraction of the filter
region covers each of the two check types.  This is equivalent to computing
the average of the 2D step function that takes on the value&nbsp;0 when we are
in <tt>tex1</tt> and 1 when we are in <tt>tex2</tt>, over the filter region.
Figure&nbsp;<a href="#fig:step-func-integral">10.21</a>(a) shows a graph of the
checkerboard function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.146ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1785 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="433" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="823" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1395" y="0"></use>
</g>
</svg>, defined&nbsp;as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.98ex" height="5.509ex" style="vertical-align: -2.171ex;" viewBox="0 -1437.2 10755.1 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c left-parenthesis x right-parenthesis equals StartLayout Enlarged left-brace 1st Row 1st Column 0 2nd Column left floor x right floor is even 2nd Row 1st Column 1 2nd Column otherwise period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-230A" d="M416 -230c0 -11 -9 -20 -20 -20h-222v980c0 11 9 20 20 20s20 -9 20 -20v-940h182c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-230B" d="M270 -250h-222c-11 0 -20 9 -20 20s9 20 20 20h182v940c0 11 9 20 20 20s20 -9 20 -20v-980Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-76" d="M508 400c-66 -1 -83 -44 -92 -67l-131 -325c-4 -10 -8 -19 -21 -19s-15 5 -21 19l-144 355c-13 31 -17 37 -80 37v31c30 -2 70 -3 97 -3l109 3v-31c-18 0 -57 0 -57 -26c0 0 0 -4 6 -17l112 -279l102 255c4 11 6 15 6 24c0 19 -11 42 -48 43v31l87 -3c23 0 52 1 75 3v-31 Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-77" d="M703 400c-35 -1 -66 -14 -84 -64l-117 -328c-4 -10 -7 -19 -20 -19s-16 8 -20 19l-102 284l-101 -283c-5 -14 -7 -20 -20 -20s-16 8 -21 22l-126 354c-12 32 -24 35 -74 35v31l93 -3l109 3v-31c-20 0 -59 0 -59 -27c0 -4 0 -6 5 -18l95 -267l86 242c-7 19 -18 49 -23 55 c-10 13 -26 15 -63 15v31c30 -2 59 -3 89 -3l104 3v-31c-20 0 -59 0 -59 -27c0 -5 1 -7 5 -19l99 -279l91 256c5 13 5 15 5 21c0 29 -22 47 -58 48v31l93 -3c22 0 51 1 73 3v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-7B" d="M608 -780c0 -11 -9 -20 -20 -20c-2 0 -3 0 -5 1c-145 37 -273 148 -273 261v526c0 99 -81 213 -195 243c-9 2 -15 10 -15 19s6 17 15 19c114 30 195 144 195 243v526c0 113 128 224 273 261c2 1 3 1 5 1c11 0 20 -9 20 -20c0 -9 -6 -17 -15 -19 c-114 -29 -195 -134 -195 -223v-526c0 -108 -96 -212 -215 -262c119 -50 215 -154 215 -262v-526c0 -89 81 -194 195 -223c9 -2 15 -10 15 -19Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="433" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="823" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1395" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2062" y="0"></use>
<g transform="translate(3119,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-7B"></use>
<g transform="translate(874,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="525"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-626"></use>
</g>
<g transform="translate(1490,0)">
<g transform="translate(0,525)">
<g transform="translate(332,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-230A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-230B" x="1017" y="0"></use>
</g>
<g transform="translate(1793,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="332" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="610" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1337" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-76" x="1781" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="2310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="2754" y="0"></use>
</g>
</g>
<g transform="translate(0,-626)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="332" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-68" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="2223" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-77" x="2615" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="3338" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="3616" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="4011" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="4455" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

Given the average value, we can blend between the two subtextures,
according to what fraction of the filter region each one is visible for.

</p>
<p>
</p>
<span class="anchor" id="fig:step-func-integral"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="checkerboard-1d-func.svg" title=""><img src="checkerboard-1d-func.svg" width=360 height=248 style="max-width: 100%;"></a>
</div>
<p>

</p>
<div class="figure-row">
  <a href="checkerboard-1d-integral.svg" title=""><img src="checkerboard-1d-integral.svg" width=360 height=250 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 10.21: Integrating the Checkerboard Step
Function. <span class="legend"> (a)&nbsp;The 1D step function that
defines the checkerboard texture function, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.146ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1785 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="433" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="823" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1395" y="0"></use>
</g>
</svg>. (b)&nbsp;A
graph of the value of the integral <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.873ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 4251 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">integral Subscript 0 Superscript x Baseline c left-parenthesis x right-parenthesis normal d x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-222B" d="M609 722c0 -30 -22 -43 -42 -43c-19 0 -41 13 -41 42c0 14 8 37 37 41c-22 19 -53 21 -63 21c-45 0 -79 -25 -93 -209l-19 -249c-8 -111 -44 -402 -57 -454c-22 -90 -70 -177 -165 -177c-60 0 -110 35 -110 83c0 30 22 43 42 43c19 0 41 -13 41 -42c0 -14 -8 -37 -37 -41 c21 -18 51 -21 64 -21c57 0 93 45 106 209l19 249c9 121 45 403 57 458c17 76 56 173 151 173c60 0 110 -35 110 -83Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="941" y="754"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="941" y="-484"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="1336" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1770" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="2159" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2732" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="3121" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="3678" y="0"></use>
</g>
</svg>.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The integral of the 1D checkerboard function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.146ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1785 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="433" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="823" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1395" y="0"></use>
</g>
</svg> can be used to compute
the average value of the function over some extent.  Inspection of the
graph reveals that
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.214ex" height="5.843ex" style="vertical-align: -2.338ex;" viewBox="0 -1508.9 21619.6 2515.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">integral Subscript 0 Superscript x Baseline c left-parenthesis x right-parenthesis normal d x equals left floor x slash 2 right floor plus 2 max left-parenthesis x slash 2 minus left floor x slash 2 right floor minus .5 comma 0 right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-230A" d="M416 -230c0 -11 -9 -20 -20 -20h-222v980c0 11 9 20 20 20s20 -9 20 -20v-940h182c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-230B" d="M270 -250h-222c-11 0 -20 9 -20 20s9 20 20 20h182v940c0 11 9 20 20 20s20 -9 20 -20v-980Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D465" x="1490" y="1540"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-30" x="812" y="-1270"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="1725" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="2159" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="2548" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="3121" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-64" x="3677" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="4233" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-3D" x="5084" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-230A" x="6140" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="6584" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="7157" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-32" x="7657" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-230B" x="8158" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2B" x="8825" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-32" x="9825" y="0"></use>
<g transform="translate(10493,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-6D"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="12355" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="12745" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="13317" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-32" x="13818" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2212" x="14540" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-230A" x="15541" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D465" x="15986" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="16558" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-32" x="17059" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-230B" x="17559" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2212" x="18226" y="0"></use>
<g transform="translate(19226,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-2E"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-35" x="278" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="20005" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-30" x="20451" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="20951" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2E" x="21341" y="0"></use>
</g>
</svg>
</div>
<p>

To compute the average value of the step function in two dimensions, we 
separately compute the integral of the checkerboard in each 1D direction in
order to compute its average value over the filter region.

</p>
<p></p>
<span class="anchor" id="fragment-Applyboxfiltertocheckerboardregion-0"></span><div class="fragmentname">&lt;&lt;Apply box filter to checkerboard region&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">auto bumpInt = [](Float x) {
    return (int)std::floor(x / 2) +
           2 * std::max(x / 2 - (int)std::floor(x / 2) - (Float)0.5,
                        (Float)0); };
Float sint = (bumpInt(s1) - bumpInt(s0)) / (2 * ds);
Float tint = (bumpInt(t1) - bumpInt(t0)) / (2 * dt);
Float area2 = sint + tint - 2 * sint * tint;
if (ds &gt; 1 || dt &gt; 1) 
    area2 = .5f;
return (1 - area2) * <a href="#Checkerboard2DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si) +
       area2       * tex2-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);</div><p>


</p>
<p>Figure&nbsp;<a href="#fig:checkerboard-filtering">10.22</a> shows a comparison of these
filtering techniques.

</p>
<p></p>
<span class="anchor" id="fig:checkerboard-filtering"></span><div class="card outerfigure"><div class="card-body figure"><p>










</p>

<div class="card-img-top" style="display:block; width: 100%; padding-top: 37.667%;  position:relative;">
<div id="No_texture_filtering43" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div></div>
<script>
Jeri.renderViewer(document.getElementById('No_texture_filtering43'), {
  title: 'No_texture_filtering43', children: [
 { title: 'No texture filtering', image: 'checker-nofilt.png' },  { title: 'Filter-region average', image: 'checker-avg.png' },  { title: 'Supersampling', image: 'checker-supersample.png' }]});
</script>
<button data-toggle="tooltip" data-placement="left" class="btn yojeri" title="This image is interactive. Click and drag to pan and use the mouse-wheel to zoom. After clicking on the image to select it, type '?' to see a summary of keyboard controls."><i class="fa fa-snowflake fa-border"></i></button><p>

</p>
<figcaption class="caption">Figure 10.22: <span class="legend"> Comparisons of three
approaches for antialiasing procedural textures, applied to the
checkerboard texture. 
(1)&nbsp;No effort has been made to remove high-frequency
variation from the texture function, so there are severe artifacts in the
image, rendered with one sample per pixel.
(2)&nbsp;This image shows the approach based on computing the filter
region in texture space and averaging the texture function over that
area, also rendered with one sample per pixel.
(3)&nbsp;Here the checkerboard function was
effectively supersampled by taking 16 samples per pixel and then
point-sampling the texture.
Both the
area-averaging and the supersampling approaches give substantially better
results than the first approach.  In this example, supersampling gives the best
results, since the averaging approach has blurred out the checkerboard
pattern sooner than was needed because it approximates the filter region
with its axis-aligned box.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#SolidCheckerboard"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="SolidCheckerboard"></span><h3>10.5.3  Solid Checkerboard</h3><p>


</p>
<p>The <a href="#Checkerboard2DTexture"><tt>Checkerboard2DTexture</tt></a> class from the previous section wraps a
checkerboard pattern <em>around</em> the object in parameter space.  We can
also define a solid checkerboard pattern based on 3D texture
coordinates  so that the object appears carved out of 3D checker 
cubes (Figure&nbsp;<a href="#fig:3D-checkerboard-example">10.23</a>).
Like the 2D variant, this implementation chooses between texture functions
based on the lookup position.  Note that these two textures need not be
solid textures themselves; the <a href="#Checkerboard3DTexture"><tt>Checkerboard3DTexture</tt></a> merely chooses
between them based on the 3D position of the point.

</p>
<p> </p>
<span class="anchor" id="fig:3D-checkerboard-example"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="dragon-checker3d.png" style="max-width: 100%; height: auto;" width=441 height=441>
</div>
<p>

</p>
<figcaption class="caption">Figure 10.23: Dragon Model, Textured
with the <a href="#Checkerboard3DTexture"><tt>Checkerboard3DTexture</tt></a> Procedural Texture. <span class="legend">  Notice how the
model appears to be carved out of 3D checks, rather than having them pasted
on its surface.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-CheckerboardTextureDeclarations-1"></span><div class="fragmentname">&lt;&lt;CheckerboardTexture Declarations&gt;&gt;+=&nbsp;<a href="#fragment-CheckerboardTextureDeclarations-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">template &lt;typename T&gt; class <span class="anchor" id="Checkerboard3DTexture"></span>Checkerboard3DTexture : public <a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt; {
public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Checkerboard3DTexturePublicMethods-0">Checkerboard3DTexture Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1089" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1089"><i></i></a><div id="fragbit-1089" class="collapse"><div class="fragmentcode">       Checkerboard3DTexture(std::unique_ptr&lt;TextureMapping3D&gt; <a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>,
               const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>,
               const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>)
           : <a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>(std::move(<a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>)), <a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>(<a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>), <a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>(<a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>) { }
       T <a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(const <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> &amp;si) const {
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdx, dpdy;
           <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = <a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>-&gt;<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping3D::Map" class="code">Map</a>(si, &amp;dpdx, &amp;dpdy);
           if (((int)std::floor(p.x) + (int)std::floor(p.y) +
                (int)std::floor(p.z)) % 2 == 0)
               return <a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
           else
               return <a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
       }</div></div>
private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Checkerboard3DTexturePrivateData-0">Checkerboard3DTexture Private Data</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1090" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1090"><i></i></a><div id="fragbit-1090" class="collapse"><div class="fragmentcode">       std::unique_ptr&lt;TextureMapping3D&gt; mapping;
       std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; tex1, tex2;</div></div>
};</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-Checkerboard3DTexturePublicMethods-0"></span><div class="fragmentname">&lt;&lt;Checkerboard3DTexture Public Methods&gt;&gt;=&nbsp;<a href="#fragment-Checkerboard3DTexturePublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Checkerboard3DTexture(std::unique_ptr&lt;TextureMapping3D&gt; <a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>,
        const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>,
        const std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; &amp;<a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>)
    : <a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>(std::move(<a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>)), <a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>(<a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>), <a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>(<a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>) { }</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-Checkerboard3DTexturePrivateData-0"></span><div class="fragmentname">&lt;&lt;Checkerboard3DTexture Private Data&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">std::unique_ptr&lt;TextureMapping3D&gt; <span class="anchor" id="Checkerboard3DTexture::mapping"></span>mapping;
std::shared_ptr&lt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture" class="code">Texture</a>&lt;T&gt;&gt; <span class="anchor" id="Checkerboard3DTexture::tex1"></span>tex1, <span class="anchor" id="Checkerboard3DTexture::tex2"></span>tex2;</div><p>


</p>
<p>Ignoring antialiasing, the basic computation to see if a point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> is inside a 3D
checker region is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.008ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 13781 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis left floor normal p Subscript Baseline Subscript x Baseline right floor plus left floor normal p Subscript Baseline Subscript y Baseline right floor plus left floor normal p Subscript Baseline Subscript z Baseline right floor right-parenthesis normal m normal o normal d 2 equals 0 period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-230A" d="M416 -230c0 -11 -9 -20 -20 -20h-222v980c0 11 9 20 20 20s20 -9 20 -20v-940h182c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-230B" d="M270 -250h-222c-11 0 -20 9 -20 20s9 20 20 20h182v940c0 11 9 20 20 20s20 -9 20 -20v-980Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-230A" x="389" y="0"></use>
<g transform="translate(834,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-230B" x="1895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2562" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-230A" x="3562" y="0"></use>
<g transform="translate(4007,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-230B" x="5010" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5677" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-230A" x="6678" y="0"></use>
<g transform="translate(7122,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-230B" x="8109" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8554" y="0"></use>
<g transform="translate(9110,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="833" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="1334" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="11167" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="11945" y="0"></use>
<g transform="translate(13002,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
</g>
</g>
</svg>
</div>
<p>

The <tt>Checkerboard3DTexture</tt> doesn&rsquo;t have any built-in support for
antialiasing, so its implementation is fairly short.

</p>
<p></p>
<span class="anchor" id="fragment-Checkerboard3DTexturePublicMethods-1"></span><div class="fragmentname">&lt;&lt;Checkerboard3DTexture Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-Checkerboard3DTexturePublicMethods-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">T <span class="anchor" id="Checkerboard3DTexture::Evaluate"></span><a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(const <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> &amp;si) const {
    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdx, dpdy;
    <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = <a href="#Checkerboard3DTexture::mapping" class="code">mapping</a>-&gt;<a href="../Texture/Texture_Coordinate_Generation.html#TextureMapping3D::Map" class="code">Map</a>(si, &amp;dpdx, &amp;dpdy);
    if (((int)std::floor(p.x) + (int)std::floor(p.y) +
         (int)std::floor(p.z)) % 2 == 0)
        return <a href="#Checkerboard3DTexture::tex1" class="code">tex1</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
    else
        return <a href="#Checkerboard3DTexture::tex2" class="code">tex2</a>-&gt;<a href="../Texture/Texture_Interface_and_Basic_Textures.html#Texture::Evaluate" class="code">Evaluate</a>(si);
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
  <div class="container-fluid-nav">
    <!--  <ul class="nav navbar-nav navbar-center"> -->
      <span class="navbar-text" style="text-align: center;">
        Thanks to Enrico and 34 others for generously supporting <i>Physically
        Based Rendering</i> online
        through <a href="https://patreon.com/pbrbook">Patreon</a>.
    </span>
  </div>
</nav>

<nav class="navbar navbar-expand-md bg-light navbar-light">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>, &copy; 2004-2021 Matt Pharr, Wenzel Jakob, and Greg Humphreys under the <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a> license. (<a href="https://github.com/mmp/pbr-book-website/">github</a>)</span>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Texture/Noise.html">Texture / Noise</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
