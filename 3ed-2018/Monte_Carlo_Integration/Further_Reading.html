
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=Domine|Roboto+Mono" rel="stylesheet">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
        
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <title>Further Reading</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Monte_Carlo_Integration.html">Monte Carlo Integration</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Further Reading</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Monte_Carlo_Integration/Importance_Sampling.html">(Previous: Importance Sampling)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>Further Reading</h2><p>


</p>
<p>Many books have been written on Monte Carlo integration.  Hammersley and
Handscomb (<a href="#cite:Hammersley64">1964</a>), Spanier and Gelbard
(<a href="#cite:Spanier69">1969</a>), and Kalos and Whitlock (<a href="#cite:Kalos86">1986</a>) are classic
references.  More recent books on the topic include those by Fishman
(<a href="#cite:Fishman96">1996</a>) and Liu (<a href="#cite:Liu01">2001</a>).  Chib and Greenberg (<a href="#cite:Chib95">1995</a>) have written an approachable but rigorous introduction to the
Metropolis algorithm.  The Monte Carlo and Quasi Monte Carlo Web site is a
useful gateway to recent work in the field <em>(www.mcqmc.org)</em>.

</p>
<p>Good general references about Monte Carlo and its application to computer
graphics are the theses by Lafortune (<a href="#cite:Lafortune96thesis">1996</a>) and
Veach (<a href="#cite:VeachThesis">1997</a>).  Dutr&eacute;&rsquo;s
<em>Global Illumination Compendium</em> (<a href="#cite:DutreCompendium">2003</a>) also has much useful
information related to this topic.  The course notes from the Monte Carlo
ray-tracing course at SIGGRAPH have a wealth of practical information
(Jensen et al.&nbsp;<a href="#cite:Jensen01course">2001a</a>, <a href="#cite:Jensen03course">2003</a>).

</p>
<p>The square to disk mapping was described by
Shirley and Chiu (<a href="#cite:Shirley97">1997</a>).  The implementation here benefits by observations
by Cline and &ldquo;franz&rdquo; that the logic could be simplified considerably from
the original algorithm (Shirley&nbsp;<a href="#cite:Shirley2011">2011</a>). 
Marques et&nbsp;al. (<a href="#cite:Marques2013">2013</a>) note that well-distributed samples on <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.965ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2568.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg> still
suffer some distortion when they are mapped to the sphere of directions and
show how to generate low-discrepancy samples on the unit sphere.

</p>
<p>Steigleder and McCool (<a href="#cite:SteiglederMcCool03">2003</a>) described an alternative to the
multidimensional sampling approach from
Section&nbsp;<a href="../Monte_Carlo_Integration/2D_Sampling_with_Multidimensional_Transformations.html#sec:sample-discrete-2d">13.6.7</a>: they linearized 2D and
higher dimensional domains into 1D using a Hilbert curve and then sampled
using 1D samples over the 1D domain.  This leads to a simpler
implementation that still maintains desirable stratification properties of
the sampling distribution, thanks to the spatial coherence preserving
properties of the Hilbert curve.

</p>
<p>Lawrence et&nbsp;al. (<a href="#cite:Lawrence05">2005</a>) described an adaptive representation for CDFs, where
the CDF is approximated with a piecewise linear function with fewer, but
irregularly spaced, vertices compared to the complete CDF.  This approach
can substantially reduce storage requirements and improve lookup
efficiency, taking advantage of the fact that large ranges of the CDF may
be efficiently approximated with a single linear function.

</p>
<p>Cline et&nbsp;al. (<a href="#cite:Cline09b">2009b</a>) observed that the time spent in binary searches for
sampling from precomputed distributions (like <a href="../Monte_Carlo_Integration/Sampling_Random_Variables.html#Distribution1D"><tt>Distribution1D</tt></a> does)
can take a meaningful amount of execution time.  (Indeed, <tt>pbrt</tt> spends
nearly 7% of the time when rendering the car scene lit by an
<a href="../Light_Sources/Infinite_Area_Lights.html#InfiniteAreaLight"><tt>InfiniteAreaLight</tt></a> in the <a href="../Monte_Carlo_Integration/Sampling_Random_Variables.html#Distribution1D::SampleContinuous"><tt>Distribution1D::SampleContinuous()</tt></a>
method, which is used by <a href="../Light_Transport_I_Surface_Reflection/Sampling_Light_Sources.html#InfiniteAreaLight::Sample_Li"><tt>InfiniteAreaLight::Sample_Li()</tt></a>.)  They
presented two improved methods for doing this sort of search: the first
stores a lookup table with <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg> integer values, indexed by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.497ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1936 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left floor n xi Subscript Baseline right floor</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-230A" d="M416 -230c0 -11 -9 -20 -20 -20h-222v980c0 11 9 20 20 20s20 -9 20 -20v-940h182c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-230B" d="M270 -250h-222c-11 0 -20 9 -20 20s9 20 20 20h182v940c0 11 9 20 20 20s20 -9 20 -20v-980Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-230A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="1045" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-230B" x="1491" y="0"></use>
</g>
</svg>, which gives the first entry in the CDF array that is less
than or equal to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.037ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 446.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">xi Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
</g>
</svg>.  Starting a linear search from this offset in
the CDF array can be much more efficient than a complete binary search over
the entire array.  They also presented a method based on approximating the
inverse CDF as a piecewise linear function of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.037ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 446.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">xi Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
</g>
</svg> and thus enabling
constant-time lookups at a cost of some accuracy (and thus some additional
variance).

</p>
<p>The <em>alias method</em> is a technique that makes it possible to sample from
discrete distributions in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2043 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1153" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1653" y="0"></use>
</g>
</svg> time (Walker&nbsp;<a href="#cite:Walker1974">1974</a>, <a href="#cite:Walker1977">1977</a>); this is much
better than the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.336ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3589.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis log n right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-67" d="M485 404c0 -23 -19 -30 -29 -30c-16 0 -29 12 -29 29c0 12 5 23 16 27c-3 1 -10 1 -10 1c-18 0 -54 -5 -90 -39c25 -23 41 -60 41 -97c0 -77 -69 -146 -162 -146c-19 0 -60 3 -99 31c-17 -20 -17 -43 -17 -47c0 -32 21 -63 53 -67c7 -1 50 -1 75 -1c61 0 119 0 172 -28 c51 -28 65 -79 65 -114c0 -78 -104 -129 -222 -129c-122 0 -221 55 -221 127c0 40 32 83 92 100c-31 20 -44 58 -44 89c0 35 18 68 31 83c-25 21 -47 59 -47 103c0 77 69 146 162 146c22 0 64 -3 106 -36c42 41 86 47 106 47c39 0 51 -32 51 -49zM309 296 c0 23 0 123 -87 123c-40 0 -63 -28 -71 -40c-15 -25 -16 -57 -16 -84c0 -23 0 -123 87 -123c40 0 63 28 71 40c15 25 16 57 16 84zM419 -79c0 86 -112 86 -198 86h-59c-44 -3 -82 -40 -82 -86c0 -53 69 -104 170 -104c98 0 169 50 169 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
<g transform="translate(1153,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6C"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-67" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="2599" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3199" y="0"></use>
</g>
</svg> of the <a href="../Monte_Carlo_Integration/Sampling_Random_Variables.html#Distribution1D"><tt>Distribution1D</tt></a> class when it is
used for sampling discrete distributions.  The downside of this approach is that
it does not preserve sample stratification.  See Schwarz&rsquo;s writeup
(<a href="#cite:Schwarz11">2011</a>) for information about implementing this approach well.

</p>
<p>Arithmetic coding offers another interesting way to approach sampling from
distributions (MacKay&nbsp;<a href="#cite:MacKay03">2003</a>, p.&nbsp;118; Piponi&nbsp;<a href="#cite:Piponi12">2012</a>). If we have a discrete set
of probabilities we&rsquo;d like to generate samples from, one way to approach
the problem is to encode the CDF as a binary tree where each node splits
the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2114.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1724" y="0"></use>
</g>
</svg> interval at some point and where, given a random sample
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.037ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 446.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">xi Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
</g>
</svg>, we determine which sample value it corresponds to by traversing
the tree until we reach the leaf node for its sample value. Ideally, we&rsquo;d
like to have leaf nodes that represent higher probabilities be higher up in
the tree, so that it takes fewer traversal steps to find them (and thus,
those more frequently generated samples are found more quickly). Looking at
the problem from this perspective, it can be shown that the optimal
structure of such a tree is given by Huffman coding, which is normally used
for compression.

</p>
<p>Mitchell (<a href="#cite:Mitchell96">1996b</a>) wrote a paper that investigates the effects of
stratification for integration problems in graphics (including the
2D problem of pixel antialiasing).  In particular, he
investigated the connection between the complexity of the function being
integrated and the effect of stratification.  In general, the smoother or
simpler the function, the more stratification helps: for pixels with smooth
variation over their areas or with just a few edges passing through them,
stratification helps substantially, but as the complexity in a pixel is
increased, the gain from stratification is reduced.  Nevertheless, because
stratification never increases variance, there&rsquo;s no reason not to do it.

</p>
<p>Starting with Durand et&nbsp;al.&rsquo;s work (<a href="#cite:Durand2005">2005</a>), a number of researchers have
approached the analysis of light transport and variance from Monte Carlo
integration for rendering using Fourier analysis.  See Pilleboue et&nbsp;al.&rsquo;s paper (<a href="#cite:Pilleboue2015">2015</a>) for recent work in this area, including references to previous
work. Among other results, they show that Poisson disk patterns give higher
variance than simple jittered patterns. They found that the blue noise
pattern of de Goes et&nbsp;al. (<a href="#cite:Goes2012">2012</a>) was fairly effective.  Other work in this
area includes the paper by Subr and Kautz (<a href="#cite:Subr2013">2013</a>).

</p>
<p>Multiple importance sampling was developed by Veach and Guibas
(<a href="#cite:Veach95">Veach and Guibas 1995</a>; <a href="#cite:VeachThesis">Veach 1997</a>).
Normally, a pre-determined number of samples are taken using each sampling
technique; see Pajot et&nbsp;al. (<a href="#cite:Pajot2011">2011</a>) and Lu et&nbsp;al. (<a href="#cite:Lu2013">2013</a>) for approaches to
adaptively distributing the samples over strategies in an effort to reduce
variance by choosing those that are the best match to the integrand.

</p>
<p></p>
<h3>References</h3>
<ol style="list-style: none;">
<li class="bibitem" id="cite:Booth86">Booth, T.&nbsp;E. 1986.
A Monte Carlo learning/biasing experiment with intelligent random
  numbers.
<em>Nuclear Science and Engineering</em>&nbsp;<em>92,</em> 465&ndash;81.
</li>

<li class="bibitem" id="cite:Chib95">Chib, S., and E.&nbsp;Greenberg. 1995.
Understanding the Metropolis&ndash;Hastings algorithm.
<em>The American Statistician</em>&nbsp;<em>49</em>&thinsp;(4), 327&ndash;35.
</li>

<li class="bibitem" id="cite:Cline09b">Cline, D., A.&nbsp;Razdan, and P.&nbsp;Wonka. 2009.
A comparison of tabular PDF inversion methods.
<em>Computer Graphics Forum</em>&nbsp;<em>28</em>&thinsp;(1), 154&ndash;60.
</li>

<li class="bibitem" id="cite:Cline08">Cline, D., D.&nbsp;Adams, and P.&nbsp;Egbert. 2008.
Table-driven adaptive importance sampling.
<em>Computer Graphics Forum (Proceedings of the 2008 Eurographics Symposium on
Rendering)</em>&nbsp;<em>27</em>&thinsp;(4),  1115&ndash;23.
</li>

<li class="bibitem" id="cite:Goes2012">de&nbsp;Goes, F., K.&nbsp;Breeden, V.&nbsp;Ostromoukhov, and M.&nbsp;Desbrun.
Blue noise through optimal transport.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
Asia)</em>&nbsp;<em>31</em>&thinsp;(6), 171:1&ndash;171:11.
</li>

<li class="bibitem" id="cite:Durand2005">Durand, F., N.&nbsp;Holzschuch, C.&nbsp;Soler, E.&nbsp;Chan, and F.&nbsp;X.&nbsp;Sillion.
A frequency analysis of light transport.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2005)</em>&nbsp;<em>24</em>&thinsp;(3), 1115&ndash;26.
</li>

<li class="bibitem" id="cite:DutreCompendium">Dutr&eacute;, P. 2003.
Global illumination compendium.
<a href="http://www.cs.kuleuven.ac.be/~phil/GI/.">www.cs.kuleuven.ac.be/~phil/GI/.</a>
</li>

<li class="bibitem" id="cite:Fishman96">Fishman, G.&nbsp;S. 1996.
<em>Monte Carlo: Concepts, Algorithms, and Applications</em>.
New York: Springer-Verlag.
</li>

<li class="bibitem" id="cite:Hammersley64">Hammersley, J., and D.&nbsp;Handscomb. 1964.
<em>Monte Carlo Methods</em>.
New York: John Wiley.
</li>

<li class="bibitem" id="cite:Jensen01course">Jensen, H.&nbsp;W., J.&nbsp;Arvo, M.&nbsp;Fajardo, P.&nbsp;Hanrahan, D.&nbsp;Mitchell, M.&nbsp;Pharr, and
  P.&nbsp;Shirley. 2001a.
State of the art in Monte Carlo ray tracing for realistic image
  synthesis.
In <em>SIGGRAPH 2001 Course 29,</em> Los Angeles.
</li>

<li class="bibitem" id="cite:Jensen03course">Jensen, H.&nbsp;W., J.&nbsp;Arvo, P.&nbsp;Dutr&eacute;, A.&nbsp;Keller, A.&nbsp;Owen, M.&nbsp;Pharr, and
  P.&nbsp;Shirley. 2003.
Monte Carlo ray tracing.
In <em>SIGGRAPH 2003 Course,</em> San Diego.
</li>

<li class="bibitem" id="cite:Kalos86">Kalos, M.&nbsp;H., and P.&nbsp;A. Whitlock. 1986.
<em>Monte Carlo Methods: Volume I: Basics</em>.
New York: Wiley.
</li>

<li class="bibitem" id="cite:Lafortune96thesis">Lafortune, E. 1996.
Mathematical models and Monte Carlo algorithms for
  physically based rendering.
Ph.D. thesis, Katholieke Universiteit Leuven.
</li>

<li class="bibitem" id="cite:Lawrence05">Lawrence, J., S.&nbsp;Rusinkiewicz, and R.&nbsp;Ramamoorthi. 2005.
Adaptive numerical cumulative distribution functions for efficient
importance sampling.
<em>Rendering Techniques 2005: 16th Eurographics Workshop on Rendering,</em>
11&ndash;20.
</li>

<li class="bibitem" id="cite:Liu01">Liu, J.&nbsp;S. 2001.
<em>Monte Carlo Strategies in Scientific Computing</em>.
New York: Springer-Verlag.
</li>

<li class="bibitem" id="cite:Lu2013">Lu, H., R.&nbsp;Pacanowski, and X.&nbsp;Granier.
Second-order approximation for variance reduction in multiple importance sampling.
<em>Computer Graphics Forum</em>&nbsp;<em>32</em>&thinsp;(7), 131&ndash;36.
</li>

<li class="bibitem" id="cite:MacKay03">MacKay, D. 2003.
<em>Information Theory, Inference, and Learning Algorithms</em>.
Cambridge: Cambridge University Press.
</li>

<li class="bibitem" id="cite:Marques2013">Marques, R., C.&nbsp;Bouville, M.&nbsp;Ribardi&egrave;re, L.&nbsp;P.&nbsp;Santos, and K.&nbsp;Bouatouch.
Spherical Fibonacci point sets for illumination integrals.
<em>Computer Graphics Forum (Proceedings of the 2013 Eurographics Symposium on
Rendering)</em>&nbsp;<em>32</em>&thinsp;(4), 134&ndash;43.
</li>

<li class="bibitem" id="cite:Metropolis53">Metropolis, N., A.&nbsp;Rosenbluth, M.&nbsp;Rosenbluth, A.&nbsp;Teller, and E.&nbsp;Teller. 1953.
Equation of state calculations by fast computing machines.
<em>Journal of Chemical Physics</em>&nbsp;<em>21</em>&thinsp;(6),  1087&ndash;92.
</li>

<li class="bibitem" id="cite:Mitchell96">Mitchell, D.&nbsp;P. 1996b.
Consequences of stratified sampling in graphics.
In <em>Proceedings of SIGGRAPH &rsquo;96,</em> Computer Graphics Proceedings,
  Annual Conference Series, New Orleans, Louisiana, 277&ndash;80.
</li>

<li class="bibitem" id="cite:Motwani:RandomizedAlgorithms">Motwani, R., and P.&nbsp;Raghavan. 1995.
<em>Randomized Algorithms</em>. Cambridge, U.K.:
Cambridge University Press.
</li>

<li class="bibitem" id="cite:owen98latin">Owen, A.&nbsp;B. 1998.
Latin supercube sampling for very high-dimensional simulations.
<em>Modeling and Computer Simulation</em>&nbsp;<em>8</em>&thinsp;(1), 71&ndash;102.
</li>

<li class="bibitem" id="cite:Pajot2011">Pajot, A., L.&nbsp;Barthe, M.&nbsp;Paulin, and P.&nbsp;Poulin.
Representativity for robust and adaptive multiple importance sampling.
<em>IEEE Transactions on Visualization and Computer
Graphics</em>&nbsp;<em>17</em>&thinsp;(8), 1108&ndash;21.
</li>

<li class="bibitem" id="cite:Pilleboue2015">Pilleboue, A., G.&nbsp;Singh, D.&nbsp;Coeurjolly, M.&nbsp;Kazhdan, and V.&nbsp;Ostromoukhov.
Variance analysis for Monte Carlo integration.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH 2015)</em>&nbsp;<em>34</em>&thinsp;(4), 124:1&ndash;124:14.
</li>

<li class="bibitem" id="cite:Piponi12">Piponi, D. 2012.
Lossless decompression and the generation of random samples.
<a href="http://blog.sigfpe.com/2012/01/lossless-decompression-and-generation.html">http://blog.sigfpe.com/2012/01/lossless-decompression-and-generation.html</a>.
</li>

<li class="bibitem" id="cite:Ross:ProbabilityModels">Ross, S.&nbsp;M. 2002.
<em>Introduction to Probability Models</em> (8th ed.). San Diego:
Academic Press.
</li>

<li class="bibitem" id="cite:Schwarz11">Schwarz, K. 2011.
Darts, dice, and coins: sampling from a discrete distribution.
<a href="http://www.keithschwarz.com/darts-dice-coins/">http://www.keithschwarz.com/darts-dice-coins/</a>.
</li>

<li class="bibitem" id="cite:Shirley2011">Shirley, P.
Improved code for concentric map.
<a href="http://psgraphics.blogspot.com/2011/01/improved-code-for-concentric-map.html">http://psgraphics.blogspot.com/2011/01/improved-code-for-concentric-map.html</a>.
</li>

<li class="bibitem" id="cite:Shirley97">Shirley, P., and K.&nbsp;Chiu. 1997.
A low distortion map between disk and square.
<em>Journal of Graphics Tools</em>&nbsp;<em>2</em>&thinsp;(3), 45&ndash;52.
</li>

<li class="bibitem" id="cite:Spanier69">Spanier, J., and E.&nbsp;M. Gelbard. 1969.
<em>Monte Carlo Principles and Neutron Transport Problems</em>.
Reading, Massachusetts: Addison-Wesley.
</li>

<li class="bibitem" id="cite:SteiglederMcCool03">Steigleder, M., and M.&nbsp;McCool.  2003.
Generalized stratified sampling using the Hilbert curve.
<em>Journal of Graphics Tools</em>&nbsp;<em>8</em>&thinsp;(3), 41&ndash;47.
</li>

<li class="bibitem" id="cite:Subr2013">Subr, K., and J.&nbsp;Kautz.
Fourier analysis of stochastic sampling strategies for assessing bias and
variance in integration.
<em>ACM Transactions on Graphics (Proceedings of SIGGRAPH
2013)</em>&nbsp;<em>32</em>&thinsp;(4), 128:1&ndash;128:12.
</li>

<li class="bibitem" id="cite:VeachThesis">Veach, E. 1997.
Robust Monte Carlo methods for light transport simulation.
Ph.D. thesis, Stanford University.
</li>

<li class="bibitem" id="cite:Veach95">Veach, E., and L.&nbsp;J. Guibas. 1995.
Optimally combining sampling techniques for Monte Carlo rendering.
In <em>Computer Graphics (SIGGRAPH &rsquo;95 Proceedings),</em> 419&ndash;28.
</li>

<li class="bibitem" id="cite:Walker1977">Walker, A.&nbsp;J.
An efficient method for generating discrete random variables with general distributions.
<em>ACM Transactions on Mathematical Software</em>&nbsp;<em>3</em>&thinsp;(3), 253&ndash;56.
</li>

<li class="bibitem" id="cite:Walker1974">Walker, A.&nbsp;J.
New fast method for generating discrete random numbers with arbitrary
frequency distributions.
<em>Electronics Letters</em>&nbsp;<em>10</em>&thinsp;(8): 127&ndash;28.
</li>

</ol>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
  <div class="container-fluid-nav">
    <!--  <ul class="nav navbar-nav navbar-center"> -->
      <span class="navbar-text" style="text-align: center;">
        Thanks to Farhan Wali and 43 others for generously supporting <i>Physically
        Based Rendering</i> online
        through <a href="https://patreon.com/pbrbook">Patreon</a>.
    </span>
  </div>
</nav>

<nav class="navbar navbar-expand-md bg-light navbar-light">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>, &copy; 2004-2021 Matt Pharr, Wenzel Jakob, and Greg Humphreys under the <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a> license. (<a href="https://github.com/mmp/pbr-book-website/">github</a>)</span>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Monte_Carlo_Integration/Exercises.html">Monte Carlo Integration / Exercises</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
