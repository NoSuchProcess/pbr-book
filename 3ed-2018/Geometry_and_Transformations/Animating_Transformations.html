
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=Domine|Roboto+Mono" rel="stylesheet">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
        
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <title>Animating Transformations</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Geometry_and_Transformations.html">Geometry and Transformations</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Animating Transformations</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Geometry_and_Transformations/Applying_Transformations.html">(Previous: Applying Transformations)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:animating-transformations"></span><h2>2.9 Animating Transformations<button data-toggle="tooltip" data-placement="right" class="btn difficult-button"
title="This section contains advanced content and may be skipped on a first reading.">
<i class="fas fa-exclamation-triangle midredtext"></i></button>
</h2><p>




</p>
<p></p>
<span class="anchor" id="fig:spinning-spheres"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="spinningspheres.png" style="max-width: 100%; height: auto;" width=1388 height=609>
</div>
<p>

</p>
<figcaption class="caption">Figure 2.15: Spinning Spheres. <span class="legend"> Three spheres, reflected in a mirror, spinning at different
  rates using the transformation animation code implemented in this
  section.  Note that the reflections of the spheres are blurry as well as
  the spheres themselves.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p><tt>pbrt</tt> supports keyframe matrix animation for cameras and geometric
primitives in the scene.  Rather than just supplying a single
transformation to place the corresponding object in the scene, the user may
supply a number of <em>keyframe</em> transformations, each one associated
with a particular point in time.  This makes it possible 
for the camera to move and for objects in the scene to
be moving during the time the simulated camera&rsquo;s shutter is open.
Figure&nbsp;<a href="#fig:spinning-spheres">2.15</a> shows three spheres
animated using keyframe matrix animation in <tt>pbrt</tt>.

</p>
<p>In general, the problem of interpolating between keyframe matrices is
under-defined.  As one example, if we have a rotation about the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> axis of 181
degrees followed by another of 181 degrees, does this represent a small rotation of
2&nbsp;degrees or a large rotation of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.296ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2280 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">negative 358</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="1001" y="0"></use>
</g>
</g>
</svg> degrees?  For another example,
consider two matrices where one is the identity and the other is a 
180-degree rotation about the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> axis.  There are an infinite number of ways
to go from one orientation to the other.

</p>
<p>Keyframe matrix interpolation is an important problem in computer
animation, where a number of different approaches have been developed.
Fortunately, the problem of matrix interpolation in a renderer is generally
less challenging than it is for animation systems for two reasons.

</p>
<p>First, in a renderer like <tt>pbrt</tt>, we generally have a keyframe matrix at the
camera shutter open time and another at the shutter close time; we only
need to interpolate between the two of them across the time of a single
image.  In animation systems, the matrices are generally available at a
lower time frequency, so that there are many frames between pairs of
keyframe matrices; as such, there&rsquo;s more opportunity to notice shortcomings
in the interpolation.

</p>
<p>Second, in a physically based renderer, the longer the period of time over
which we need to interpolate the pair of matrices, the longer the virtual
camera shutter is open and the more motion blur there will be in the final
image; the increased amount of motion blur often hides sins of the
interpolation.

</p>
<p>The most straightforward approach to interpolate transformations defined by
keyframe matrices&mdash;directly interpolating the individual components of the
matrices&mdash;is not a good one, as it will generally lead to unexpected and
undesirable results.  For example, if the transformations apply different
rotations, then even if we have a rigid-body motion, the intermediate
matrices may scale the object, which is clearly undesirable.  (If the
matrices have a full 180-degree rotation between them, the object may be
scaled down to nothing at the middle of the interpolation!)

</p>
<p>Figure&nbsp;<a href="#fig:quad-good-bad-anim">2.16</a> shows a sphere that rotates 90
degrees over the course of the frame; direct interpolation of matrix
elements gives a less accurate result than the approach
implemented in this section.

</p>
<p> </p>
<span class="anchor" id="fig:quad-good-bad-anim"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>

<div class="card-img-top" style="display:block; width: 100%; padding-top: 103.556%;  position:relative;">
<div id="Still_sphere4" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div></div>
<script>
Jeri.renderViewer(document.getElementById('Still_sphere4'), {
  title: 'Still_sphere4', children: [
 { title: 'Still sphere', image: 'sphere-still.png' },  { title: 'Rotating, correct interpolation', image: 'sphere-rot-good.png' },  { title: 'Rotating, incorrect interpolation', image: 'sphere-rot-bad.png' }]});
</script>
<button data-toggle="tooltip" data-placement="left" class="btn yojeri" title="This image is interactive. Click and drag to pan and use the mouse-wheel to zoom. After clicking on the image to select it, type '?' to see a summary of keyboard controls."><i class="fa fa-snowflake fa-border"></i></button><p>

</p>
<figcaption class="caption">Figure 2.16: The Effect of Incorrect Interpolation of Transformations. <span class="legend"> 
(1)&nbsp;A sphere with a grid of lines as a texture, not rotating.
(2)&nbsp;A sphere rotating 90 degrees during the course of the frame, using the
technique for interpolating transformations implemented in this section.
(3)&nbsp;A sphere rotating 90 degrees using direct interpolation of matrix
components to interpolate transformations.  In that case, 
the animated sphere incorrectly grows larger and
the lines toward the outside of the sphere, which should
remain sharp, incorrectly become blurry.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The approach used for transformation interpolation in <tt>pbrt</tt> is based on
<em>matrix decomposition</em>&mdash;given an arbitrary transformation matrix
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg>, we decompose it into a concatenation of scale (<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg>),
rotation (<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.006ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 863.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper R</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
</g>
</svg>), and translation (<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg>) transformations,
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.633ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 5008.6 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M equals bold upper S bold upper R bold upper T comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1370" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="2426" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="3066" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="3929" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4730" y="0"></use>
</g>
</svg>
</div>
<p>

where each of those components is independently interpolated and then
the composite interpolated matrix is found by multiplying the three
interpolated matrices together.

</p>
<p>Interpolation of translation and scale can be performed easily and
accurately with linear interpolation of the components of their matrices;
interpolating rotations is more difficult.  Before describing the matrix
decomposition implementation in <tt>pbrt</tt>, we will first introduce
<em>quaternions</em>, an elegant representation of rotations that leads to
effective methods for interpolating them.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Quaternions"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:quaternions"></span><span id="Quaternions"></span><h3>2.9.1  Quaternions</h3><p>



</p>
<p>Quaternions were originally invented by Sir William Rowan Hamilton in 1843 as a
generalization of complex numbers.  He determined that just as in two
dimensions <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.312ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2287.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1897" y="0"></use>
</g>
</svg>, where complex numbers could be defined as a sum of a real
and an imaginary part <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.956ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2564.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x plus y normal i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="794" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1795" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="2285" y="0"></use>
</g>
</svg>, with <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.77ex" height="2.676ex" style="vertical-align: -0.505ex;" viewBox="0 -934.9 3345.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal i squared equals negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="544"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1010" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2066" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2844" y="0"></use>
</g>
</svg>, a
generalization could be made to four dimensions, giving quaternions.

</p>
<p>A quaternion is a four-tuple, 
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:quat-define"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.711ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14944.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q equals left-parenthesis x comma y comma z comma w right-parenthesis equals w plus x normal i plus y normal j plus z normal k comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1941" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="2331" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2903" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="3348" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3839" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="4284" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4751" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="5197" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5913" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="6580" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="7637" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8575" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="9576" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="10149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10649" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="11650" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="12141" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="12669" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="13670" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="14137" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="14666" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:quat-define">2.4</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.647ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 278.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.804ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.092ex;" viewBox="-39.5 -791.3 346 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal j</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.227ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 528.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal k</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="0" y="0"></use>
</g>
</svg> are defined
<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="Hamilton found the discovery of this relationship among the
components compelling enough that he used a knife to carve the formula on the
bridge he was crossing when it came to him.">
      <sup>&dagger;</sup>
    </button>
		
so that
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.7ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 10203.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal i squared equals normal j squared equals normal k squared equals normal i normal j normal k equals negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="544"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1010" y="0"></use>
<g transform="translate(2066,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="433" y="544"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3104" y="0"></use>
<g transform="translate(4160,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="747" y="596"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5421" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="6477" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="6755" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="7062" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="7868" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="8924" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="9703" y="0"></use>
</g>
</svg>. Other
important relationships between the components are that 
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.685ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2447.6 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal i normal j equals normal k</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="862" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="1919" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.585ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.092ex;" viewBox="-39.5 -791.3 3265.6 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal j normal i equals negative normal k</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="306" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="862" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1919" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="2697" y="0"></use>
</g>
</svg>. 
This implies that quaternion multiplication is generally not commutative.

</p>
<p>A quaternion can be represented as a quadruple <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.684ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 8474.9 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q equals left-parenthesis bold q Subscript x Baseline comma bold q Subscript y Baseline comma bold q Subscript z Baseline comma bold q Subscript w Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1941" y="0"></use>
<g transform="translate(2331,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3443" y="0"></use>
<g transform="translate(3888,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4942" y="0"></use>
<g transform="translate(5388,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="6426" y="0"></use>
<g transform="translate(6871,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8085" y="0"></use>
</g>
</svg> or as <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.329ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 6169.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q equals left-parenthesis bold q Subscript x y z Baseline comma bold q Subscript w Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1941" y="0"></use>
<g transform="translate(2331,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4120" y="0"></use>
<g transform="translate(4565,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5780" y="0"></use>
</g>
</svg>, where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.157ex" height="2.509ex" style="vertical-align: -1.171ex;" viewBox="0 -576.1 1789.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q Subscript x y z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
</svg> is an imaginary 3-vector
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.82ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 1214.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q Subscript w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
</svg> is the real part.  We will use both
representations interchangeably in this section.

</p>
<p>An expression for the product of two arbitrary quaternions can be found by
expanding their definition in terms of real and imaginary components:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="57.435ex" height="3.343ex" style="vertical-align: -1.171ex;" viewBox="0 -934.9 24728.7 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold q Superscript prime Baseline equals left-parenthesis bold q Subscript w Baseline plus bold q Subscript x Baseline normal i plus bold q Subscript y Baseline normal j plus bold q Subscript z Baseline normal k right-parenthesis left-parenthesis bold q prime Subscript w Baseline plus bold q prime Subscript x Baseline normal i plus bold q prime Subscript y Baseline normal j plus bold q prime Subscript z Baseline normal k right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1880" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2937" y="0"></use>
<g transform="translate(3326,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4763" y="0"></use>
<g transform="translate(5763,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="6876" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7376" y="0"></use>
<g transform="translate(8377,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="9431" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9960" y="0"></use>
<g transform="translate(10961,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="11999" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="12527" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="12917" y="0"></use>
<g transform="translate(13306,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="1408" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="15131" y="0"></use>
<g transform="translate(16132,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1408" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="17632" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="18133" y="0"></use>
<g transform="translate(19134,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1408" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="20576" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="21105" y="0"></use>
<g transform="translate(22105,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1408" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="23532" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="24060" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="24450" y="0"></use>
</g>
</svg>
</div>
<p>

Collecting terms and using identities among the components like those
listed above (e.g., <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.77ex" height="2.676ex" style="vertical-align: -0.505ex;" viewBox="0 -934.9 3345.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal i squared equals negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="544"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1010" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2066" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2844" y="0"></use>
</g>
</svg>), the result can be expressed
concisely using vector cross and dot products:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:quat-mult"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.363ex" height="7.176ex" style="vertical-align: -3.005ex;" viewBox="0 -1796 19531.3 3089.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column left-parenthesis bold q bold q prime right-parenthesis Subscript x y z 2nd Column equals bold q Subscript x y z Baseline times bold q prime Subscript x y z Baseline plus bold q Subscript w Baseline bold q prime Subscript x y z Baseline plus bold q prime Subscript w Baseline bold q Subscript x y z Baseline 2nd Row 1st Column left-parenthesis bold q bold q prime right-parenthesis Subscript w 2nd Column equals bold q Subscript w Baseline bold q prime Subscript w Baseline minus left-parenthesis bold q Subscript x y z Baseline dot bold q prime Subscript x y z Baseline right-parenthesis period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,903)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="389" y="0"></use>
<g transform="translate(997,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1992" y="0"></use>
<g transform="translate(2382,-285)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
<g transform="translate(575,-829)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="389" y="0"></use>
<g transform="translate(997,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1992" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="3368" y="-403"></use>
</g>
</g>
<g transform="translate(3831,0)">
<g transform="translate(0,903)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="3012" y="0"></use>
<g transform="translate(3957,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
<g transform="translate(995,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6357" y="0"></use>
<g transform="translate(7358,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
<g transform="translate(8572,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
<g transform="translate(995,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10972" y="0"></use>
<g transform="translate(11973,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="1408" y="-326"></use>
</g>
<g transform="translate(13575,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
</g>
<g transform="translate(0,-829)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
<g transform="translate(2270,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="1408" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4094" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5095" y="0"></use>
<g transform="translate(5485,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="7497" y="0"></use>
<g transform="translate(7997,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
<g transform="translate(995,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10175" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="10565" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:quat-mult">2.5</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

There is a useful relationship between unit quaternions (quaternions whose
components satisfy <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.219ex" height="2.843ex" style="vertical-align: -0.671ex;" viewBox="0 -934.9 9566.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x squared plus y squared plus z squared plus w squared equals 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="693" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3415" y="0"></use>
<g transform="translate(4416,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="662" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5560" y="0"></use>
<g transform="translate(6561,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="1013" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="8009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="9066" y="0"></use>
</g>
</svg>) and the space of rotations in
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.06ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1317.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper R cubed</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="1221" y="585"></use>
</g>
</svg>: specifically, a rotation of angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.253ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 970 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="500" y="0"></use>
</g>
</svg> about a unit axis
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.176ex" style="vertical-align: -0.012ex; margin-bottom: -0.326ex;" viewBox="0 -791.3 607.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold v With bold caret</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="526" y="-34"></use>
</g>
</svg> can be mapped to a unit quaternion <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.563ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5839.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis ModifyingAbove bold v With bold caret sine theta comma cosine theta right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="526" y="-34"></use>
</g>
<g transform="translate(1163,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="2559" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3029" y="0"></use>
<g transform="translate(3474,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="4980" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5450" y="0"></use>
</g>
</svg>, in which case the following quaternion product is
equivalent to applying the rotation to a point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> expressed in homogeneous
coordinate form:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.387ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 5333.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime Subscript Baseline equals bold q normal p Subscript Baseline bold q Superscript negative 1 Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="583"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="2278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="2886" y="0"></use>
<g transform="translate(3442,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="5054" y="0"></use>
</g>
</svg>
</div>
<p>

Furthermore, the product of several rotation quaternions produces
another quaternion that is equivalent to applying the rotations in sequence.

</p>
<p>The implementation of the <span class="anchor" id="Quaternion"></span><tt>Quaternion</tt> class in
<tt>pbrt</tt> is in the files <span class="anchor" id="corequaternion.h"></span><a href="https://github.com/mmp/pbrt-v3/tree/master/src/core/quaternion.h"><tt>core/quaternion.h</tt></a> and
<span class="anchor" id="corequaternion.cpp"></span><a href="https://github.com/mmp/pbrt-v3/tree/master/src/core/quaternion.cpp"><tt>core/quaternion.cpp</tt></a>.  The default
constructor initializes a unit quaternion.

</p>
<p>

</p>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-QuaternionPublicMethods-0"></span><div class="fragmentname">&lt;&lt;Quaternion Public Methods&gt;&gt;=&nbsp;<a href="#fragment-QuaternionPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Quaternion() : <a href="#Quaternion::v" class="code">v</a>(0, 0, 0), <a href="#Quaternion::w" class="code">w</a>(1) { }</div><p>


</p>
<p>We use a <a href="../Geometry_and_Transformations/Vectors.html#Vector3f"><tt>Vector3f</tt></a> to represent the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.555ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1530.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</svg> components of the
quaternion; doing so lets us make use of various methods of <a href="../Geometry_and_Transformations/Vectors.html#Vector3f"><tt>Vector3f</tt></a>
in the implementation of some of the methods below.

</p>
<p></p>
<span class="anchor" id="fragment-QuaternionPublicData-0"></span><div class="fragmentname">&lt;&lt;Quaternion Public Data&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <span class="anchor" id="Quaternion::v"></span>v;
Float <span class="anchor" id="Quaternion::w"></span>w;</div><p>


</p>
<p>Addition and subtraction of quaternions is performed component-wise.  This
follows directly from the definition in Equation&nbsp;(<a href="#eq:quat-define">2.4</a>).  For
example,
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.812ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 23599.5 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column bold q plus bold q prime 2nd Column equals w plus x normal i plus y normal j plus z normal k plus w prime plus x prime normal i plus y prime normal j plus z prime normal k 2nd Row 1st Column Blank 2nd Column equals left-parenthesis w plus w Superscript prime Baseline right-parenthesis plus left-parenthesis x plus x Superscript prime Baseline right-parenthesis normal i plus left-parenthesis y plus y Superscript prime Baseline right-parenthesis normal j plus left-parenthesis z plus z Superscript prime Baseline right-parenthesis normal k period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6A" d="M210 -50c0 -91 -62 -155 -137 -155c-57 0 -113 28 -113 80c0 26 18 46 46 46s46 -20 46 -46c0 -27 -20 -41 -35 -45c26 -13 49 -13 54 -13c64 0 73 86 73 131v396c0 49 -9 56 -86 56v31l152 11v-492zM210 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53 c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6B" d="M511 0c-29 2 -58 3 -87 3l-108 -3v31c19 0 36 4 36 23c0 18 -42 74 -119 180l-64 -55v-103c0 -45 11 -45 78 -45v-31l-110 3l-109 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-480l141 122c8 7 22 19 22 39c0 13 -10 24 -29 25v31c14 -1 76 -3 112 -3 c28 0 41 0 70 3v-31c-21 -1 -63 -3 -126 -54c-10 -8 -81 -68 -81 -72c0 -3 5 -9 6 -11l127 -179c38 -53 60 -53 97 -53v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,727)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="829" y="0"></use>
<g transform="translate(1830,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
</g>
</g>
</g>
<g transform="translate(3093,0)">
<g transform="translate(0,727)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1995" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="2995" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="3568" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4068" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="5069" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="5560" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6088" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="7089" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="7557" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8307" y="0"></use>
<g transform="translate(9308,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1013" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10635" y="0"></use>
<g transform="translate(11636,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="809" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="12596" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="13097" y="0"></use>
<g transform="translate(14098,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="693" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="14976" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="15505" y="0"></use>
<g transform="translate(16506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="662" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="17362" y="0"></use>
</g>
<g transform="translate(0,-781)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="1445" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2384" y="0"></use>
<g transform="translate(3385,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1013" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4489" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5101" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6102" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="6491" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7286" y="0"></use>
<g transform="translate(8287,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="809" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9247" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="9637" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10138" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="11138" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="11528" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="12241" y="0"></use>
<g transform="translate(13241,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="693" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="14120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6A" x="14509" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="15038" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="16039" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="16428" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="17118" y="0"></use>
<g transform="translate(18119,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="662" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="18975" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6B" x="19365" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="19893" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>


</p>
<p>
Other arithmetic methods (subtraction, multiplication, and division by a
scalar) are defined and implemented similarly and won&rsquo;t be included here.  

</p>
<p></p>
<span class="anchor" id="fragment-QuaternionPublicMethods-1"></span><div class="fragmentname">&lt;&lt;Quaternion Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-QuaternionPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-QuaternionPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Quaternion &amp;operator+=(const Quaternion &amp;q) {
    <a href="#Quaternion::v" class="code">v</a> += q.<a href="#Quaternion::v" class="code">v</a>;
    <a href="#Quaternion::w" class="code">w</a> += q.<a href="#Quaternion::w" class="code">w</a>;
    return *this;
}</div><p>


</p>
<p>



</p>
<p>

</p>
<p>The inner product of two quaternions is implemented by its <tt>Dot()</tt>
method, and a quaternion can be normalized by dividing by its length.

</p>
<p></p>
<span class="anchor" id="fragment-QuaternionInlineFunctions-0"></span><div class="fragmentname">&lt;&lt;Quaternion Inline Functions&gt;&gt;=&nbsp;<a href="#fragment-QuaternionInlineFunctions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">inline Float <span class="anchor" id="Quaternion::Dot"></span><a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(const Quaternion &amp;q1, const Quaternion &amp;q2) {
    return <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(q1.<a href="#Quaternion::v" class="code">v</a>, q2.<a href="#Quaternion::v" class="code">v</a>) + q1.<a href="#Quaternion::w" class="code">w</a> * q2.<a href="#Quaternion::w" class="code">w</a>;
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-QuaternionInlineFunctions-1"></span><div class="fragmentname">&lt;&lt;Quaternion Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-QuaternionInlineFunctions-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">inline Quaternion <span class="anchor" id="Quaternion::Normalize"></span>Normalize(const Quaternion &amp;q) {
    return q / std::sqrt(<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(q, q));
}</div><p>


</p>
<p>

</p>
<p>It&rsquo;s useful to be able to compute the transformation matrix that
represents the same rotation as a quaternion.  In particular, after
interpolating rotations with quaternions in the <a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a>
class, we&rsquo;ll
need to convert the interpolated rotation back to a transformation matrix
to compute the final composite interpolated transformation.

</p>
<p>To derive the rotation matrix for a quaternion, recall that the
transformation of a point by a quaternion is given by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.74ex" height="2.843ex" style="vertical-align: -0.671ex;" viewBox="0 -934.9 5054.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime Subscript Baseline equals bold q normal p Subscript Baseline bold q Superscript negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="2278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="2886" y="0"></use>
<g transform="translate(3442,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,362)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
</svg>.  We want a matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg> that performs the same
transformation, so that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.122ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 3927.7 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime Subscript Baseline equals bold upper M normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="2278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="3371" y="0"></use>
</g>
</svg>.  If we expand out the
quaternion multiplication <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.447ex" height="2.843ex" style="vertical-align: -0.671ex;" viewBox="0 -934.9 2775.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q normal p Subscript Baseline bold q Superscript negative 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="607" y="0"></use>
<g transform="translate(1164,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,362)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
</svg> using
Equation&nbsp;(<a href="#eq:quat-mult">2.5</a>), simplify with the quaternion basis identities,
collect terms, and represent the result in a matrix, we can determine that
the following <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3 times 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1723" y="0"></use>
</g>
</svg> matrix represents the same transformation:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:quat-matrix"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.359ex" height="10.676ex" style="vertical-align: -4.838ex;" viewBox="0 -2513.6 27710.2 4596.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M equals Start 3 By 3 Matrix 1st Row 1st Column 1 minus 2 left-parenthesis bold q Subscript y Superscript 2 Baseline plus bold q Subscript z Superscript 2 Baseline right-parenthesis 2nd Column 2 left-parenthesis bold q Subscript x Baseline bold q Subscript y Baseline plus bold q Subscript z Baseline bold q Subscript w Baseline right-parenthesis 3rd Column 2 left-parenthesis bold q Subscript x Baseline bold q Subscript z Baseline minus bold q Subscript y Baseline bold q Subscript w Baseline right-parenthesis 2nd Row 1st Column 2 left-parenthesis bold q Subscript x Baseline bold q Subscript y Baseline minus bold q Subscript z Baseline bold q Subscript w Baseline right-parenthesis 2nd Column 1 minus 2 left-parenthesis bold q Subscript x Superscript 2 Baseline plus bold q Subscript z Superscript 2 Baseline right-parenthesis 3rd Column 2 left-parenthesis bold q Subscript y Baseline bold q Subscript z Baseline plus bold q Subscript x Baseline bold q Subscript w Baseline right-parenthesis 3rd Row 1st Column 2 left-parenthesis bold q Subscript x Baseline bold q Subscript z Baseline plus bold q Subscript y Baseline bold q Subscript w Baseline right-parenthesis 2nd Column 2 left-parenthesis bold q Subscript y Baseline bold q Subscript z Baseline minus bold q Subscript x Baseline bold q Subscript w Baseline right-parenthesis 3rd Column 1 minus 2 left-parenthesis bold q Subscript x Superscript 2 Baseline plus bold q Subscript y Superscript 2 Baseline right-parenthesis EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1370" y="0"></use>
<g transform="translate(2426,0)">
<g transform="translate(0,2439)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2928.4607382542117) scale(1,2.9688591948982195)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-4378"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(286,1622)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2223" y="0"></use>
<g transform="translate(2613,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3897" y="0"></use>
<g transform="translate(4897,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5959" y="0"></use>
</g>
<g transform="translate(0,29)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
<g transform="translate(2002,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3278" y="0"></use>
<g transform="translate(4279,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
<g transform="translate(5317,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6531" y="0"></use>
</g>
<g transform="translate(0,-1564)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
<g transform="translate(2002,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3262" y="0"></use>
<g transform="translate(4263,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
<g transform="translate(5317,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6531" y="0"></use>
</g>
</g>
<g transform="translate(7910,0)">
<g transform="translate(0,1622)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
<g transform="translate(2002,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3278" y="0"></use>
<g transform="translate(4279,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
<g transform="translate(5317,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6531" y="0"></use>
</g>
<g transform="translate(260,29)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2223" y="0"></use>
<g transform="translate(2613,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3947" y="0"></use>
<g transform="translate(4948,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6010" y="0"></use>
</g>
<g transform="translate(0,-1564)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
<g transform="translate(1944,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3204" y="0"></use>
<g transform="translate(4205,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
<g transform="translate(5317,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6531" y="0"></use>
</g>
</g>
<g transform="translate(15832,0)">
<g transform="translate(0,1622)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
<g transform="translate(2002,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3262" y="0"></use>
<g transform="translate(4263,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
<g transform="translate(5317,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6531" y="0"></use>
</g>
<g transform="translate(0,29)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-326"></use>
</g>
<g transform="translate(1944,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3204" y="0"></use>
<g transform="translate(4205,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-326"></use>
</g>
<g transform="translate(5317,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6531" y="0"></use>
</g>
<g transform="translate(260,-1564)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2223" y="0"></use>
<g transform="translate(2613,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3947" y="0"></use>
<g transform="translate(4948,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="859" y="-211"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6010" y="0"></use>
</g>
</g>
</g>
<g transform="translate(23962,2439)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2928.4607382542117) scale(1,2.9688591948982195)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-4378"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="27431" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:quat-matrix">2.6</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>
 

</p>
<p>This computation is implemented in the method
<tt>Quaternion::ToTransform()</tt>.  We won&rsquo;t include its implementation here
since it&rsquo;s a direct implementation of Equation&nbsp;(<a href="#eq:quat-matrix">2.6</a>).

</p>
<p></p>
<span class="anchor" id="fragment-QuaternionPublicMethods-2"></span><div class="fragmentname">&lt;&lt;Quaternion Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-QuaternionPublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-QuaternionPublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> <span class="anchor" id="Quaternion::ToTransform"></span>ToTransform() const;</div><p>


</p>
<p>Note that we could alternatively use the fact that a unit quaternion
represents a rotation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.803ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 10248.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis bold q Subscript x y z Baseline sine left-parenthesis theta slash 2 right-parenthesis comma cosine left-parenthesis theta slash 2 right-parenthesis right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
<g transform="translate(2345,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3575" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="3964" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="4434" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="4934" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5435" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5824" y="0"></use>
<g transform="translate(6270,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="7609" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="7999" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="8468" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="8969" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9469" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9859" y="0"></use>
</g>
</svg> of
angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> around the unit axis <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.157ex" height="3.009ex" style="vertical-align: -1.171ex;" viewBox="0 -791.3 1789.7 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold q With bold caret Subscript x y z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="526" y="-28"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
</svg> to compute
a rotation matrix.  First we would compute the angle of rotation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> as
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.163ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 6528.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta equals 2 arc cosine bold q Subscript w</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="747" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1803" y="0"></use>
<g transform="translate(2470,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-61"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-63" x="893" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-63" x="1337" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="1782" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="2282" y="0"></use>
</g>
<g transform="translate(5314,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
</g>
</svg>, and then we&rsquo;d use the
previously defined <a href="../Geometry_and_Transformations/Transformations.html#Rotate"><tt>Rotate()</tt></a> function, passing it the axis
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.157ex" height="3.009ex" style="vertical-align: -1.171ex;" viewBox="0 -791.3 1789.7 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ModifyingAbove bold q With bold caret Subscript x y z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-302" d="M-82 607l-12 -20c-58 25 -115 54 -170 85c-55 -31 -112 -60 -170 -85l-12 20c56 49 117 91 182 127c65 -36 126 -78 182 -127Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-302" x="526" y="-28"></use>
<g transform="translate(607,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</g>
</svg> and the rotation angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg>.  However, this
alternative would be substantially less efficient, requiring multiple calls
to trigonometric functions, while the approach implemented here only uses
floating-point addition, subtraction, and multiplication.

</p>
<p>

</p>
<p>It is also useful to be able to create a quaternion from a rotation matrix.
For this purpose, <tt>Quaternion</tt> provides a constructor that takes a
<a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a>.  The appropriate quaternion can be computed by making use
of relationships between elements of the rotation matrix
in Equation&nbsp;(<a href="#eq:quat-matrix">2.6</a>) and quaternion components.  For example, if
we subtract the transpose of this matrix from itself, then the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>
component of the resulting matrix has the value <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.202ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 3531.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">minus 4 bold q Subscript w Baseline bold q Subscript z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="778" y="0"></use>
<g transform="translate(1279,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D464" x="859" y="-326"></use>
</g>
<g transform="translate(2493,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="859" y="-326"></use>
</g>
</g>
</svg>.  Thus, given a particular instance of a rotation matrix
with known values, it&rsquo;s possible to use a number of relationships like this
between the matrix values and the quaternion components to generate a
system of equations that can be solved for the quaternion components.

</p>
<p>We won&rsquo;t include the details of the derivation or the actual implementation
here in the text; for more information about how to derive this technique,
including handling numerical robustness, see Shoemake (<a href="Further_Reading.html#cite:Shoemake">1991</a>).

</p>
<p></p>
<span class="anchor" id="fragment-QuaternionPublicMethods-3"></span><div class="fragmentname">&lt;&lt;Quaternion Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-QuaternionPublicMethods-2"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Quaternion(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> &amp;t);</div><p>


</p>
<p>

</p>
<p>


</p>
<p>
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#QuaternionInterpolation"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:quaternion-interpolation"></span><span id="QuaternionInterpolation"></span><h3>2.9.2  Quaternion Interpolation</h3><p>



</p>
<p>The last quaternion function we will define, <a href="#Slerp"><tt>Slerp()</tt></a>, interpolates
between two quaternions using spherical linear
interpolation.  Spherical linear interpolation gives
constant speed motion along great circle arcs on the surface of a sphere
and consequently has two desirable properties for
interpolating rotations: 
</p>
<ul>
<li> The interpolated rotation path
exhibits <em>torque minimization</em>: the path to get between two rotations
is the shortest possible path in rotation space.
<li> The interpolation has <em>constant angular velocity</em>: the
relationship between change in the animation parameter <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> and the change
in the resulting rotation is constant over the course of interpolation (in
other words, the speed of interpolation is constant across the
interpolation range).
</ul><p>

See the &ldquo;Further Reading&rdquo; section at the end of the chapter for
references that discuss more thoroughly what characteristics a good
interpolated rotation should have.

</p>
<p>

</p>
<p>Spherical linear interpolation for quaternions was originally presented by
Shoemake (<a href="Further_Reading.html#cite:Shoemake85">1985</a>) as follows, where two quaternions <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg> are given and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.333ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3587.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t element-of left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2208" d="M587 -23c0 -11 -9 -20 -20 -20h-193c-162 0 -293 131 -293 293s131 293 293 293h193c11 0 20 -9 20 -20s-9 -20 -20 -20h-193c-133 0 -242 -103 -252 -233h445c27 0 27 -40 0 -40h-445c10 -130 119 -233 252 -233h193c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2208" x="639" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="1584" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1863" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="3309" y="0"></use>
</g>
</svg> is the parameter value to
interpolate between them:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.263ex" height="5.843ex" style="vertical-align: -2.005ex;" viewBox="0 -1652.5 20349.4 2515.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">s l e r p italic left-parenthesis bold q bold 1 italic comma bold q bold 2 italic comma t italic right-parenthesis italic equals StartFraction bold q bold 1 sine italic left-parenthesis italic left-parenthesis italic 1 minus t italic right-parenthesis theta italic right-parenthesis italic plus bold q bold 2 sine italic left-parenthesis t theta italic right-parenthesis Over sine theta EndFraction italic period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6C" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="1117" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1510" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2066" y="0"></use>
<g transform="translate(2456,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3570" y="0"></use>
<g transform="translate(4015,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5130" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="5575" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5964" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="6631" y="0"></use>
<g transform="translate(7410,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="12142" height="60" x="0" y="220"></rect>
<g transform="translate(60,768)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
<g transform="translate(1281,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2510" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2900" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3289" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4012" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="5013" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5402" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="5792" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6261" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6873" y="0"></use>
<g transform="translate(7873,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
<g transform="translate(9155,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10384" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="10774" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="11163" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11633" y="0"></use>
</g>
<g transform="translate(5138,-726)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1396" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="20070" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>An intuitive way to understand <a href="#Slerp"><tt>Slerp()</tt></a> was presented by Blow (<a href="Further_Reading.html#cite:Blow2004">2004</a>).
As context, given the quaternions to interpolate between, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg>, denote by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> the angle between them.  Then, given a
parameter value <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.333ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3587.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t element-of left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2208" d="M587 -23c0 -11 -9 -20 -20 -20h-193c-162 0 -293 131 -293 293s131 293 293 293h193c11 0 20 -9 20 -20s-9 -20 -20 -20h-193c-133 0 -242 -103 -252 -233h445c27 0 27 -40 0 -40h-445c10 -130 119 -233 252 -233h193c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2208" x="639" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="1584" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1863" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="3309" y="0"></use>
</g>
</svg>, we&rsquo;d like to find the intermediate
quaternion <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.312ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 995.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="513"></use>
</g>
</svg> that makes angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.02ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 3022.7 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta prime equals theta t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1135" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="2191" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2661" y="0"></use>
</g>
</svg> between it and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg>, along the path from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg>.  

</p>
<p></p>
<span class="anchor" id="fig:quaternion-slerp"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="Quaternion%20rotation.svg" title=""><img src="Quaternion%20rotation.svg" width=286 height=291 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 2.17: <span class="legend"> To understand quaternion spherical linear interpolation,
  consider in 2D two vectors on the unit sphere, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="859" y="-213"></use>
</g>
</svg> and
  <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg>, with angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> between them.  We&rsquo;d like to be able to
  compute the interpolated vector at some angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.992ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 857.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="513"></use>
</g>
</svg> between the two
  of them.  To do so, we can find a vector that&rsquo;s orthogonal to
  <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v bold 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="859" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.922ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1258 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
</g>
</svg> and then apply the trigonometric identity
  <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.261ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 10876 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v prime equals bold v bold 0 cosine theta Superscript prime Baseline plus bold v Subscript up-tack Baseline sine theta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1273" y="0"></use>
<g transform="translate(2329,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="859" y="-213"></use>
</g>
<g transform="translate(3610,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(5116,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6196" y="0"></use>
<g transform="translate(7197,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
</g>
<g transform="translate(8622,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(10018,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="513"></use>
</g>
</g>
</svg>.
</span>
</figcaption><p>

 
</p>
</div></div><p>


</p>
<p>An easy way to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.312ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 995.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="513"></use>
</g>
</svg> is to first compute an orthogonal
coordinate system in the space of quaternions where one axis is
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and the other is a quaternion orthogonal to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> such that
the two axes form a basis that spans <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg>.  Given
such a coordinate system, we can compute rotations with respect to
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg>.  (See Figure&nbsp;<a href="#fig:quaternion-slerp">2.17</a>, which illustrates the
concept in the 2D setting.)  An orthogonal vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.922ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1258 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
</g>
</svg> can be
found by projecting <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg> onto <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg> and then subtracting the
orthogonal projection from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
</svg>; the remainder is guaranteed to be
orthogonal to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1114.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:quat-perp"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.349ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10053.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q Subscript up-tack Baseline equals bold q bold 2 minus left-parenthesis bold q bold 1 dot bold q bold 2 right-parenthesis bold q bold 1 period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7D0" d="M517 222l-31 -222h-429v18c0 20 0 22 13 34l201 205c70 71 108 139 108 208c0 75 -46 143 -132 143c-36 0 -74 -11 -103 -35c15 -4 57 -20 57 -72c0 -50 -40 -72 -72 -72c-24 0 -72 15 -72 74c0 90 94 152 215 152c141 0 245 -74 245 -189c0 -95 -64 -142 -178 -226 c-45 -33 -97 -76 -144 -115h147c16 0 91 0 102 6c14 7 23 71 26 91h47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1535" y="0"></use>
<g transform="translate(2592,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3928" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4929" y="0"></use>
<g transform="translate(5318,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="6655" y="0"></use>
<g transform="translate(7156,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7D0" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8270" y="0"></use>
<g transform="translate(8660,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="9774" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:quat-perp">2.7</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

Given the coordinate system and a normalized <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.922ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1258 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
</g>
</svg>,
quaternions along the animation path are given by
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:quat-ortho-interp"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.628ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 12325.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold q prime equals bold q bold 1 cosine left-parenthesis theta t right-parenthesis plus ModifyingAbove bold q Subscript up-tack Baseline With bold caret sine left-parenthesis theta t right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42A" d="M601 -194l-126 3l-126 -3v47h69v195c-46 -40 -91 -54 -140 -54c-139 0 -240 87 -240 228c0 139 103 228 249 228c60 0 116 -30 151 -79l53 79h41v-597h69v-47zM424 142v139c0 50 -48 129 -124 129c-60 0 -134 -47 -134 -189c0 -133 60 -191 122 -191c30 0 81 11 121 70 c15 21 15 24 15 42Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5E" d="M561 584l-12 -22l-272 123l-271 -123l-11 22l283 160Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="859" y="583"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1273" y="0"></use>
<g transform="translate(2329,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="859" y="-213"></use>
</g>
<g transform="translate(3610,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4950" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="5339" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="5809" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6170" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6782" y="0"></use>
<g transform="translate(7783,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="859" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5E" x="350" y="-3"></use>
</g>
<g transform="translate(9207,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10437" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="10826" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="11296" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11657" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="12047" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:quat-ortho-interp">2.8</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>


</p>
<p>The implementation of the <a href="#Slerp"><tt>Slerp()</tt></a> function checks to see if the two
quaternions are nearly parallel, in which case it uses regular linear
interpolation of quaternion components in order to avoid numerical
instability.  Otherwise, it computes an orthogonal quaternion <tt>qperp</tt>
using Equation&nbsp;(<a href="#eq:quat-perp">2.7</a>) and then computes the interpolated
quaternion with Equation&nbsp;(<a href="#eq:quat-ortho-interp">2.8</a>).

</p>
<p></p>
<span class="anchor" id="fragment-QuaternionMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;Quaternion Method Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Quaternion <span class="anchor" id="Slerp"></span>Slerp(Float t, const Quaternion &amp;q1,
                 const Quaternion &amp;q2) {
    Float cosTheta = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(q1, q2);
    if (cosTheta &gt; .9995f)
        return <a href="#Quaternion::Normalize" class="code">Normalize</a>((1 - t) * q1 + t * q2);
    else {
        Float theta = std::acos(<a href="../Utilities/Main_Include_File.html#Clamp" class="code">Clamp</a>(cosTheta, -1, 1));
        Float thetap = theta * t;
        Quaternion qperp = <a href="#Quaternion::Normalize" class="code">Normalize</a>(q2 - q1 * cosTheta);
        return q1 * std::cos(thetap) + qperp * std::sin(thetap);
    }
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#AnimatedTransformImplementation"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:animated-transform-class"></span><span id="AnimatedTransformImplementation"></span><h3>2.9.3  AnimatedTransform Implementation</h3><p>



</p>
<p>Given the foundations of the quaternion infrastructure, we can now
implement the <span class="anchor" id="AnimatedTransform"></span><tt>AnimatedTransform</tt> class,
which implements keyframe transformation interpolation in <tt>pbrt</tt>.  Its
constructor takes two transformations and the time values they are
associated with.

</p>
<p>As mentioned earlier, <a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a> decomposes the given
composite transformation matrices into scaling, rotation, and translation
components.  The decomposition is performed by the
<a href="#AnimatedTransform::Decompose"><tt>AnimatedTransform::Decompose()</tt></a> method.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Method Definitions&gt;&gt;=&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#AnimatedTransform" class="code">AnimatedTransform</a>::<a href="#AnimatedTransform" class="code">AnimatedTransform</a>(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *startTransform,
        Float startTime, const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *endTransform, Float endTime)
    : startTransform(startTransform), endTransform(endTransform),
      startTime(startTime), endTime(endTime),
      actuallyAnimated(*startTransform != *endTransform) {
    <a href="#AnimatedTransform::Decompose" class="code">Decompose</a>(startTransform-&gt;m, &amp;T[0], &amp;R[0], &amp;S[0]);
    <a href="#AnimatedTransform::Decompose" class="code">Decompose</a>(endTransform-&gt;m, &amp;T[1], &amp;R[1], &amp;S[1]);
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FlipmonoR1ifneededtoselectshortestpath-0">Flip <tt>R[1]</tt> if needed to select shortest path</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-119" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-119"><i></i></a><div id="fragbit-119" class="collapse"><div class="fragmentcode">       if (<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(<a href="#AnimatedTransform::R" class="code">R</a>[0], <a href="#AnimatedTransform::R" class="code">R</a>[1]) &lt; 0)
           <a href="#AnimatedTransform::R" class="code">R</a>[1] = -<a href="#AnimatedTransform::R" class="code">R</a>[1];</div></div>
    <a href="#AnimatedTransform::hasRotation" class="code">hasRotation</a> = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(R[0], R[1]) &lt; 0.9995f;
    &lt;&lt;<span class="fragmentname">Compute terms of motion derivative function</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-120" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-120"><i></i></a><div id="fragbit-120" class="collapse"><div class="fragmentcode">       if (hasRotation) {
           Float cosTheta = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(R[0], R[1]);
           Float theta = std::acos(<a href="../Utilities/Main_Include_File.html#Clamp" class="code">Clamp</a>(cosTheta, -1, 1));
           Quaternion qperp = Normalize(R[1] - R[0] * cosTheta);
       
           Float t0x = T[0].x;
           Float t0y = T[0].y;
           Float t0z = T[0].z;
           Float t1x = T[1].x;
           Float t1y = T[1].y;
           Float t1z = T[1].z;
           Float q1x = R[0].v.x;
           Float q1y = R[0].v.y;
           Float q1z = R[0].v.z;
           Float q1w = R[0].w;
           Float qperpx = qperp.v.x;
           Float qperpy = qperp.v.y;
           Float qperpz = qperp.v.z;
           Float qperpw = qperp.w;
           Float s000 = S[0].m[0][0];
           Float s001 = S[0].m[0][1];
           Float s002 = S[0].m[0][2];
           Float s010 = S[0].m[1][0];
           Float s011 = S[0].m[1][1];
           Float s012 = S[0].m[1][2];
           Float s020 = S[0].m[2][0];
           Float s021 = S[0].m[2][1];
           Float s022 = S[0].m[2][2];
           Float s100 = S[1].m[0][0];
           Float s101 = S[1].m[0][1];
           Float s102 = S[1].m[0][2];
           Float s110 = S[1].m[1][0];
           Float s111 = S[1].m[1][1];
           Float s112 = S[1].m[1][2];
           Float s120 = S[1].m[2][0];
           Float s121 = S[1].m[2][1];
           Float s122 = S[1].m[2][2];
       
           c1[0] =
               DerivativeTerm(-t0x + t1x,
                    (-1 + q1y*q1y + q1z*q1z + qperpy*qperpy + qperpz*qperpz)*s000 + 
                    q1w*q1z*s010 - qperpx*qperpy*s010 + qperpw*qperpz*s010 - q1w*q1y*s020 - 
                    qperpw*qperpy*s020 - qperpx*qperpz*s020 + s100 - q1y*q1y*s100 - 
                    q1z*q1z*s100 - qperpy*qperpy*s100 - qperpz*qperpz*s100 - q1w*q1z*s110 + 
                    qperpx*qperpy*s110 - qperpw*qperpz*s110 + q1w*q1y*s120 + qperpw*qperpy*s120 + 
                    qperpx*qperpz*s120 + q1x*(-(q1y*s010) - q1z*s020 + q1y*s110 + q1z*s120),
                    (-1 + q1y*q1y + q1z*q1z + qperpy*qperpy + qperpz*qperpz)*s001 + 
                    q1w*q1z*s011 - qperpx*qperpy*s011 + qperpw*qperpz*s011 - q1w*q1y*s021 - 
                    qperpw*qperpy*s021 - qperpx*qperpz*s021 + s101 - q1y*q1y*s101 - 
                    q1z*q1z*s101 - qperpy*qperpy*s101 - qperpz*qperpz*s101 - q1w*q1z*s111 + 
                    qperpx*qperpy*s111 - qperpw*qperpz*s111 + q1w*q1y*s121 + qperpw*qperpy*s121 + 
                    qperpx*qperpz*s121 + q1x*(-(q1y*s011) - q1z*s021 + q1y*s111 + q1z*s121),
                    (-1 + q1y*q1y + q1z*q1z + qperpy*qperpy + qperpz*qperpz)*s002 + 
                    q1w*q1z*s012 - qperpx*qperpy*s012 + qperpw*qperpz*s012 - q1w*q1y*s022 - 
                    qperpw*qperpy*s022 - qperpx*qperpz*s022 + s102 - q1y*q1y*s102 - 
                    q1z*q1z*s102 - qperpy*qperpy*s102 - qperpz*qperpz*s102 - q1w*q1z*s112 + 
                    qperpx*qperpy*s112 - qperpw*qperpz*s112 + q1w*q1y*s122 + qperpw*qperpy*s122 + 
                    qperpx*qperpz*s122 + q1x*(-(q1y*s012) - q1z*s022 + q1y*s112 + q1z*s122));
       
           c2[0] = DerivativeTerm(0.,
                     -(qperpy*qperpy*s000) - qperpz*qperpz*s000 + qperpx*qperpy*s010 - 
                     qperpw*qperpz*s010 + qperpw*qperpy*s020 + qperpx*qperpz*s020 + 
                     q1y*q1y*(s000 - s100) + q1z*q1z*(s000 - s100) + qperpy*qperpy*s100 + 
                     qperpz*qperpz*s100 - qperpx*qperpy*s110 + qperpw*qperpz*s110 - 
                     qperpw*qperpy*s120 - qperpx*qperpz*s120 + 2*q1x*qperpy*s010*theta - 
                     2*q1w*qperpz*s010*theta + 2*q1w*qperpy*s020*theta + 2*q1x*qperpz*s020*theta + 
                     q1y*(q1x*(-s010 + s110) + q1w*(-s020 + s120) + 
                          2*(-2*qperpy*s000 + qperpx*s010 + qperpw*s020)*theta) + 
                     q1z*(q1w*(s010 - s110) + q1x*(-s020 + s120) - 
                          2*(2*qperpz*s000 + qperpw*s010 - qperpx*s020)*theta),
                     -(qperpy*qperpy*s001) - qperpz*qperpz*s001 + qperpx*qperpy*s011 - 
                     qperpw*qperpz*s011 + qperpw*qperpy*s021 + qperpx*qperpz*s021 + 
                     q1y*q1y*(s001 - s101) + q1z*q1z*(s001 - s101) + qperpy*qperpy*s101 + 
                     qperpz*qperpz*s101 - qperpx*qperpy*s111 + qperpw*qperpz*s111 - 
                     qperpw*qperpy*s121 - qperpx*qperpz*s121 + 2*q1x*qperpy*s011*theta - 
                     2*q1w*qperpz*s011*theta + 2*q1w*qperpy*s021*theta + 2*q1x*qperpz*s021*theta + 
                     q1y*(q1x*(-s011 + s111) + q1w*(-s021 + s121) + 
                          2*(-2*qperpy*s001 + qperpx*s011 + qperpw*s021)*theta) + 
                     q1z*(q1w*(s011 - s111) + q1x*(-s021 + s121) - 
                          2*(2*qperpz*s001 + qperpw*s011 - qperpx*s021)*theta),
                     -(qperpy*qperpy*s002) - qperpz*qperpz*s002 + qperpx*qperpy*s012 - 
                     qperpw*qperpz*s012 + qperpw*qperpy*s022 + qperpx*qperpz*s022 + 
                     q1y*q1y*(s002 - s102) + q1z*q1z*(s002 - s102) + qperpy*qperpy*s102 + 
                     qperpz*qperpz*s102 - qperpx*qperpy*s112 + qperpw*qperpz*s112 - 
                     qperpw*qperpy*s122 - qperpx*qperpz*s122 + 2*q1x*qperpy*s012*theta - 
                     2*q1w*qperpz*s012*theta + 2*q1w*qperpy*s022*theta + 2*q1x*qperpz*s022*theta + 
                     q1y*(q1x*(-s012 + s112) + q1w*(-s022 + s122) + 
                          2*(-2*qperpy*s002 + qperpx*s012 + qperpw*s022)*theta) + 
                     q1z*(q1w*(s012 - s112) + q1x*(-s022 + s122) - 
                          2*(2*qperpz*s002 + qperpw*s012 - qperpx*s022)*theta));
       
           c3[0] = DerivativeTerm(0.,
                     -2*(q1x*qperpy*s010 - q1w*qperpz*s010 + q1w*qperpy*s020 + q1x*qperpz*s020 - 
                         q1x*qperpy*s110 + q1w*qperpz*s110 - q1w*qperpy*s120 - q1x*qperpz*s120 + 
                         q1y*(-2*qperpy*s000 + qperpx*s010 + qperpw*s020 + 2*qperpy*s100 - qperpx*s110 - 
                              qperpw*s120) + q1z*(-2*qperpz*s000 - qperpw*s010 + qperpx*s020 + 
                                                  2*qperpz*s100 + qperpw*s110 - qperpx*s120))*theta,
                     -2*(q1x*qperpy*s011 - q1w*qperpz*s011 + q1w*qperpy*s021 + q1x*qperpz*s021 - 
                         q1x*qperpy*s111 + q1w*qperpz*s111 - q1w*qperpy*s121 - q1x*qperpz*s121 + 
                         q1y*(-2*qperpy*s001 + qperpx*s011 + qperpw*s021 + 2*qperpy*s101 - qperpx*s111 - 
                              qperpw*s121) + q1z*(-2*qperpz*s001 - qperpw*s011 + qperpx*s021 + 
                                                  2*qperpz*s101 + qperpw*s111 - qperpx*s121))*theta,
                     -2*(q1x*qperpy*s012 - q1w*qperpz*s012 + q1w*qperpy*s022 + q1x*qperpz*s022 - 
                         q1x*qperpy*s112 + q1w*qperpz*s112 - q1w*qperpy*s122 - q1x*qperpz*s122 + 
                         q1y*(-2*qperpy*s002 + qperpx*s012 + qperpw*s022 + 2*qperpy*s102 - qperpx*s112 - 
                              qperpw*s122) + q1z*(-2*qperpz*s002 - qperpw*s012 + qperpx*s022 + 
                                                  2*qperpz*s102 + qperpw*s112 - qperpx*s122))*theta);
       
           c4[0] = DerivativeTerm(0.,
                     -(q1x*qperpy*s010) + q1w*qperpz*s010 - q1w*qperpy*s020 - q1x*qperpz*s020 + 
                     q1x*qperpy*s110 - q1w*qperpz*s110 + q1w*qperpy*s120 + q1x*qperpz*s120 + 
                     2*q1y*q1y*s000*theta + 2*q1z*q1z*s000*theta - 
                     2*qperpy*qperpy*s000*theta - 2*qperpz*qperpz*s000*theta + 
                     2*qperpx*qperpy*s010*theta - 2*qperpw*qperpz*s010*theta + 
                     2*qperpw*qperpy*s020*theta + 2*qperpx*qperpz*s020*theta + 
                     q1y*(-(qperpx*s010) - qperpw*s020 + 2*qperpy*(s000 - s100) + qperpx*s110 + 
                          qperpw*s120 - 2*q1x*s010*theta - 2*q1w*s020*theta) + 
                     q1z*(2*qperpz*s000 + qperpw*s010 - qperpx*s020 - 2*qperpz*s100 - qperpw*s110 + 
                          qperpx*s120 + 2*q1w*s010*theta - 2*q1x*s020*theta),
                     -(q1x*qperpy*s011) + q1w*qperpz*s011 - q1w*qperpy*s021 - q1x*qperpz*s021 + 
                     q1x*qperpy*s111 - q1w*qperpz*s111 + q1w*qperpy*s121 + q1x*qperpz*s121 + 
                     2*q1y*q1y*s001*theta + 2*q1z*q1z*s001*theta - 
                     2*qperpy*qperpy*s001*theta - 2*qperpz*qperpz*s001*theta + 
                     2*qperpx*qperpy*s011*theta - 2*qperpw*qperpz*s011*theta + 
                     2*qperpw*qperpy*s021*theta + 2*qperpx*qperpz*s021*theta + 
                     q1y*(-(qperpx*s011) - qperpw*s021 + 2*qperpy*(s001 - s101) + qperpx*s111 + 
                          qperpw*s121 - 2*q1x*s011*theta - 2*q1w*s021*theta) + 
                     q1z*(2*qperpz*s001 + qperpw*s011 - qperpx*s021 - 2*qperpz*s101 - qperpw*s111 + 
                          qperpx*s121 + 2*q1w*s011*theta - 2*q1x*s021*theta),
                     -(q1x*qperpy*s012) + q1w*qperpz*s012 - q1w*qperpy*s022 - q1x*qperpz*s022 + 
                     q1x*qperpy*s112 - q1w*qperpz*s112 + q1w*qperpy*s122 + q1x*qperpz*s122 + 
                     2*q1y*q1y*s002*theta + 2*q1z*q1z*s002*theta - 
                     2*qperpy*qperpy*s002*theta - 2*qperpz*qperpz*s002*theta + 
                     2*qperpx*qperpy*s012*theta - 2*qperpw*qperpz*s012*theta + 
                     2*qperpw*qperpy*s022*theta + 2*qperpx*qperpz*s022*theta + 
                     q1y*(-(qperpx*s012) - qperpw*s022 + 2*qperpy*(s002 - s102) + qperpx*s112 + 
                          qperpw*s122 - 2*q1x*s012*theta - 2*q1w*s022*theta) + 
                     q1z*(2*qperpz*s002 + qperpw*s012 - qperpx*s022 - 2*qperpz*s102 - qperpw*s112 + 
                          qperpx*s122 + 2*q1w*s012*theta - 2*q1x*s022*theta));
       
       
           c5[0] = DerivativeTerm(0.,
                     2*(qperpy*qperpy*s000 + qperpz*qperpz*s000 - qperpx*qperpy*s010 + 
                        qperpw*qperpz*s010 - qperpw*qperpy*s020 - qperpx*qperpz*s020 - 
                        qperpy*qperpy*s100 - qperpz*qperpz*s100 + q1y*q1y*(-s000 + s100) + 
                        q1z*q1z*(-s000 + s100) + qperpx*qperpy*s110 - qperpw*qperpz*s110 + 
                        q1y*(q1x*(s010 - s110) + q1w*(s020 - s120)) + qperpw*qperpy*s120 + 
                        qperpx*qperpz*s120 + q1z*(-(q1w*s010) + q1x*s020 + q1w*s110 - q1x*s120))*theta,
                     2*(qperpy*qperpy*s001 + qperpz*qperpz*s001 - qperpx*qperpy*s011 + 
                        qperpw*qperpz*s011 - qperpw*qperpy*s021 - qperpx*qperpz*s021 - 
                        qperpy*qperpy*s101 - qperpz*qperpz*s101 + q1y*q1y*(-s001 + s101) + 
                        q1z*q1z*(-s001 + s101) + qperpx*qperpy*s111 - qperpw*qperpz*s111 + 
                        q1y*(q1x*(s011 - s111) + q1w*(s021 - s121)) + qperpw*qperpy*s121 + 
                        qperpx*qperpz*s121 + q1z*(-(q1w*s011) + q1x*s021 + q1w*s111 - q1x*s121))*theta,
                     2*(qperpy*qperpy*s002 + qperpz*qperpz*s002 - qperpx*qperpy*s012 + 
                        qperpw*qperpz*s012 - qperpw*qperpy*s022 - qperpx*qperpz*s022 - 
                        qperpy*qperpy*s102 - qperpz*qperpz*s102 + q1y*q1y*(-s002 + s102) + 
                        q1z*q1z*(-s002 + s102) + qperpx*qperpy*s112 - qperpw*qperpz*s112 + 
                        q1y*(q1x*(s012 - s112) + q1w*(s022 - s122)) + qperpw*qperpy*s122 + 
                        qperpx*qperpz*s122 + q1z*(-(q1w*s012) + q1x*s022 + q1w*s112 - q1x*s122))*theta);
       
       
           c1[1] = DerivativeTerm(-t0y + t1y,
                    -(qperpx*qperpy*s000) - qperpw*qperpz*s000 - s010 + q1z*q1z*s010 + 
                    qperpx*qperpx*s010 + qperpz*qperpz*s010 - q1y*q1z*s020 + qperpw*qperpx*s020 - 
                    qperpy*qperpz*s020 + qperpx*qperpy*s100 + qperpw*qperpz*s100 + 
                    q1w*q1z*(-s000 + s100) + q1x*q1x*(s010 - s110) + s110 - q1z*q1z*s110 - 
                    qperpx*qperpx*s110 - qperpz*qperpz*s110 + 
                    q1x*(q1y*(-s000 + s100) + q1w*(s020 - s120)) + q1y*q1z*s120 - qperpw*qperpx*s120 + 
                    qperpy*qperpz*s120,
                    -(qperpx*qperpy*s001) - qperpw*qperpz*s001 - s011 + q1z*q1z*s011 + 
                    qperpx*qperpx*s011 + qperpz*qperpz*s011 - q1y*q1z*s021 + qperpw*qperpx*s021 - 
                    qperpy*qperpz*s021 + qperpx*qperpy*s101 + qperpw*qperpz*s101 + 
                    q1w*q1z*(-s001 + s101) + q1x*q1x*(s011 - s111) + s111 - q1z*q1z*s111 - 
                    qperpx*qperpx*s111 - qperpz*qperpz*s111 + 
                    q1x*(q1y*(-s001 + s101) + q1w*(s021 - s121)) + q1y*q1z*s121 - qperpw*qperpx*s121 + 
                    qperpy*qperpz*s121,
                    -(qperpx*qperpy*s002) - qperpw*qperpz*s002 - s012 + q1z*q1z*s012 + 
                    qperpx*qperpx*s012 + qperpz*qperpz*s012 - q1y*q1z*s022 + qperpw*qperpx*s022 - 
                    qperpy*qperpz*s022 + qperpx*qperpy*s102 + qperpw*qperpz*s102 + 
                    q1w*q1z*(-s002 + s102) + q1x*q1x*(s012 - s112) + s112 - q1z*q1z*s112 - 
                    qperpx*qperpx*s112 - qperpz*qperpz*s112 + 
                    q1x*(q1y*(-s002 + s102) + q1w*(s022 - s122)) + q1y*q1z*s122 - 
                    qperpw*qperpx*s122 + qperpy*qperpz*s122);
       
           c2[1] = DerivativeTerm(0.,
                     qperpx*qperpy*s000 + qperpw*qperpz*s000 + q1z*q1z*s010 - qperpx*qperpx*s010 - 
                     qperpz*qperpz*s010 - q1y*q1z*s020 - qperpw*qperpx*s020 + qperpy*qperpz*s020 - 
                     qperpx*qperpy*s100 - qperpw*qperpz*s100 + q1x*q1x*(s010 - s110) - 
                     q1z*q1z*s110 + qperpx*qperpx*s110 + qperpz*qperpz*s110 + q1y*q1z*s120 + 
                     qperpw*qperpx*s120 - qperpy*qperpz*s120 + 2*q1z*qperpw*s000*theta + 
                     2*q1y*qperpx*s000*theta - 4*q1z*qperpz*s010*theta + 2*q1z*qperpy*s020*theta + 
                     2*q1y*qperpz*s020*theta + q1x*(q1w*s020 + q1y*(-s000 + s100) - q1w*s120 + 
                                                    2*qperpy*s000*theta - 4*qperpx*s010*theta - 2*qperpw*s020*theta) + 
                     q1w*(-(q1z*s000) + q1z*s100 + 2*qperpz*s000*theta - 2*qperpx*s020*theta),
                     qperpx*qperpy*s001 + qperpw*qperpz*s001 + q1z*q1z*s011 - qperpx*qperpx*s011 - 
                     qperpz*qperpz*s011 - q1y*q1z*s021 - qperpw*qperpx*s021 + qperpy*qperpz*s021 - 
                     qperpx*qperpy*s101 - qperpw*qperpz*s101 + q1x*q1x*(s011 - s111) - 
                     q1z*q1z*s111 + qperpx*qperpx*s111 + qperpz*qperpz*s111 + q1y*q1z*s121 + 
                     qperpw*qperpx*s121 - qperpy*qperpz*s121 + 2*q1z*qperpw*s001*theta + 
                     2*q1y*qperpx*s001*theta - 4*q1z*qperpz*s011*theta + 2*q1z*qperpy*s021*theta + 
                     2*q1y*qperpz*s021*theta + q1x*(q1w*s021 + q1y*(-s001 + s101) - q1w*s121 + 
                                                    2*qperpy*s001*theta - 4*qperpx*s011*theta - 2*qperpw*s021*theta) + 
                     q1w*(-(q1z*s001) + q1z*s101 + 2*qperpz*s001*theta - 2*qperpx*s021*theta),
                     qperpx*qperpy*s002 + qperpw*qperpz*s002 + q1z*q1z*s012 - qperpx*qperpx*s012 - 
                     qperpz*qperpz*s012 - q1y*q1z*s022 - qperpw*qperpx*s022 + qperpy*qperpz*s022 - 
                     qperpx*qperpy*s102 - qperpw*qperpz*s102 + q1x*q1x*(s012 - s112) - 
                     q1z*q1z*s112 + qperpx*qperpx*s112 + qperpz*qperpz*s112 + q1y*q1z*s122 + 
                     qperpw*qperpx*s122 - qperpy*qperpz*s122 + 2*q1z*qperpw*s002*theta + 
                     2*q1y*qperpx*s002*theta - 4*q1z*qperpz*s012*theta + 2*q1z*qperpy*s022*theta + 
                     2*q1y*qperpz*s022*theta +
                     q1x*(q1w*s022 + q1y*(-s002 + s102) - q1w*s122 + 
                          2*qperpy*s002*theta - 4*qperpx*s012*theta - 2*qperpw*s022*theta) + 
                     q1w*(-(q1z*s002) + q1z*s102 + 2*qperpz*s002*theta - 2*qperpx*s022*theta));
       
           c3[1] = DerivativeTerm(0.,
                     2*(-(q1x*qperpy*s000) - q1w*qperpz*s000 + 2*q1x*qperpx*s010 + q1x*qperpw*s020 + 
                        q1w*qperpx*s020 + q1x*qperpy*s100 + q1w*qperpz*s100 - 2*q1x*qperpx*s110 - 
                        q1x*qperpw*s120 - q1w*qperpx*s120 + 
                        q1z*(2*qperpz*s010 - qperpy*s020 + qperpw*(-s000 + s100) - 2*qperpz*s110 + 
                             qperpy*s120) + 
                        q1y*(-(qperpx*s000) - qperpz*s020 + qperpx*s100 + qperpz*s120))* theta,
                     2*(-(q1x*qperpy*s001) - q1w*qperpz*s001 + 2*q1x*qperpx*s011 + q1x*qperpw*s021 + 
                        q1w*qperpx*s021 + q1x*qperpy*s101 + q1w*qperpz*s101 - 2*q1x*qperpx*s111 - 
                        q1x*qperpw*s121 - q1w*qperpx*s121 + 
                        q1z*(2*qperpz*s011 - qperpy*s021 + qperpw*(-s001 + s101) - 2*qperpz*s111 + 
                             qperpy*s121) +
                        q1y*(-(qperpx*s001) - qperpz*s021 + qperpx*s101 + qperpz*s121))*theta,
                     2*(-(q1x*qperpy*s002) - q1w*qperpz*s002 + 2*q1x*qperpx*s012 + q1x*qperpw*s022 + 
                        q1w*qperpx*s022 + q1x*qperpy*s102 + q1w*qperpz*s102 - 2*q1x*qperpx*s112 - 
                        q1x*qperpw*s122 - q1w*qperpx*s122 + 
                        q1z*(2*qperpz*s012 - qperpy*s022 + qperpw*(-s002 + s102) - 2*qperpz*s112 + 
                             qperpy*s122) +
                        q1y*(-(qperpx*s002) - qperpz*s022 + qperpx*s102 + qperpz*s122))*theta);
       
           c4[1] = DerivativeTerm(0.,
                     -(q1x*qperpy*s000) - q1w*qperpz*s000 + 2*q1x*qperpx*s010 + q1x*qperpw*s020 + 
                     q1w*qperpx*s020 + q1x*qperpy*s100 + q1w*qperpz*s100 - 2*q1x*qperpx*s110 - 
                     q1x*qperpw*s120 - q1w*qperpx*s120 + 2*qperpx*qperpy*s000*theta + 
                     2*qperpw*qperpz*s000*theta + 2*q1x*q1x*s010*theta + 
                     2*q1z*q1z*s010*theta - 2*qperpx*qperpx*s010*theta - 
                     2*qperpz*qperpz*s010*theta + 2*q1w*q1x*s020*theta - 2*qperpw*qperpx*s020*theta + 
                     2*qperpy*qperpz*s020*theta + q1y*
                     (-(qperpx*s000) - qperpz*s020 + qperpx*s100 + qperpz*s120 - 2*q1x*s000*theta) + 
                     q1z*(2*qperpz*s010 - qperpy*s020 + qperpw*(-s000 + s100) - 2*qperpz*s110 + 
                          qperpy*s120 - 2*q1w*s000*theta - 2*q1y*s020*theta),
                     -(q1x*qperpy*s001) - q1w*qperpz*s001 + 2*q1x*qperpx*s011 + q1x*qperpw*s021 + 
                     q1w*qperpx*s021 + q1x*qperpy*s101 + q1w*qperpz*s101 - 2*q1x*qperpx*s111 - 
                     q1x*qperpw*s121 - q1w*qperpx*s121 + 2*qperpx*qperpy*s001*theta + 
                     2*qperpw*qperpz*s001*theta + 2*q1x*q1x*s011*theta + 
                     2*q1z*q1z*s011*theta - 2*qperpx*qperpx*s011*theta - 
                     2*qperpz*qperpz*s011*theta + 2*q1w*q1x*s021*theta - 2*qperpw*qperpx*s021*theta + 
                     2*qperpy*qperpz*s021*theta + q1y*
                     (-(qperpx*s001) - qperpz*s021 + qperpx*s101 + qperpz*s121 - 2*q1x*s001*theta) + 
                     q1z*(2*qperpz*s011 - qperpy*s021 + qperpw*(-s001 + s101) - 2*qperpz*s111 + 
                          qperpy*s121 - 2*q1w*s001*theta - 2*q1y*s021*theta),
                     -(q1x*qperpy*s002) - q1w*qperpz*s002 + 2*q1x*qperpx*s012 + q1x*qperpw*s022 + 
                     q1w*qperpx*s022 + q1x*qperpy*s102 + q1w*qperpz*s102 - 2*q1x*qperpx*s112 - 
                     q1x*qperpw*s122 - q1w*qperpx*s122 + 2*qperpx*qperpy*s002*theta + 
                     2*qperpw*qperpz*s002*theta + 2*q1x*q1x*s012*theta + 
                     2*q1z*q1z*s012*theta - 2*qperpx*qperpx*s012*theta - 
                     2*qperpz*qperpz*s012*theta + 2*q1w*q1x*s022*theta - 2*qperpw*qperpx*s022*theta + 
                     2*qperpy*qperpz*s022*theta + q1y*
                     (-(qperpx*s002) - qperpz*s022 + qperpx*s102 + qperpz*s122 - 2*q1x*s002*theta) + 
                     q1z*(2*qperpz*s012 - qperpy*s022 + qperpw*(-s002 + s102) - 2*qperpz*s112 + 
                          qperpy*s122 - 2*q1w*s002*theta - 2*q1y*s022*theta));
       
           c5[1] = DerivativeTerm(0.,
                     -2*(qperpx*qperpy*s000 + qperpw*qperpz*s000 + q1z*q1z*s010 - 
                         qperpx*qperpx*s010 - qperpz*qperpz*s010 - q1y*q1z*s020 - qperpw*qperpx*s020 + 
                         qperpy*qperpz*s020 - qperpx*qperpy*s100 - qperpw*qperpz*s100 + 
                         q1w*q1z*(-s000 + s100) + q1x*q1x*(s010 - s110) - q1z*q1z*s110 + 
                         qperpx*qperpx*s110 + qperpz*qperpz*s110 + 
                         q1x*(q1y*(-s000 + s100) + q1w*(s020 - s120)) + q1y*q1z*s120 + 
                         qperpw*qperpx*s120 - qperpy*qperpz*s120)*theta,
                     -2*(qperpx*qperpy*s001 + qperpw*qperpz*s001 + q1z*q1z*s011 - 
                         qperpx*qperpx*s011 - qperpz*qperpz*s011 - q1y*q1z*s021 - qperpw*qperpx*s021 + 
                         qperpy*qperpz*s021 - qperpx*qperpy*s101 - qperpw*qperpz*s101 + 
                         q1w*q1z*(-s001 + s101) + q1x*q1x*(s011 - s111) - q1z*q1z*s111 + 
                         qperpx*qperpx*s111 + qperpz*qperpz*s111 + 
                         q1x*(q1y*(-s001 + s101) + q1w*(s021 - s121)) + q1y*q1z*s121 + 
                         qperpw*qperpx*s121 - qperpy*qperpz*s121)*theta,
                     -2*(qperpx*qperpy*s002 + qperpw*qperpz*s002 + q1z*q1z*s012 - 
                         qperpx*qperpx*s012 - qperpz*qperpz*s012 - q1y*q1z*s022 - qperpw*qperpx*s022 + 
                         qperpy*qperpz*s022 - qperpx*qperpy*s102 - qperpw*qperpz*s102 + 
                         q1w*q1z*(-s002 + s102) + q1x*q1x*(s012 - s112) - q1z*q1z*s112 + 
                         qperpx*qperpx*s112 + qperpz*qperpz*s112 + 
                         q1x*(q1y*(-s002 + s102) + q1w*(s022 - s122)) + q1y*q1z*s122 + 
                         qperpw*qperpx*s122 - qperpy*qperpz*s122)*theta);
       
           c1[2] = DerivativeTerm(-t0z + t1z,
                    (qperpw*qperpy*s000 - qperpx*qperpz*s000 - q1y*q1z*s010 - 
                     qperpw*qperpx*s010 - qperpy*qperpz*s010 - s020 + q1y*q1y*s020 + 
                     qperpx*qperpx*s020 + qperpy*qperpy*s020 - qperpw*qperpy*s100 + 
                     qperpx*qperpz*s100 + q1x*q1z*(-s000 + s100) + q1y*q1z*s110 + 
                     qperpw*qperpx*s110 + qperpy*qperpz*s110 + 
                     q1w*(q1y*(s000 - s100) + q1x*(-s010 + s110)) + q1x*q1x*(s020 - s120) + 
                     s120 - q1y*q1y*s120 - qperpx*qperpx*s120 - qperpy*qperpy*s120),
                    (qperpw*qperpy*s001 - qperpx*qperpz*s001 - q1y*q1z*s011 - qperpw*qperpx*s011 - 
                     qperpy*qperpz*s011 - s021 + q1y*q1y*s021 + qperpx*qperpx*s021 + 
                     qperpy*qperpy*s021 - qperpw*qperpy*s101 + qperpx*qperpz*s101 + 
                     q1x*q1z*(-s001 + s101) + q1y*q1z*s111 + qperpw*qperpx*s111 + 
                     qperpy*qperpz*s111 + q1w*(q1y*(s001 - s101) + q1x*(-s011 + s111)) + 
                     q1x*q1x*(s021 - s121) + s121 - q1y*q1y*s121 - qperpx*qperpx*s121 - 
                     qperpy*qperpy*s121),
                    (qperpw*qperpy*s002 - qperpx*qperpz*s002 - 
                     q1y*q1z*s012 - qperpw*qperpx*s012 - qperpy*qperpz*s012 - s022 + 
                     q1y*q1y*s022 + qperpx*qperpx*s022 + qperpy*qperpy*s022 - 
                     qperpw*qperpy*s102 + qperpx*qperpz*s102 + q1x*q1z*(-s002 + s102) + 
                     q1y*q1z*s112 + qperpw*qperpx*s112 + qperpy*qperpz*s112 + 
                     q1w*(q1y*(s002 - s102) + q1x*(-s012 + s112)) + q1x*q1x*(s022 - s122) + 
                     s122 - q1y*q1y*s122 - qperpx*qperpx*s122 - qperpy*qperpy*s122));
       
           c2[2] = DerivativeTerm(0.,
                     (q1w*q1y*s000 - q1x*q1z*s000 - qperpw*qperpy*s000 + qperpx*qperpz*s000 - 
                      q1w*q1x*s010 - q1y*q1z*s010 + qperpw*qperpx*s010 + qperpy*qperpz*s010 + 
                      q1x*q1x*s020 + q1y*q1y*s020 - qperpx*qperpx*s020 - 
                      qperpy*qperpy*s020 - q1w*q1y*s100 + q1x*q1z*s100 + qperpw*qperpy*s100 - 
                      qperpx*qperpz*s100 + q1w*q1x*s110 + q1y*q1z*s110 - qperpw*qperpx*s110 - 
                      qperpy*qperpz*s110 - q1x*q1x*s120 - q1y*q1y*s120 + 
                      qperpx*qperpx*s120 + qperpy*qperpy*s120 - 2*q1y*qperpw*s000*theta + 
                      2*q1z*qperpx*s000*theta - 2*q1w*qperpy*s000*theta + 2*q1x*qperpz*s000*theta + 
                      2*q1x*qperpw*s010*theta + 2*q1w*qperpx*s010*theta + 2*q1z*qperpy*s010*theta + 
                      2*q1y*qperpz*s010*theta - 4*q1x*qperpx*s020*theta - 4*q1y*qperpy*s020*theta),
                     (q1w*q1y*s001 - q1x*q1z*s001 - qperpw*qperpy*s001 + qperpx*qperpz*s001 - 
                      q1w*q1x*s011 - q1y*q1z*s011 + qperpw*qperpx*s011 + qperpy*qperpz*s011 + 
                      q1x*q1x*s021 + q1y*q1y*s021 - qperpx*qperpx*s021 - 
                      qperpy*qperpy*s021 - q1w*q1y*s101 + q1x*q1z*s101 + qperpw*qperpy*s101 - 
                      qperpx*qperpz*s101 + q1w*q1x*s111 + q1y*q1z*s111 - qperpw*qperpx*s111 - 
                      qperpy*qperpz*s111 - q1x*q1x*s121 - q1y*q1y*s121 + 
                      qperpx*qperpx*s121 + qperpy*qperpy*s121 - 2*q1y*qperpw*s001*theta + 
                      2*q1z*qperpx*s001*theta - 2*q1w*qperpy*s001*theta + 2*q1x*qperpz*s001*theta + 
                      2*q1x*qperpw*s011*theta + 2*q1w*qperpx*s011*theta + 2*q1z*qperpy*s011*theta + 
                      2*q1y*qperpz*s011*theta - 4*q1x*qperpx*s021*theta - 4*q1y*qperpy*s021*theta),
                     (q1w*q1y*s002 - q1x*q1z*s002 - qperpw*qperpy*s002 + qperpx*qperpz*s002 - 
                      q1w*q1x*s012 - q1y*q1z*s012 + qperpw*qperpx*s012 + qperpy*qperpz*s012 + 
                      q1x*q1x*s022 + q1y*q1y*s022 - qperpx*qperpx*s022 - 
                      qperpy*qperpy*s022 - q1w*q1y*s102 + q1x*q1z*s102 + qperpw*qperpy*s102 - 
                      qperpx*qperpz*s102 + q1w*q1x*s112 + q1y*q1z*s112 - qperpw*qperpx*s112 - 
                      qperpy*qperpz*s112 - q1x*q1x*s122 - q1y*q1y*s122 + 
                      qperpx*qperpx*s122 + qperpy*qperpy*s122 - 2*q1y*qperpw*s002*theta + 
                      2*q1z*qperpx*s002*theta - 2*q1w*qperpy*s002*theta + 2*q1x*qperpz*s002*theta + 
                      2*q1x*qperpw*s012*theta + 2*q1w*qperpx*s012*theta + 2*q1z*qperpy*s012*theta + 
                      2*q1y*qperpz*s012*theta - 4*q1x*qperpx*s022*theta - 4*q1y*qperpy*s022*theta));
       
           c3[2] = DerivativeTerm(0.,
                     -2*(-(q1w*qperpy*s000) + q1x*qperpz*s000 + q1x*qperpw*s010 + q1w*qperpx*s010 - 
                         2*q1x*qperpx*s020 + q1w*qperpy*s100 - q1x*qperpz*s100 - q1x*qperpw*s110 - 
                         q1w*qperpx*s110 +
                         q1z*(qperpx*s000 + qperpy*s010 - qperpx*s100 - qperpy*s110) + 
                         2*q1x*qperpx*s120 +
                         q1y*(qperpz*s010 - 2*qperpy*s020 + qperpw*(-s000 + s100) - 
                              qperpz*s110 + 2*qperpy*s120))*theta,
                     -2*(-(q1w*qperpy*s001) + q1x*qperpz*s001 + q1x*qperpw*s011 + q1w*qperpx*s011 - 
                         2*q1x*qperpx*s021 + q1w*qperpy*s101 - q1x*qperpz*s101 - q1x*qperpw*s111 - 
                         q1w*qperpx*s111 +
                         q1z*(qperpx*s001 + qperpy*s011 - qperpx*s101 - qperpy*s111) + 
                         2*q1x*qperpx*s121 +
                         q1y*(qperpz*s011 - 2*qperpy*s021 + qperpw*(-s001 + s101) - 
                              qperpz*s111 + 2*qperpy*s121))*theta,
                     -2*(-(q1w*qperpy*s002) + q1x*qperpz*s002 + q1x*qperpw*s012 + q1w*qperpx*s012 - 
                         2*q1x*qperpx*s022 + q1w*qperpy*s102 - q1x*qperpz*s102 - q1x*qperpw*s112 - 
                         q1w*qperpx*s112 +
                         q1z*(qperpx*s002 + qperpy*s012 - qperpx*s102 - qperpy*s112) + 
                         2*q1x*qperpx*s122 +
                         q1y*(qperpz*s012 - 2*qperpy*s022 + qperpw*(-s002 + s102) - 
                              qperpz*s112 + 2*qperpy*s122))*theta);
       
           c4[2] = DerivativeTerm(0.,
                     q1w*qperpy*s000 - q1x*qperpz*s000 - q1x*qperpw*s010 - q1w*qperpx*s010 + 
                     2*q1x*qperpx*s020 - q1w*qperpy*s100 + q1x*qperpz*s100 + q1x*qperpw*s110 + 
                     q1w*qperpx*s110 - 2*q1x*qperpx*s120 - 2*qperpw*qperpy*s000*theta + 
                     2*qperpx*qperpz*s000*theta - 2*q1w*q1x*s010*theta + 2*qperpw*qperpx*s010*theta + 
                     2*qperpy*qperpz*s010*theta + 2*q1x*q1x*s020*theta + 
                     2*q1y*q1y*s020*theta - 2*qperpx*qperpx*s020*theta - 
                     2*qperpy*qperpy*s020*theta + q1z*
                     (-(qperpx*s000) - qperpy*s010 + qperpx*s100 + qperpy*s110 - 2*q1x*s000*theta) + 
                     q1y*(-(qperpz*s010) + 2*qperpy*s020 + qperpw*(s000 - s100) + qperpz*s110 - 
                          2*qperpy*s120 + 2*q1w*s000*theta - 2*q1z*s010*theta),
                     q1w*qperpy*s001 - q1x*qperpz*s001 - q1x*qperpw*s011 - q1w*qperpx*s011 + 
                     2*q1x*qperpx*s021 - q1w*qperpy*s101 + q1x*qperpz*s101 + q1x*qperpw*s111 + 
                     q1w*qperpx*s111 - 2*q1x*qperpx*s121 - 2*qperpw*qperpy*s001*theta + 
                     2*qperpx*qperpz*s001*theta - 2*q1w*q1x*s011*theta + 2*qperpw*qperpx*s011*theta + 
                     2*qperpy*qperpz*s011*theta + 2*q1x*q1x*s021*theta + 
                     2*q1y*q1y*s021*theta - 2*qperpx*qperpx*s021*theta - 
                     2*qperpy*qperpy*s021*theta + q1z*
                     (-(qperpx*s001) - qperpy*s011 + qperpx*s101 + qperpy*s111 - 2*q1x*s001*theta) + 
                     q1y*(-(qperpz*s011) + 2*qperpy*s021 + qperpw*(s001 - s101) + qperpz*s111 - 
                          2*qperpy*s121 + 2*q1w*s001*theta - 2*q1z*s011*theta),
                     q1w*qperpy*s002 - q1x*qperpz*s002 - q1x*qperpw*s012 - q1w*qperpx*s012 + 
                     2*q1x*qperpx*s022 - q1w*qperpy*s102 + q1x*qperpz*s102 + q1x*qperpw*s112 + 
                     q1w*qperpx*s112 - 2*q1x*qperpx*s122 - 2*qperpw*qperpy*s002*theta + 
                     2*qperpx*qperpz*s002*theta - 2*q1w*q1x*s012*theta + 2*qperpw*qperpx*s012*theta + 
                     2*qperpy*qperpz*s012*theta + 2*q1x*q1x*s022*theta + 
                     2*q1y*q1y*s022*theta - 2*qperpx*qperpx*s022*theta - 
                     2*qperpy*qperpy*s022*theta + q1z*
                     (-(qperpx*s002) - qperpy*s012 + qperpx*s102 + qperpy*s112 - 2*q1x*s002*theta) + 
                     q1y*(-(qperpz*s012) + 2*qperpy*s022 + qperpw*(s002 - s102) + qperpz*s112 - 
                          2*qperpy*s122 + 2*q1w*s002*theta - 2*q1z*s012*theta));
       
           c5[2] = DerivativeTerm(0.,
                     2*(qperpw*qperpy*s000 - qperpx*qperpz*s000 + q1y*q1z*s010 - qperpw*qperpx*s010 - 
                        qperpy*qperpz*s010 - q1y*q1y*s020 + qperpx*qperpx*s020 + 
                        qperpy*qperpy*s020 + q1x*q1z*(s000 - s100) - qperpw*qperpy*s100 + 
                        qperpx*qperpz*s100 + q1w*(q1y*(-s000 + s100) + q1x*(s010 - s110)) - 
                        q1y*q1z*s110 + qperpw*qperpx*s110 + qperpy*qperpz*s110 + q1y*q1y*s120 - 
                        qperpx*qperpx*s120 - qperpy*qperpy*s120 + q1x*q1x*(-s020 + s120))*theta,
                     2*(qperpw*qperpy*s001 - qperpx*qperpz*s001 + q1y*q1z*s011 - qperpw*qperpx*s011 - 
                        qperpy*qperpz*s011 - q1y*q1y*s021 + qperpx*qperpx*s021 + 
                        qperpy*qperpy*s021 + q1x*q1z*(s001 - s101) - qperpw*qperpy*s101 + 
                        qperpx*qperpz*s101 + q1w*(q1y*(-s001 + s101) + q1x*(s011 - s111)) - 
                        q1y*q1z*s111 + qperpw*qperpx*s111 + qperpy*qperpz*s111 + q1y*q1y*s121 - 
                        qperpx*qperpx*s121 - qperpy*qperpy*s121 + q1x*q1x*(-s021 + s121))*theta,
                     2*(qperpw*qperpy*s002 - qperpx*qperpz*s002 + q1y*q1z*s012 - qperpw*qperpx*s012 - 
                        qperpy*qperpz*s012 - q1y*q1y*s022 + qperpx*qperpx*s022 + 
                        qperpy*qperpy*s022 + q1x*q1z*(s002 - s102) - qperpw*qperpy*s102 + 
                        qperpx*qperpz*s102 + q1w*(q1y*(-s002 + s102) + q1x*(s012 - s112)) - 
                        q1y*q1z*s112 + qperpw*qperpx*s112 + qperpy*qperpz*s112 + q1y*q1y*s122 - 
                        qperpx*qperpx*s122 - qperpy*qperpy*s122 + q1x*q1x*(-s022 + s122))*theta);
       }</div></div>
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformPrivateData-0"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Private Data&gt;&gt;=&nbsp;<a href="#fragment-AnimatedTransformPrivateData-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *<span class="anchor" id="AnimatedTransform::startTransform"></span>startTransform, *<span class="anchor" id="AnimatedTransform::endTransform"></span>endTransform;
const Float <span class="anchor" id="AnimatedTransform::startTime"></span>startTime, <span class="anchor" id="AnimatedTransform::endTime"></span>endTime;
const bool <span class="anchor" id="AnimatedTransform::actuallyAnimated"></span>actuallyAnimated;
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <span class="anchor" id="AnimatedTransform::T"></span>T[2];
Quaternion <span class="anchor" id="AnimatedTransform::R"></span>R[2];
Matrix4x4 <span class="anchor" id="AnimatedTransform::S"></span>S[2];
bool <span class="anchor" id="AnimatedTransform::hasRotation"></span>hasRotation;</div><p>


</p>
<p>Given the composite matrix for a transformation, information has been lost
about any individual transformations that were composed to compute it.  For
example, given the matrix for the product of a translation and then a
scale, an equal matrix could also be computed by first scaling and then
translating (by different amounts).  Thus, we need to choose a canonical
sequence of transformations for the decomposition.  For our needs here, the
specific choice made isn&rsquo;t significant.  (It would be more important in an
animation system that was decomposing composite transformations in order to
make them editable by changing individual components, for example.)

</p>
<p>We will handle only affine transformations here, which is what is
needed for animating cameras and geometric primitives in a rendering
system; perspective transformations aren&rsquo;t generally relevant to animation
of objects like these.

</p>
<p>The transformation decomposition we will use is the following:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:animated-transformation"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.633ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 5008.6 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M equals bold upper T bold upper R bold upper S comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1370" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="2426" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="3227" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="4090" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4730" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:animated-transformation">2.9</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg> is the given transformation, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg> is a
translation, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.006ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 863.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper R</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
</g>
</svg> is a rotation, 
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg> is a scale.  <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg> is
actually a generalized scale (Shoemake and Duff call it <em>stretch</em>)
that represents a scale in <em>some</em> coordinate system, just not
necessarily the current one.  In any case, it can still be correctly
interpolated with linear interpolation of its components.  The
<tt>Decompose()</tt> method computes the decomposition given a
<a href="../Utilities/Mathematical_Routines.html#Matrix4x4"><tt>Matrix4x4</tt></a>.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformMethodDefinitions-1"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="AnimatedTransform::Decompose"></span><a href="#AnimatedTransform" class="code">AnimatedTransform</a>::Decompose(const Matrix4x4 &amp;m, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> *T,
        Quaternion *Rquat, Matrix4x4 *S) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ExtracttranslationmonoTfromtransformationmatrix-0">Extract translation <tt>T</tt> from transformation matrix</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-121" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-121"><i></i></a><div id="fragbit-121" class="collapse"><div class="fragmentcode">       T-&gt;x = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[0][3];
       T-&gt;y = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[1][3];
       T-&gt;z = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[2][3];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputenewtransformationmatrixmonoMwithouttranslation-0">Compute new transformation matrix <tt>M</tt> without translation</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-122" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-122"><i></i></a><div id="fragbit-122" class="collapse"><div class="fragmentcode">       Matrix4x4 M = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>;
       for (int i = 0; i &lt; 3; ++i)
           M.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][3] = M.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[3][i] = 0.f;
       M.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[3][3] = 1.f;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ExtractrotationmonoRfromtransformationmatrix-0">Extract rotation <tt>R</tt> from transformation matrix</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-123" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-123"><i></i></a><div id="fragbit-123" class="collapse"><div class="fragmentcode">       Float norm;
       int count = 0;
       Matrix4x4 R = M;
       do {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputenextmatrixmonoRnextinseries-0">Compute next matrix <tt>Rnext</tt> in series</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-124" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-124"><i></i></a><div id="fragbit-124" class="collapse"><div class="fragmentcode">              Matrix4x4 Rnext;
              Matrix4x4 Rit = <a href="../Utilities/Mathematical_Routines.html#Inverse" class="code">Inverse</a>(<a href="../Geometry_and_Transformations/Transformations.html#Transform::Transpose" class="code">Transpose</a>(R));
              for (int i = 0; i &lt; 4; ++i)
                  for (int j = 0; j &lt; 4; ++j)
                      Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j] = 0.5f * (R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j] + Rit.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j]);</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputenormofdifferencebetweenmonoRandmonoRnext-0">Compute norm of difference between <tt>R</tt> and <tt>Rnext</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-125" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-125"><i></i></a><div id="fragbit-125" class="collapse"><div class="fragmentcode">              norm = 0;
              for (int i = 0; i &lt; 3; ++i) {
                  Float n = std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][0] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][0]) + 
                            std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][1] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][1]) + 
                            std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][2] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][2]);
                  norm = std::max(norm, n);
              }</div></div>
           R = Rnext;
       } while (++count &lt; 100 &amp;&amp; norm &gt; .0001);
       *Rquat = Quaternion(R);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputescalemonoSusingrotationandoriginalmatrix-0">Compute scale <tt>S</tt> using rotation and original matrix</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-126" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-126"><i></i></a><div id="fragbit-126" class="collapse"><div class="fragmentcode">       *S = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::Mul" class="code">Matrix4x4</a>::Mul(<a href="../Utilities/Mathematical_Routines.html#Inverse" class="code">Inverse</a>(R), M);</div></div>
}</div><p>


</p>
<p>Extracting the translation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg> is easy; it can be found directly
from the appropriate elements of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
</g>
</svg> transformation matrix.

</p>
<p></p>
<span class="anchor" id="fragment-ExtracttranslationmonoTfromtransformationmatrix-0"></span><div class="fragmentname">&lt;&lt;Extract translation <tt>T</tt> from transformation matrix&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">T-&gt;x = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[0][3];
T-&gt;y = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[1][3];
T-&gt;z = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[2][3];</div><p>


</p>
<p>Since we are assuming an affine transformation (no projective components),
after we remove the translation, what is left is the
upper <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3 times 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1723" y="0"></use>
</g>
</svg> matrix that represents scaling and rotation together.
This matrix is copied into a new matrix <tt>M</tt> for further processing.

</p>
<p></p>
<span class="anchor" id="fragment-ComputenewtransformationmatrixmonoMwithouttranslation-0"></span><div class="fragmentname">&lt;&lt;Compute new transformation matrix <tt>M</tt> without translation&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Matrix4x4 M = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>;
for (int i = 0; i &lt; 3; ++i)
    M.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][3] = M.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[3][i] = 0.f;
M.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[3][3] = 1.f;</div><p>


</p>
<p>Next we&rsquo;d like to extract the pure rotation component of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.221ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 525.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">monospace upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D67C" d="M507 30c0 -30 -25 -30 -40 -30h-82c-15 0 -40 0 -40 30c0 31 21 31 53 31v477h-1c-12 -53 -97 -306 -100 -312c-8 -14 -22 -22 -35 -22c-12 0 -24 7 -30 15c-5 7 -18 45 -26 68c-4 13 -68 205 -79 251h-1v-477c32 0 53 0 53 -31c0 -30 -25 -30 -40 -30h-82 c-15 0 -40 0 -40 30c0 31 21 31 53 31v489c-32 0 -53 0 -53 31c0 30 25 30 40 30h56c14 0 39 0 49 -24c2 -6 90 -265 100 -312h1c6 29 15 58 27 94l67 202c9 26 13 40 54 40h56c15 0 40 0 40 -30c0 -31 -21 -31 -53 -31v-489c32 0 53 0 53 -31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMONOSPACE-1D67C" x="0" y="0"></use>
</g>
</svg>.  We&rsquo;ll
use a technique called <em>polar decomposition</em> to do this.  It can be
shown that the polar decomposition of a matrix  <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg> into rotation
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.006ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 863.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper R</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
</g>
</svg> and scale <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg> can be computed by successively averaging
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg> with its inverse transpose
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:polar-decomposition"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.911ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 11586.5 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M Subscript i plus 1 Baseline equals one-half left-parenthesis bold upper M Subscript i Baseline plus left-parenthesis bold upper M Subscript i Superscript upper T Baseline right-parenthesis Superscript negative 1 Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-28" d="M395 -336c0 -6 -5 -11 -11 -11c-3 0 -5 1 -7 2c-127 96 -246 330 -246 531v128c0 201 119 435 246 531c2 1 4 2 7 2c6 0 11 -5 11 -11c0 -4 -2 -7 -4 -9c-120 -90 -202 -324 -202 -513v-128c0 -189 82 -423 202 -513c2 -2 4 -5 4 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-29" d="M327 186c0 -201 -119 -435 -246 -531c-2 -1 -4 -2 -7 -2c-6 0 -11 5 -11 11c0 4 2 7 4 9c120 90 202 324 202 513v128c0 189 -82 423 -202 513c-2 2 -4 5 -4 9c0 6 5 11 11 11c3 0 5 -1 7 -2c127 -96 246 -330 246 -531v-128Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
<g transform="translate(1092,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2618" y="0"></use>
<g transform="translate(3397,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="60" y="-687"></use>
</g>
</g>
<g transform="translate(4535,0)">
 <use xlink:href="#E1-LATINMODERNSIZE2-28"></use>
<g transform="translate(458,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2117" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3118" y="0"></use>
<g transform="translate(3507,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="1545" y="585"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="1545" y="-350"></use>
</g>
<g transform="translate(5198,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
<g transform="translate(389,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE2-29" x="6592" y="0"></use>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:polar-decomposition">2.10</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

until convergence, at which point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.441ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3634.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M Subscript i Baseline equals bold upper R</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="1545" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1714" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="2770" y="0"></use>
</g>
</svg>.
(It&rsquo;s easy to see that if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg> is a pure
rotation, then averaging it with its inverse transpose will leave it
unchanged, since its inverse is equal to its transpose.
The &ldquo;Further Reading&rdquo; section has more
references that discuss why this series converges to the rotation component
of the original transformation.)  Shoemake and Duff (<a href="Further_Reading.html#cite:Shoemake:1992:MAA">1992</a>) proved that the resulting
matrix is the closest orthogonal matrix to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg>&mdash;a
desirable property.

</p>
<p>To compute this series, we iteratively apply
Equation&nbsp;(<a href="#eq:polar-decomposition">2.10</a>) until either the difference between
successive terms is small or a fixed number of iterations have been
performed.  In practice, this series generally converges quickly.

</p>
<p></p>
<span class="anchor" id="fragment-ExtractrotationmonoRfromtransformationmatrix-0"></span><div class="fragmentname">&lt;&lt;Extract rotation <tt>R</tt> from transformation matrix&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float norm;
int count = 0;
Matrix4x4 R = M;
do {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputenextmatrixmonoRnextinseries-0">Compute next matrix <tt>Rnext</tt> in series</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-127" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-127"><i></i></a><div id="fragbit-127" class="collapse"><div class="fragmentcode">       Matrix4x4 Rnext;
       Matrix4x4 Rit = <a href="../Utilities/Mathematical_Routines.html#Inverse" class="code">Inverse</a>(<a href="../Geometry_and_Transformations/Transformations.html#Transform::Transpose" class="code">Transpose</a>(R));
       for (int i = 0; i &lt; 4; ++i)
           for (int j = 0; j &lt; 4; ++j)
               Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j] = 0.5f * (R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j] + Rit.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j]);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputenormofdifferencebetweenmonoRandmonoRnext-0">Compute norm of difference between <tt>R</tt> and <tt>Rnext</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-128" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-128"><i></i></a><div id="fragbit-128" class="collapse"><div class="fragmentcode">       norm = 0;
       for (int i = 0; i &lt; 3; ++i) {
           Float n = std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][0] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][0]) + 
                     std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][1] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][1]) + 
                     std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][2] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][2]);
           norm = std::max(norm, n);
       }</div></div>
    R = Rnext;
} while (++count &lt; 100 &amp;&amp; norm &gt; .0001);
*Rquat = Quaternion(R);</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-ComputenextmatrixmonoRnextinseries-0"></span><div class="fragmentname">&lt;&lt;Compute next matrix <tt>Rnext</tt> in series&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Matrix4x4 Rnext;
Matrix4x4 Rit = <a href="../Utilities/Mathematical_Routines.html#Inverse" class="code">Inverse</a>(<a href="../Geometry_and_Transformations/Transformations.html#Transform::Transpose" class="code">Transpose</a>(R));
for (int i = 0; i &lt; 4; ++i)
    for (int j = 0; j &lt; 4; ++j)
        Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j] = 0.5f * (R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j] + Rit.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][j]);</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-ComputenormofdifferencebetweenmonoRandmonoRnext-0"></span><div class="fragmentname">&lt;&lt;Compute norm of difference between <tt>R</tt> and <tt>Rnext</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">norm = 0;
for (int i = 0; i &lt; 3; ++i) {
    Float n = std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][0] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][0]) + 
              std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][1] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][1]) + 
              std::abs(R.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][2] - Rnext.<a href="../Utilities/Mathematical_Routines.html#Matrix4x4::m" class="code">m</a>[i][2]);
    norm = std::max(norm, n);
}</div><p>


</p>
<p>Once we&rsquo;ve extracted the rotation from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg>, the scale is all that&rsquo;s
left.  We would like to find the matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg> that satisfies <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.127ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3929.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M equals bold upper R bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1370" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="2426" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="3290" y="0"></use>
</g>
</svg>.  Now that we know both <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.006ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 863.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper R</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.537ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1092.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
</g>
</svg>,
we just solve for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.46ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 4933.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S equals bold upper R Superscript negative 1 Baseline bold upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="917" y="0"></use>
<g transform="translate(1973,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
<g transform="translate(863,413)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="3841" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-ComputescalemonoSusingrotationandoriginalmatrix-0"></span><div class="fragmentname">&lt;&lt;Compute scale <tt>S</tt> using rotation and original matrix&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">*S = <a href="../Utilities/Mathematical_Routines.html#Matrix4x4::Mul" class="code">Matrix4x4</a>::Mul(<a href="../Utilities/Mathematical_Routines.html#Inverse" class="code">Inverse</a>(R), M);</div><p>


</p>
<p>For every rotation matrix, there are two unit quaternions that correspond
to the matrix that only differ in sign.  If the dot product of the two
rotations that we have extracted is negative, then a slerp between them
won&rsquo;t take the shortest path between the two corresponding rotations.
Negating one of them (here the second was chosen arbitrarily) causes the
shorter path to be taken instead.

</p>
<p></p>
<span class="anchor" id="fragment-FlipmonoR1ifneededtoselectshortestpath-0"></span><div class="fragmentname">&lt;&lt;Flip <tt>R[1]</tt> if needed to select shortest path&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(<a href="#AnimatedTransform::R" class="code">R</a>[0], <a href="#AnimatedTransform::R" class="code">R</a>[1]) &lt; 0)
    <a href="#AnimatedTransform::R" class="code">R</a>[1] = -<a href="#AnimatedTransform::R" class="code">R</a>[1];</div><p>


</p>
<p>

</p>
<p>The <tt>Interpolate()</tt> method computes the interpolated transformation
matrix at a given time.  The matrix is found by interpolating the
previously extracted translation, rotation, and scale and then multiplying
them together to get a composite matrix that represents the effect of the
three transformations together.

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformMethodDefinitions-2"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="AnimatedTransform::Interpolate"></span><a href="#AnimatedTransform" class="code">AnimatedTransform</a>::Interpolate(Float time, <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *t) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Handleboundaryconditionsformatrixinterpolation-0">Handle boundary conditions for matrix interpolation</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-129" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-129"><i></i></a><div id="fragbit-129" class="collapse"><div class="fragmentcode">       if (!<a href="#AnimatedTransform::actuallyAnimated" class="code">actuallyAnimated</a> || time &lt;= <a href="#AnimatedTransform::startTime" class="code">startTime</a>) { 
           *t = *<a href="#AnimatedTransform::startTransform" class="code">startTransform</a>;
           return; 
       }
       if (time &gt;= <a href="#AnimatedTransform::endTime" class="code">endTime</a>) { 
           *t = *<a href="#AnimatedTransform::endTransform" class="code">endTransform</a>;
           return; 
       }</div></div>
    Float dt = (time - <a href="#AnimatedTransform::startTime" class="code">startTime</a>) / (<a href="#AnimatedTransform::endTime" class="code">endTime</a> - <a href="#AnimatedTransform::startTime" class="code">startTime</a>);
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Interpolatetranslationatmonodt-0">Interpolate translation at <tt>dt</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-130" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-130"><i></i></a><div id="fragbit-130" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> trans = (1 - dt) * <a href="#AnimatedTransform::T" class="code">T</a>[0] + dt * <a href="#AnimatedTransform::T" class="code">T</a>[1];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Interpolaterotationatmonodt-0">Interpolate rotation at <tt>dt</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-131" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-131"><i></i></a><div id="fragbit-131" class="collapse"><div class="fragmentcode">       Quaternion rotate = <a href="#Slerp" class="code">Slerp</a>(dt, <a href="#AnimatedTransform::R" class="code">R</a>[0], <a href="#AnimatedTransform::R" class="code">R</a>[1]);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Interpolatescaleatmonodt-0">Interpolate scale at <tt>dt</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-132" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-132"><i></i></a><div id="fragbit-132" class="collapse"><div class="fragmentcode">       Matrix4x4 scale;
       for (int i = 0; i &lt; 3; ++i)
           for (int j = 0; j &lt; 3; ++j)
               scale.m[i][j] = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(dt, <a href="#AnimatedTransform::S" class="code">S</a>[0].m[i][j], <a href="#AnimatedTransform::S" class="code">S</a>[1].m[i][j]);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeinterpolatedmatrixasproductofinterpolatedcomponents-0">Compute interpolated matrix as product of interpolated components</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-133" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-133"><i></i></a><div id="fragbit-133" class="collapse"><div class="fragmentcode">       *t = <a href="../Geometry_and_Transformations/Transformations.html#Translate" class="code">Translate</a>(trans) * rotate.<a href="#Quaternion::ToTransform" class="code">ToTransform</a>() * <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>(scale);</div></div>
}</div><p>


</p>
<p>If the given time value is outside the time range of the two
transformations stored in the <tt>AnimatedTransform</tt>, then the
transformation at the start time or end time is returned, as appropriate.
The <a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a> constructor also checks whether the two
<a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a>s stored are the same; if so, then no interpolation is
necessary either.  All of the classes in <tt>pbrt</tt> that support animation
always store an <a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a> for their transformation, rather
than storing either a <a href="../Geometry_and_Transformations/Transformations.html#Transform"><tt>Transform</tt></a> or <a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a> as
appropriate.  This simplifies their implementations, though it does make it
worthwhile to check for this case here and not unnecessarily do the work to
interpolate between two equal transformations.
 
</p>
<span class="anchor" id="fragment-Handleboundaryconditionsformatrixinterpolation-0"></span><div class="fragmentname">&lt;&lt;Handle boundary conditions for matrix interpolation&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (!<a href="#AnimatedTransform::actuallyAnimated" class="code">actuallyAnimated</a> || time &lt;= <a href="#AnimatedTransform::startTime" class="code">startTime</a>) { 
    *t = *<a href="#AnimatedTransform::startTransform" class="code">startTransform</a>;
    return; 
}
if (time &gt;= <a href="#AnimatedTransform::endTime" class="code">endTime</a>) { 
    *t = *<a href="#AnimatedTransform::endTransform" class="code">endTransform</a>;
    return; 
}</div><p>


</p>
<p>The <tt>dt</tt> variable stores the offset in the range from <tt>startTime</tt>
to <tt>endTime</tt>; it is zero at <tt>startTime</tt> and one at
<tt>endTime</tt>.  Given <tt>dt</tt>, interpolation of the translation is
trivial.

</p>
<p></p>
<span class="anchor" id="fragment-Interpolatetranslationatmonodt-0"></span><div class="fragmentname">&lt;&lt;Interpolate translation at <tt>dt</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> trans = (1 - dt) * <a href="#AnimatedTransform::T" class="code">T</a>[0] + dt * <a href="#AnimatedTransform::T" class="code">T</a>[1];</div><p>


</p>
<p>The rotation is interpolated between the start and end rotations using the
<a href="#Slerp"><tt>Slerp()</tt></a> routine (Section&nbsp;<a href="#sec:quaternion-interpolation">2.9.2</a>).

</p>
<p></p>
<span class="anchor" id="fragment-Interpolaterotationatmonodt-0"></span><div class="fragmentname">&lt;&lt;Interpolate rotation at <tt>dt</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Quaternion rotate = <a href="#Slerp" class="code">Slerp</a>(dt, <a href="#AnimatedTransform::R" class="code">R</a>[0], <a href="#AnimatedTransform::R" class="code">R</a>[1]);</div><p>


</p>
<p>Finally, the interpolated scale matrix is computed by interpolating
the individual elements of the start and end scale matrices.  Because the
<a href="../Utilities/Mathematical_Routines.html#Matrix4x4"><tt>Matrix4x4</tt></a> constructor sets the matrix to the identity matrix, we
don&rsquo;t need to initialize any of the other elements of <tt>scale</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-Interpolatescaleatmonodt-0"></span><div class="fragmentname">&lt;&lt;Interpolate scale at <tt>dt</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Matrix4x4 scale;
for (int i = 0; i &lt; 3; ++i)
    for (int j = 0; j &lt; 3; ++j)
        scale.m[i][j] = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(dt, <a href="#AnimatedTransform::S" class="code">S</a>[0].m[i][j], <a href="#AnimatedTransform::S" class="code">S</a>[1].m[i][j]);</div><p>


</p>
<p>Given the three interpolated parts, the product of their three
transformation matrices gives us the final result.

</p>
<p></p>
<span class="anchor" id="fragment-Computeinterpolatedmatrixasproductofinterpolatedcomponents-0"></span><div class="fragmentname">&lt;&lt;Compute interpolated matrix as product of interpolated components&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">*t = <a href="../Geometry_and_Transformations/Transformations.html#Translate" class="code">Translate</a>(trans) * rotate.<a href="#Quaternion::ToTransform" class="code">ToTransform</a>() * <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a>(scale);</div><p>


</p>
<p><a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a> also provides a number of methods that apply
interpolated transformations directly, using the provided time for
<a href="../Geometry_and_Transformations/Points.html#Point3f"><tt>Point3f</tt></a>s and <a href="../Geometry_and_Transformations/Vectors.html#Vector3f"><tt>Vector3f</tt></a>s and <a href="../Geometry_and_Transformations/Rays.html#Ray::time"><tt>Ray::time</tt></a> for <tt>Ray</tt>s.  These methods
are more efficient than calling <a href="#AnimatedTransform::Interpolate"><tt>AnimatedTransform::Interpolate()</tt></a> and
then using the returned matrix when there is no actual animation since a
copy of the transformation matrix doesn&rsquo;t need to be made in that case.

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformPublicMethods-0"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> operator()(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;r) const;
RayDifferential operator()(const RayDifferential &amp;r) const;
<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> operator()(Float time, const <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> &amp;p) const;
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> operator()(Float time, const <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> &amp;v) const;</div><p>


</p>
<p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#BoundingMovingBoundingBoxes"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:bounding-moving-bboxes"></span><span id="BoundingMovingBoundingBoxes"></span><h3>2.9.4  Bounding Moving Bounding Boxes</h3><p>



</p>
<p>

</p>
<p>Given a <tt>Bounds3f</tt> that is transformed by an animated transformation,
it&rsquo;s useful to be able to compute a bounding box that encompasses all of
its motion over the animation time period.  For example, if we can bound
the motion of an animated geometric primitive, then we can intersect rays
with this bound to determine if the ray might intersect the object before
incurring the cost of interpolating the primitive&rsquo;s bound to the ray&rsquo;s time
to check that intersection.  The <a href="#AnimatedTransform::MotionBounds"><tt>AnimatedTransform::MotionBounds()</tt></a>
method performs this computation, taking a bounding box and returning the
bounding box of its motion over the <a href="#AnimatedTransform"><tt>AnimatedTransform</tt></a>&rsquo;s time range.

</p>
<p>There are two easy cases: first, if the keyframe matrices are equal, then
we can arbitrarily apply only the starting transformation to compute the
full bounds.  Second, if the transformation only includes scaling and/or
translation, then the bounding box that encompasses the bounding box&rsquo;s
transformed positions at both the start time and the end time bounds all of
its motion.  To see why this is so, consider the position of a transformed
point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> as a function of time; we&rsquo;ll denote this function of two
matrices, a point, and a time by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.703ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6760.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a left-parenthesis bold upper M bold 0 comma bold upper M bold 1 comma normal p Subscript Baseline comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="529" y="0"></use>
<g transform="translate(919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2518" y="0"></use>
<g transform="translate(2963,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="5008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6371" y="0"></use>
</g>
</svg>.

</p>
<p>Since in this case the rotation
component of the decomposition is the identity, then with our matrix
decomposition we have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.383ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 12650.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a left-parenthesis bold upper M bold 0 comma bold upper M bold 1 comma normal p Subscript Baseline comma t right-parenthesis equals bold upper T left-parenthesis t right-parenthesis bold upper S left-parenthesis t right-parenthesis normal p Subscript Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="529" y="0"></use>
<g transform="translate(919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2518" y="0"></use>
<g transform="translate(2963,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="5008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6371" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="7038" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="8094" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="9284" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9646" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="10035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10675" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="11064" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11426" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="11815" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="12372" y="0"></use>
</g>
</svg>
</div>
<p>

where the translation and scale are both written as functions of time.  
Assuming for simplicity that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.134ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1780 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S left-parenthesis t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="639" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1029" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1390" y="0"></use>
</g>
</svg> is a regular scale, we can
find expressions for the components of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.703ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6760.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a left-parenthesis bold upper M bold 0 comma bold upper M bold 1 comma normal p Subscript Baseline comma t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="529" y="0"></use>
<g transform="translate(919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2518" y="0"></use>
<g transform="translate(2963,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="5008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6371" y="0"></use>
</g>
</svg>.  For
example, for the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> component, we have:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="69.104ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 29752.9 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column a left-parenthesis bold upper M bold 0 comma bold upper M bold 1 comma normal p Subscript Baseline comma t right-parenthesis Subscript x 2nd Column equals left-bracket left-parenthesis 1 minus t right-parenthesis s Subscript 0 comma 0 Baseline plus t s prime Subscript 0 comma 0 right-bracket normal p Subscript Baseline Subscript x Baseline plus left-parenthesis 1 minus t right-parenthesis d Subscript 0 comma 3 Baseline plus t d Subscript 0 comma 3 Superscript prime Baseline 2nd Row 1st Column Blank 2nd Column equals left-bracket s Subscript 0 comma 0 Baseline normal p Subscript Baseline Subscript x Baseline plus d Subscript 0 comma 3 Baseline right-bracket plus left-bracket minus s Subscript 0 comma 0 Baseline normal p Subscript Baseline Subscript x Baseline plus s prime Subscript 0 comma 0 Baseline normal p Subscript Baseline Subscript x Baseline minus d Subscript 0 comma 3 Baseline plus d prime Subscript 0 comma 3 right-bracket t comma EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,944)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="529" y="0"></use>
<g transform="translate(919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2518" y="0"></use>
<g transform="translate(2963,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="5008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6371" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="9561" y="-403"></use>
</g>
</g>
<g transform="translate(7533,0)">
<g transform="translate(0,944)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1724" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2447" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="3447" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3809" y="0"></use>
<g transform="translate(4198,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6895" y="0"></use>
<g transform="translate(7257,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="392"></use>
<g transform="translate(469,-308)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="8731" y="0"></use>
<g transform="translate(9010,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10293" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="11294" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="11683" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="12406" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="13407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="13768" y="0"></use>
<g transform="translate(14158,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
<g transform="translate(520,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="15905" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="16906" y="0"></use>
<g transform="translate(17268,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="736" y="392"></use>
<g transform="translate(520,-308)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
</g>
</g>
<g transform="translate(0,-800)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="1056" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
<g transform="translate(2809,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4092" y="0"></use>
<g transform="translate(5093,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
<g transform="translate(520,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="6618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7119" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="8119" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="8398" y="0"></use>
<g transform="translate(9176,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
<g transform="translate(10651,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="11934" y="0"></use>
<g transform="translate(12935,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="392"></use>
<g transform="translate(469,-308)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
<g transform="translate(14409,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="15693" y="0"></use>
<g transform="translate(16693,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
<g transform="translate(520,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="18441" y="0"></use>
<g transform="translate(19442,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="736" y="392"></use>
<g transform="translate(520,-308)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="20967" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="21245" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="21607" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.424ex" height="2.343ex" style="vertical-align: -1.005ex;" viewBox="0 -576.1 1474.2 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">s Subscript 0 comma 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg> is the corresponding element of the scale matrix for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.715ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1599.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M bold 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
</svg>,
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.424ex" height="3.176ex" style="vertical-align: -1.338ex;" viewBox="0 -791.3 1474.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">s prime Subscript 0 comma 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="392"></use>
<g transform="translate(469,-308)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg> is the same scale matrix element for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.715ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1599.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M bold 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
</svg>,
and the translation matrix elements are similarly denoted by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg>.  (We chose
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg> for &ldquo;delta&rdquo; here since <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> is already claimed for time.)
As a linear function of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg>, the extrema of this function are at the start
and end times.  The other coordinates and the case for a generalized scale
follow similarly.

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformMethodDefinitions-3"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> <span class="anchor" id="AnimatedTransform::MotionBounds"></span><a href="#AnimatedTransform" class="code">AnimatedTransform</a>::MotionBounds(const <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> &amp;b) const {
    if (!<a href="#AnimatedTransform::actuallyAnimated" class="code">actuallyAnimated</a>)
        return (*startTransform)(b);
    if (<a href="#AnimatedTransform::hasRotation" class="code">hasRotation</a> == false)
        return Union((*startTransform)(b), (*endTransform)(b));
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnmotionboundsaccountingforanimatedrotation-0">Return motion bounds accounting for animated rotation</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-134" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-134"><i></i></a><div id="fragbit-134" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> bounds;
       for (int corner = 0; corner &lt; 8; ++corner)
           bounds = <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Union" class="code">Union</a>(bounds, <a href="#AnimatedTransform::BoundPointMotion" class="code">BoundPointMotion</a>(b.<a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Corner" class="code">Corner</a>(corner)));
       return bounds;</div></div>
}</div><p>


</p>
<p>

</p>
<p>For the general case with animated rotations, the motion function may have
extrema at points in the middle of the time range.  We know of no simple
way to find these points.  Many renderers address this issue by sampling a
large number of times in the time range, computing the interpolated
transformation at each one, and taking the union of all of the
corresponding transformed bounding boxes.  Here, we will develop a more
well-grounded method that lets us robustly compute these motion bounds.

</p>
<p>
We use a slightly simpler conservative bound that entails computing the
motion of the eight corners of the bounding box individually
and finding the union of those bounds.

</p>
<p></p>
<span class="anchor" id="fragment-Returnmotionboundsaccountingforanimatedrotation-0"></span><div class="fragmentname">&lt;&lt;Return motion bounds accounting for animated rotation&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> bounds;
for (int corner = 0; corner &lt; 8; ++corner)
    bounds = <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Union" class="code">Union</a>(bounds, <a href="#AnimatedTransform::BoundPointMotion" class="code">BoundPointMotion</a>(b.<a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Corner" class="code">Corner</a>(corner)));
return bounds;</div><p>


</p>
<p>For each bounding box corner <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg>, we need to find the extrema of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg>
over the animation time range.  Recall from calculus that the extrema of a
continuous function over some domain are either at the boundary points of
the domain or at points where the function&rsquo;s first derivative is zero.
Thus, the overall bound is given by the union of the positions at the start
and end of motion as well as the position at any extrema.

</p>
<p>Figure&nbsp;<a href="#fig:motion-function-derivative">2.18</a> shows a plot of one coordinate
of the motion function and its derivative for an interesting
motion path of a point.  Note that the maximum value of the function over the time
range is reached at a point where the derivative has a zero.

</p>
<p> </p>
<span class="anchor" id="fig:motion-function-derivative"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="point-motion.svg" title=""><img src="point-motion.svg" width=360 height=240 style="max-width: 100%;"></a>
  <a href="point-motion-deriv.svg" title=""><img src="point-motion-deriv.svg" width=360 height=230 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 2.18: <span class="legend"> (a)&nbsp;Motion of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> coordinate of a point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> as a
function of time, as determined by two keyframe matrices.
(b)&nbsp;The derivative of the motion function,
Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>).  Note that extrema of the motion
function in the given time range correspond to zeros of the
derivative.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>


</p>
<p>To bound the motion of a single point, we start our derivation by following
the approach used for the no-rotation case, expanding out the three
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.006ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 863.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper R</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg> components of
Equation&nbsp;(<a href="#eq:animated-transformation">2.9</a>) as functions of time and
finding their product.  We have:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:point-animate-function"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.037ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14654.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a left-parenthesis bold upper M bold 0 comma bold upper M bold 1 comma normal p Subscript Baseline comma t right-parenthesis equals bold upper T left-parenthesis t right-parenthesis bold upper R left-parenthesis t right-parenthesis bold upper S left-parenthesis t right-parenthesis normal p Subscript Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="529" y="0"></use>
<g transform="translate(919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2518" y="0"></use>
<g transform="translate(2963,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="5008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6371" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="7038" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="8094" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="9284" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9646" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="10035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10899" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="11288" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11650" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="12039" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="12679" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="13068" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="13430" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="13819" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="14376" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:point-animate-function">2.11</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

The result is quite complex when expanded out, mostly due to the slerp and
the conversion of the resulting quaternion to a matrix; a computer algebra
system is a requirement for working with this function.

</p>
<p>The derivative <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.429ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8795.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential a left-parenthesis bold upper M bold 0 comma bold upper M bold 1 comma normal p Subscript Baseline comma t right-parenthesis slash partial-differential t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CE" d="M529 319c0 -100 -2 -330 -242 -330c-241 0 -242 231 -242 330c0 98 1 336 242 336s242 -239 242 -336zM401 331c0 82 0 188 -17 225c-19 44 -60 63 -97 63c-24 0 -94 -10 -106 -99c-8 -52 -8 -117 -8 -189c0 -55 0 -159 9 -211c13 -73 69 -95 105 -95c30 0 93 14 107 107 c7 52 7 143 7 199Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D7CF" d="M494 0c-44 3 -150 3 -199 3s-155 0 -199 -3v47h139v517c-59 -19 -114 -20 -130 -20h-20v47h20c21 0 124 0 201 57c9 7 11 7 22 7c26 0 26 -10 26 -32v-576h140v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1116" y="0"></use>
<g transform="translate(1505,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CE" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3104" y="0"></use>
<g transform="translate(3550,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D7CF" x="1545" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="5594" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="6151" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="6596" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6957" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="7347" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="7847" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="8434" y="0"></use>
</g>
</svg>
is also quite complex&mdash;in its full algebraic glory, over 2,000 operations
are required to evaluate its value for a given pair of decomposed matrices,
point and time.  However, given specific transformation matrices and a
specific point, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> is simplified substantially; we&rsquo;ll denote the
specialized function of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> alone as <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.277ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 3132.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a Subscript bold upper M comma normal p Sub Subscript Subscript Baseline left-parenthesis t right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="1092" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-70" x="1371" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1992" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2381" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2743" y="0"></use>
</g>
</svg>.  Evaluating
its derivative requires roughly 10 floating-point operations, a sine, and a
cosine to evaluate for each coordinate:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:motion-derivative"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.208ex" height="5.843ex" style="vertical-align: -2.005ex;" viewBox="0 -1652.5 25061.8 2515.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartFraction normal d a Subscript bold upper M comma normal p Sub Subscript Subscript Baseline left-parenthesis t right-parenthesis Over normal d t EndFraction equals c 1 plus left-parenthesis c 2 plus c 3 t right-parenthesis cosine left-parenthesis 2 theta t right-parenthesis plus left-parenthesis c 4 plus c 5 t right-parenthesis sine left-parenthesis 2 theta t right-parenthesis comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="3809" height="60" x="0" y="220"></rect>
<g transform="translate(60,807)">
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="0" y="0"></use>
<g transform="translate(556,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="1092" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-70" x="1371" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2548" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2938" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3299" y="0"></use>
</g>
<g transform="translate(1445,-715)">
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="556" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="4327" y="0"></use>
<g transform="translate(5383,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6493" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="7493" y="0"></use>
<g transform="translate(7883,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8992" y="0"></use>
<g transform="translate(9993,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="11047" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11409" y="0"></use>
<g transform="translate(11965,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="13304" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="13694" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="14194" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="14831" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15192" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="15804" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="16805" y="0"></use>
<g transform="translate(17194,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="18304" y="0"></use>
<g transform="translate(19304,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-35" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="20358" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="20720" y="0"></use>
<g transform="translate(21276,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="22506" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="22895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="23396" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="24032" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="24393" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="24783" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:motion-derivative">2.12</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> is the arc cosine of the dot product of the two quaternions
and where the five coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg> are 3-vectors that depend on the two matrices and the
position <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg>. This specialization works out well, since we will need to
evaluate the function at many time values for a given point.

</p>
<p>We now have two tasks: first, given a pair of keyframe matrices and a point
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg>, we first need to be able to efficiently compute the values of the
coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg>.  Then, given the relatively simple function defined by
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg>, we need to find the zeros of
Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>), which may represent the times at
which motion extrema occur.

</p>
<p>

</p>
<p>For the first task, we will first factor out the contributions to the
coefficients that depend on the keyframe matrices from those that depend on
the point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg>, under the assumption that bounding boxes for multiple
points&rsquo; motion will be computed for each pair of keyframe matrices (as is
the case here).  The result is fortunately quite simple&mdash;the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg> vectors
are linear functions of the point&rsquo;s <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> components.
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.38ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 16093.9 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i Baseline left-parenthesis normal p Subscript Baseline right-parenthesis equals k Subscript i comma normal c Baseline plus k Subscript i comma x Baseline normal p Subscript Baseline Subscript x Baseline plus k Subscript i comma y Baseline normal p Subscript Baseline Subscript y Baseline plus k Subscript i comma z Baseline normal p Subscript Baseline Subscript z Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="777" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1167" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2391" y="0"></use>
<g transform="translate(3447,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
<g transform="translate(521,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-63" x="624" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5046" y="0"></use>
<g transform="translate(6047,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
<g transform="translate(521,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="624" y="0"></use>
</g>
</g>
<g transform="translate(7514,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8798" y="0"></use>
<g transform="translate(9799,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
<g transform="translate(521,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="624" y="0"></use>
</g>
</g>
<g transform="translate(11208,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="12434" y="0"></use>
<g transform="translate(13435,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
<g transform="translate(521,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="624" y="0"></use>
</g>
</g>
<g transform="translate(14828,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="15815" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>Thus, given the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 865.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">k Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="737" y="-213"></use>
</g>
</svg> coefficients and a particular point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> we want
to bound the motion of, we can efficiently compute the coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg>
of the derivative function in Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>).  The
<tt>DerivativeTerm</tt> structure encapsulates these coefficients and this computation.

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformPrivateData-1"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Private Data&gt;&gt;+=&nbsp;<a href="#fragment-AnimatedTransformPrivateData-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-AnimatedTransformPrivateData-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">struct <span class="anchor" id="DerivativeTerm"></span>DerivativeTerm {
    DerivativeTerm(Float c, Float x, Float y, Float z)
        : kc(c), kx(x), ky(y), kz(z) { }
    Float kc, kx, ky, kz;
    Float Eval(const <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> &amp;p) const {
        return kc + kx * p.x + ky * p.y + kz * p.z;
    }
  };</div><p>


</p>
<p>The attributes <tt>c1</tt>-<tt>c5</tt> store derivative information corresponding to the
five terms in Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>).
The three array elements correspond to
the three dimensions of space.

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformPrivateData-2"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Private Data&gt;&gt;+=&nbsp;<a href="#fragment-AnimatedTransformPrivateData-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">DerivativeTerm c1[3], c2[3], c3[3], c4[3], c5[3];</div><p>


</p>
<p>The fragment &lt;&lt;<span class="fragmentname">Compute terms of motion derivative function</span>&gt;&gt; in the
<tt>AnimatedTransform</tt> constructor, not included here, initializes these
terms, via automatically generated code.  Given that it requires a few
thousand floating-point operations, doing this work once and amortizing
over the multiple bounding box corners is helpful. The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 865.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">k Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="737" y="-213"></use>
</g>
</svg> coefficients
are more easily computed if we assume a canonical time range <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg>;
later, we&rsquo;ll have to remap the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values of zeros of the motion function
to the actual shutter time range.

</p>
<p>Given the coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 865.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">k Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="737" y="-213"></use>
</g>
</svg> based on the keyframe matrices,
<tt>BoundPointMotion()</tt> computes a robust bound of the motion of <tt>p</tt>.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-AnimatedTransformMethodDefinitions-4"></span><div class="fragmentname">&lt;&lt;AnimatedTransform Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-AnimatedTransformMethodDefinitions-3"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> <span class="anchor" id="AnimatedTransform::BoundPointMotion"></span><a href="#AnimatedTransform" class="code">AnimatedTransform</a>::BoundPointMotion(const <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> &amp;p) const {
    <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> bounds((*startTransform)(p), (*endTransform)(p));
    Float cosTheta = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(R[0], R[1]);
    Float theta = std::acos(<a href="../Utilities/Main_Include_File.html#Clamp" class="code">Clamp</a>(cosTheta, -1, 1));
    for (int c = 0; c &lt; 3; ++c) {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-Findanymotionderivativezerosforthecomponentmonoc-0">Find any motion derivative zeros for the component <tt>c</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-135" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-135"><i></i></a><div id="fragbit-135" class="collapse"><div class="fragmentcode">           Float zeros[4];
           int nZeros = 0;
           <a href="#IntervalFindZeros" class="code">IntervalFindZeros</a>(c1[c].Eval(p), c2[c].Eval(p), c3[c].Eval(p),
                             c4[c].Eval(p), c5[c].Eval(p), theta,
                             Interval(0., 1.), zeros, &amp;nZeros);
           </div></div>
        &lt;&lt;<span class="fragmentname"><a href="#fragment-Expandboundingboxforanymotionderivativezerosfound-0">Expand bounding box for any motion derivative zeros found</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-136" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-136"><i></i></a><div id="fragbit-136" class="collapse"><div class="fragmentcode">           for (int i = 0; i &lt; nZeros; ++i) {
               <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pz = (*this)(<a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(zeros[i], startTime, endTime), p);
               bounds = <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Union" class="code">Union</a>(bounds, pz);
           }</div></div>
    }
    return bounds;
}</div><p>


</p>
<p>The <tt>IntervalFindZeros()</tt> function, to be introduced shortly,
numerically finds zeros of Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>).  Up to four
are possible.

</p>
<p></p>
<span class="anchor" id="fragment-Findanymotionderivativezerosforthecomponentmonoc-0"></span><div class="fragmentname">&lt;&lt;Find any motion derivative zeros for the component <tt>c</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float zeros[4];
int nZeros = 0;
<a href="#IntervalFindZeros" class="code">IntervalFindZeros</a>(c1[c].Eval(p), c2[c].Eval(p), c3[c].Eval(p),
                  c4[c].Eval(p), c5[c].Eval(p), theta,
                  Interval(0., 1.), zeros, &amp;nZeros);
</div><p>


</p>
<p>The zeros are found over <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.333ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3587.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t element-of left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2208" d="M587 -23c0 -11 -9 -20 -20 -20h-193c-162 0 -293 131 -293 293s131 293 293 293h193c11 0 20 -9 20 -20s-9 -20 -20 -20h-193c-133 0 -242 -103 -252 -233h445c27 0 27 -40 0 -40h-445c10 -130 119 -233 252 -233h193c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2208" x="639" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="1584" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1863" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="3309" y="0"></use>
</g>
</svg>, so we need to interpolate
within the time range before calling the method to transform the point at
the corresponding time.  Note also that the extremum is only at one of the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, and&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> dimensions, and so the bounds only need to be updated in
that one dimension.  For convenience, here we just use the <tt>Union()</tt>
function, which considers all dimensions, even though two could be
ignored.

</p>
<p></p>
<span class="anchor" id="fragment-Expandboundingboxforanymotionderivativezerosfound-0"></span><div class="fragmentname">&lt;&lt;Expand bounding box for any motion derivative zeros found&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">for (int i = 0; i &lt; nZeros; ++i) {
    <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pz = (*this)(<a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(zeros[i], startTime, endTime), p);
    bounds = <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Union" class="code">Union</a>(bounds, pz);
}</div><p>


</p>
<p>Finding zeros of the motion derivative function,
Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>), can&rsquo;t be done algebraically;
numerical methods are necessary.  Fortunately, the function is
well behaved&mdash;it&rsquo;s fairly smooth and has a limited number of zeros.
(Recall the plot in Figure&nbsp;<a href="#fig:motion-function-derivative">2.18</a>, which was
an unusually complex representative.)

</p>
<p>While we could use a bisection-based search or Newton&rsquo;s method, we&rsquo;d risk
missing zeros when the function only briefly crosses the axis.  Therefore,
we&rsquo;ll use <em>interval arithmetic</em>, an extension of arithmetic that gives
insight about the behavior of functions over ranges of values, which
makes it possible to robustly find zeros of functions.

</p>
<p>To understand the basic idea of interval arithmetic, consider, for example,
the function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.013ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4311.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis equals 2 x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2181" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="3238" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="3738" y="0"></use>
</g>
</svg>.  If we have an interval of values <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.659ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4158.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket a comma b right-bracket subset-of bold upper R Superscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2282" d="M693 -23c0 -11 -9 -20 -20 -20h-295c-162 0 -293 131 -293 293s131 293 293 293h295c11 0 20 -9 20 -20s-9 -20 -20 -20h-295c-140 0 -253 -113 -253 -253s113 -253 253 -253h295c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D411" d="M858 95c0 -16 -13 -106 -120 -106c-41 0 -103 4 -147 26c-70 34 -70 83 -70 149c0 73 0 92 -32 127c-31 34 -75 34 -89 34h-117v-278h108v-47c-36 3 -134 3 -176 3s-140 0 -176 -3v47h108v592h-108v47h380c188 0 298 -84 298 -185c0 -66 -51 -131 -167 -161 c43 -16 98 -47 112 -117c1 -5 9 -74 11 -85c5 -42 14 -113 74 -113c30 0 59 22 64 69c1 13 2 23 23 23c10 0 24 0 24 -22zM564 500c0 61 -2 139 -163 139h-118v-278h116c165 0 165 83 165 139Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1253" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1682" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2282" x="2238" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D411" x="3295" y="0"></use>
</g>
</svg>, then we can see that over the interval, the range of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.283ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 552.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
</g>
</svg> is the
interval <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.88ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2962.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 2 a comma 2 b right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1308" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1753" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2254" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="2683" y="0"></use>
</g>
</svg>.  In other words <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.626ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7588.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis left-bracket a comma b right-bracket right-parenthesis subset-of left-bracket 2 a comma 2 b right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2282" d="M693 -23c0 -11 -9 -20 -20 -20h-295c-162 0 -293 131 -293 293s131 293 293 293h295c11 0 20 -9 20 -20s-9 -20 -20 -20h-295c-140 0 -253 -113 -253 -253s113 -253 253 -253h295c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1220" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1750" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2195" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="2624" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2903" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2282" x="3570" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="4626" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="4905" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="5405" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5935" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="6380" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="6880" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="7310" y="0"></use>
</g>
</svg>.

</p>
<p>More generally, all of the basic operations of arithmetic have
<em>interval extensions</em> that describe how they operate on intervals.
For example, given two intervals <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.555ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1961.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket a comma b right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1253" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1682" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.543ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1956.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket c comma d right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="712" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="1157" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1677" y="0"></use>
</g>
</svg>,
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.136ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 12113.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket a comma b right-bracket plus left-bracket c comma d right-bracket subset-of left-bracket a plus c comma b plus d right-bracket period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2282" d="M693 -23c0 -11 -9 -20 -20 -20h-295c-162 0 -293 131 -293 293s131 293 293 293h295c11 0 20 -9 20 -20s-9 -20 -20 -20h-295c-140 0 -253 -113 -253 -253s113 -253 253 -253h295c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1253" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1682" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2183" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="3184" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="3462" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3896" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="4341" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="4861" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2282" x="5418" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="6474" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="6752" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7504" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="8505" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="8938" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="9383" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="11036" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="11556" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="11835" y="0"></use>
</g>
</svg>
</div>
<p>

In other words, if we add together two values where one is in the range
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.555ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1961.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket a comma b right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1253" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1682" y="0"></use>
</g>
</svg> and the second is in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.543ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1956.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket c comma d right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="712" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="1157" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1677" y="0"></use>
</g>
</svg>, then the result must be in the range
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.452ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5361.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket a plus c comma b plus d right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1030" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="2030" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2464" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2909" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3561" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="4562" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="5082" y="0"></use>
</g>
</svg>.

</p>
<p>Interval arithmetic has the important property that the intervals that it
gives are conservative.  In particular, if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.289ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6582.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis left-bracket a comma b right-bracket right-parenthesis subset-of left-bracket c comma d right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2282" d="M693 -23c0 -11 -9 -20 -20 -20h-295c-162 0 -293 131 -293 293s131 293 293 293h295c11 0 20 -9 20 -20s-9 -20 -20 -20h-295c-140 0 -253 -113 -253 -253s113 -253 253 -253h295c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1220" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1750" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2195" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="2624" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2903" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2282" x="3570" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="4626" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="4905" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5338" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="5783" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="6304" y="0"></use>
</g>
</svg> and if
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.268ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2268.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c greater-than 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3E" d="M688 230l-581 -275c-25 -11 -42 25 -18 36l548 259l-548 259c-24 11 -7 47 18 36l581 -275c17 -8 17 -32 0 -40Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3E" x="711" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1767" y="0"></use>
</g>
</svg>, then we know for sure that no value in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.555ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1961.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket a comma b right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="808" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1253" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1682" y="0"></use>
</g>
</svg> causes <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.283ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 552.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
</g>
</svg> to be
negative.  In the following, we will show how to compute
Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>) over intervals and will take advantage
of the conservative bounds of computed intervals to efficiently find small
intervals with zero crossings where regular root finding methods can be
reliably used.

</p>
<p>First we will define an <tt>Interval</tt> class that represents intervals of
real numbers.

</p>
<p></p>
<span class="anchor" id="fragment-IntervalDefinitions-0"></span><div class="fragmentname">&lt;&lt;Interval Definitions&gt;&gt;=&nbsp;<a href="#fragment-IntervalDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">class <span class="anchor" id="Interval"></span>Interval {
public:
  &lt;&lt;<span class="fragmentname"><a href="#fragment-IntervalPublicMethods-0">Interval Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-137" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-137"><i></i></a><div id="fragbit-137" class="collapse"><div class="fragmentcode">     Interval(Float v) : <a href="#Interval::low" class="code">low</a>(v), <a href="#Interval::high" class="code">high</a>(v) { }
     Interval(Float v0, Float v1)
         : <a href="#Interval::low" class="code">low</a>(std::min(v0, v1)), <a href="#Interval::high" class="code">high</a>(std::max(v0, v1)) { }
     Interval operator+(const Interval &amp;i) const {
         return Interval(<a href="#Interval::low" class="code">low</a> + i.<a href="#Interval::low" class="code">low</a>, <a href="#Interval::high" class="code">high</a> + i.<a href="#Interval::high" class="code">high</a>);
     }
     Interval operator-(const Interval &amp;i) const {
         return Interval(<a href="#Interval::low" class="code">low</a> - i.<a href="#Interval::high" class="code">high</a>, <a href="#Interval::high" class="code">high</a> - i.<a href="#Interval::low" class="code">low</a>);
     }
     Interval operator*(const Interval &amp;i) const {
         return Interval(std::min(std::min(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::low" class="code">low</a>,  <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::low" class="code">low</a>),
                                  std::min(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::high" class="code">high</a>, <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::high" class="code">high</a>)),
                         std::max(std::max(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::low" class="code">low</a>,  <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::low" class="code">low</a>),
                                  std::max(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::high" class="code">high</a>, <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::high" class="code">high</a>)));
     }</div></div>
  Float <span class="anchor" id="Interval::low"></span>low, <span class="anchor" id="Interval::high"></span>high;
};</div><p>


</p>
<p>An interval can be initialized with a single value, representing a single
point on the real number line, or with two values that specify an interval
with non-zero width.

</p>
<p></p>
<span class="anchor" id="fragment-IntervalPublicMethods-0"></span><div class="fragmentname">&lt;&lt;Interval Public Methods&gt;&gt;=&nbsp;<a href="#fragment-IntervalPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Interval(Float v) : <a href="#Interval::low" class="code">low</a>(v), <a href="#Interval::high" class="code">high</a>(v) { }
Interval(Float v0, Float v1)
    : <a href="#Interval::low" class="code">low</a>(std::min(v0, v1)), <a href="#Interval::high" class="code">high</a>(std::max(v0, v1)) { }</div><p>


</p>
<p>The class also provides overloads for the basic arithmetic operations.
Note that for subtraction, the high value of the second interval is
subtracted from the low value of the first.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="Readers who have
already read Section&nbsp;3.9 or who are already familiar with
floating-point round-off error may note a crack in our claims of robustness:
when the floating-point value of one of the interval bounds is computed,
the result is rounded to the nearest floating-point value, which may be
larger or smaller than the fully precise result.  To be fully robust, the
floating-point rounding mode must be set to round down for the lower value
of the extent and to round up for the upper.  Changing the rounding mode is
generally fairly expensive on modern CPUs, and this issue is a very minor
one for this application; therefore our implementation leaves the rounding mode
unchanged.">
      <sup>&dagger;</sup>
    </button>
		

</p>
<p></p>
<span class="anchor" id="fragment-IntervalPublicMethods-1"></span><div class="fragmentname">&lt;&lt;Interval Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-IntervalPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-IntervalPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Interval operator+(const Interval &amp;i) const {
    return Interval(<a href="#Interval::low" class="code">low</a> + i.<a href="#Interval::low" class="code">low</a>, <a href="#Interval::high" class="code">high</a> + i.<a href="#Interval::high" class="code">high</a>);
}
Interval operator-(const Interval &amp;i) const {
    return Interval(<a href="#Interval::low" class="code">low</a> - i.<a href="#Interval::high" class="code">high</a>, <a href="#Interval::high" class="code">high</a> - i.<a href="#Interval::low" class="code">low</a>);
}</div><p>


</p>
<p>For multiplication, which sides of each interval determine the minimum and
maximum values of the result interval depend on the signs of the respective
values.  Multiplying the various possibilities and taking the overall
minimum and maximum is easier than working through which ones to use and
multiplying these.

</p>
<p></p>
<span class="anchor" id="fragment-IntervalPublicMethods-2"></span><div class="fragmentname">&lt;&lt;Interval Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-IntervalPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Interval operator*(const Interval &amp;i) const {
    return Interval(std::min(std::min(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::low" class="code">low</a>,  <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::low" class="code">low</a>),
                             std::min(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::high" class="code">high</a>, <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::high" class="code">high</a>)),
                    std::max(std::max(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::low" class="code">low</a>,  <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::low" class="code">low</a>),
                             std::max(<a href="#Interval::low" class="code">low</a> * i.<a href="#Interval::high" class="code">high</a>, <a href="#Interval::high" class="code">high</a> * i.<a href="#Interval::high" class="code">high</a>)));
}</div><p>


</p>
<p>We have also implemented <tt>Sin()</tt> and <tt>Cos()</tt> functions for
<tt>Interval</tt>s. The implementations assume that the given interval is in
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.978ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2573.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 2 pi right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1724" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="2295" y="0"></use>
</g>
</svg>, which is the case for our use of these functions.
Here we only include the implementation of <tt>Sin()</tt>;
<tt>Cos()</tt> is quite similar in basic structure.

</p>
<p></p>
<span class="anchor" id="fragment-IntervalDefinitions-1"></span><div class="fragmentname">&lt;&lt;Interval Definitions&gt;&gt;+=&nbsp;<a href="#fragment-IntervalDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-IntervalDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">inline Interval Sin(const Interval &amp;i) {
    Float sinLow = std::sin(i.low), sinHigh = std::sin(i.high);
    if (sinLow &gt; sinHigh)
        std::swap(sinLow, sinHigh);
    if (i.low &lt; <a href="../Utilities/Main_Include_File.html#Pi" class="code">Pi</a> / 2 &amp;&amp; i.high &gt; <a href="../Utilities/Main_Include_File.html#Pi" class="code">Pi</a> / 2)
        sinHigh = 1.;
    if (i.low &lt; (3.f / 2.f) * <a href="../Utilities/Main_Include_File.html#Pi" class="code">Pi</a> &amp;&amp; i.high &gt; (3.f / 2.f) * <a href="../Utilities/Main_Include_File.html#Pi" class="code">Pi</a>)
        sinLow = -1.;
    return Interval(sinLow, sinHigh);
}</div><p>


</p>
<p>

</p>
<p>Given the interval machinery, we can now implement the
<tt>IntervalFindZeros()</tt> function, which finds the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values of any zero
crossings of Equation&nbsp;(<a href="#eq:motion-derivative">2.12</a>) over the given interval
<tt>tInterval</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-IntervalDefinitions-2"></span><div class="fragmentname">&lt;&lt;Interval Definitions&gt;&gt;+=&nbsp;<a href="#fragment-IntervalDefinitions-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="IntervalFindZeros"></span>IntervalFindZeros(Float c1, Float c2, Float c3, Float c4,
        Float c5, Float theta, Interval tInterval, Float *zeros,
        int *zeroCount, int depth = 8) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Evaluatemotionderivativeinintervalformreturnifnozeros-0">Evaluate motion derivative in interval form, return if no zeros</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-138" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-138"><i></i></a><div id="fragbit-138" class="collapse"><div class="fragmentcode">       Interval range = Interval(c1) +
           (Interval(c2) + Interval(c3) * tInterval) *
               Cos(Interval(2 * theta) * tInterval) +
           (Interval(c4) + Interval(c5) * tInterval) *
               Sin(Interval(2 * theta) * tInterval);
       if (range.<a href="#Interval::low" class="code">low</a> &gt; 0. || range.<a href="#Interval::high" class="code">high</a> &lt; 0. || range.<a href="#Interval::low" class="code">low</a> == range.<a href="#Interval::high" class="code">high</a>)
           return;</div></div>
    if (depth &gt; 0) {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-SplitmonotIntervalandcheckbothresultingintervals-0">Split <tt>tInterval</tt> and check both resulting intervals</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-139" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-139"><i></i></a><div id="fragbit-139" class="collapse"><div class="fragmentcode">           Float mid = (tInterval.<a href="#Interval::low" class="code">low</a> + tInterval.<a href="#Interval::high" class="code">high</a>) * 0.5f;
           <a href="#IntervalFindZeros" class="code">IntervalFindZeros</a>(c1, c2, c3, c4, c5, theta,
               Interval(tInterval.<a href="#Interval::low" class="code">low</a>, mid), zeros, zeroCount, depth - 1);
           <a href="#IntervalFindZeros" class="code">IntervalFindZeros</a>(c1, c2, c3, c4, c5, theta,
               Interval(mid, tInterval.<a href="#Interval::high" class="code">high</a>), zeros, zeroCount, depth - 1);</div></div>
    } else {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-UseNewtonsmethodtorefinezero-0">Use Newton&rsquo;s method to refine zero</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-140" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-140"><i></i></a><div id="fragbit-140" class="collapse"><div class="fragmentcode">           Float tNewton = (tInterval.<a href="#Interval::low" class="code">low</a> + tInterval.<a href="#Interval::high" class="code">high</a>) * 0.5f;
           for (int i = 0; i &lt; 4; ++i) {
               Float fNewton = c1 +
                   (c2 + c3 * tNewton) * std::cos(2.f * theta * tNewton) +
                   (c4 + c5 * tNewton) * std::sin(2.f * theta * tNewton);
               Float fPrimeNewton =
                   (c3 + 2 * (c4 + c5 * tNewton) * theta) *
                       std::cos(2.f * tNewton * theta) +
                   (c5 - 2 * (c2 + c3 * tNewton) * theta) *
                       std::sin(2.f * tNewton * theta);
               if (fNewton == 0 || fPrimeNewton == 0)
                   break;
               tNewton = tNewton - fNewton / fPrimeNewton;
           }
           zeros[*zeroCount] = tNewton;
           (*zeroCount)++;</div></div>
    }
}</div><p>


</p>
<p>The function starts by computing the interval range over <tt>tInterval</tt>.
If the range doesn&rsquo;t span zero, then there are no zeros of the function
over <tt>tInterval</tt> and the function can return.

</p>
<p></p>
<span class="anchor" id="fragment-Evaluatemotionderivativeinintervalformreturnifnozeros-0"></span><div class="fragmentname">&lt;&lt;Evaluate motion derivative in interval form, return if no zeros&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Interval range = Interval(c1) +
    (Interval(c2) + Interval(c3) * tInterval) *
        Cos(Interval(2 * theta) * tInterval) +
    (Interval(c4) + Interval(c5) * tInterval) *
        Sin(Interval(2 * theta) * tInterval);
if (range.<a href="#Interval::low" class="code">low</a> &gt; 0. || range.<a href="#Interval::high" class="code">high</a> &lt; 0. || range.<a href="#Interval::low" class="code">low</a> == range.<a href="#Interval::high" class="code">high</a>)
    return;</div><p>


</p>
<p>If the interval <tt>range</tt> does span zero, then there may be one or more
zeros in the interval <tt>tInterval</tt>, but it&rsquo;s also possible that there
actually aren&rsquo;t any, since the interval bounds are conservative but not as
tight as possible.  The function splits <tt>tInterval</tt> into two parts and
recursively checks the two sub-intervals.  Reducing the size of the
interval domain generally reduces the extent of the interval range, which
may allow us to determine that there are no zeros in one or both of the new
intervals.

</p>
<p></p>
<span class="anchor" id="fragment-SplitmonotIntervalandcheckbothresultingintervals-0"></span><div class="fragmentname">&lt;&lt;Split <tt>tInterval</tt> and check both resulting intervals&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float mid = (tInterval.<a href="#Interval::low" class="code">low</a> + tInterval.<a href="#Interval::high" class="code">high</a>) * 0.5f;
<a href="#IntervalFindZeros" class="code">IntervalFindZeros</a>(c1, c2, c3, c4, c5, theta,
    Interval(tInterval.<a href="#Interval::low" class="code">low</a>, mid), zeros, zeroCount, depth - 1);
<a href="#IntervalFindZeros" class="code">IntervalFindZeros</a>(c1, c2, c3, c4, c5, theta,
    Interval(mid, tInterval.<a href="#Interval::high" class="code">high</a>), zeros, zeroCount, depth - 1);</div><p>


</p>
<p>Once we have a narrow interval where the interval value of the motion
derivative function spans zero, the implementation switches to a few
iterations of Newton&rsquo;s method to find the zero, starting at the midpoint of
the interval.  Newton&rsquo;s method requires the derivative of the function;
since we&rsquo;re finding zeros of the motion derivative function, this is the
second derivative of Equation&nbsp;(<a href="#eq:point-animate-function">2.11</a>):
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="80.785ex" height="6.509ex" style="vertical-align: -2.171ex;" viewBox="0 -1867.7 34782.3 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartFraction normal d squared a Subscript normal upper M comma normal p Baseline left-parenthesis t right-parenthesis Subscript x Baseline Over normal d t squared EndFraction equals left-parenthesis c Subscript 3 comma x Baseline plus 2 theta left-parenthesis c Subscript 4 comma x Baseline plus c Subscript 5 comma x Baseline t right-parenthesis right-parenthesis cosine left-parenthesis 2 theta t right-parenthesis plus left-parenthesis c Subscript 5 comma x Baseline minus 2 theta left-parenthesis c Subscript 2 comma x Baseline plus c Subscript 3 comma x Baseline t right-parenthesis right-parenthesis sine left-parenthesis 2 theta t right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-4D" d="M879 0c-37 3 -104 3 -143 3s-107 0 -144 -3v31h24c77 0 79 11 79 47v574h-1l-246 -633c-4 -11 -7 -19 -18 -19c-10 0 -15 9 -20 22l-241 622h-1v-539c0 -27 0 -74 103 -74v-31l-117 3l-117 -3v31c103 0 103 47 103 74v500c0 36 -2 47 -79 47h-24v31h169c23 0 26 0 35 -22 l217 -560l219 563c7 18 7 19 33 19h169v-31h-24c-77 0 -79 -11 -79 -47v-527c0 -36 2 -47 79 -47h24v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="4644" height="60" x="0" y="220"></rect>
<g transform="translate(60,851)">
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="596"></use>
<g transform="translate(1010,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-4D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="917" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-70" x="1196" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1868" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="2258" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2619" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="4255" y="-458"></use>
</g>
</g>
<g transform="translate(1636,-780)">
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="0" y="0"></use>
<g transform="translate(556,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="511" y="408"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5162" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6218" y="0"></use>
<g transform="translate(6607,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8319" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="9320" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="9820" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10290" y="0"></use>
<g transform="translate(10679,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="12390" y="0"></use>
<g transform="translate(13391,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-35" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="14880" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15242" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15631" y="0"></use>
<g transform="translate(16188,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="17527" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="17917" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="18417" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="19053" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="19415" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="20026" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="21027" y="0"></use>
<g transform="translate(21417,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-35" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="23128" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="24129" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="24629" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="25099" y="0"></use>
<g transform="translate(25488,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="27200" y="0"></use>
<g transform="translate(28200,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="29689" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="30051" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="30440" y="0"></use>
<g transform="translate(30997,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="32226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="32616" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="33116" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="33752" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="34114" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="34503" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-UseNewtonsmethodtorefinezero-0"></span><div class="fragmentname">&lt;&lt;Use Newton&rsquo;s method to refine zero&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float tNewton = (tInterval.<a href="#Interval::low" class="code">low</a> + tInterval.<a href="#Interval::high" class="code">high</a>) * 0.5f;
for (int i = 0; i &lt; 4; ++i) {
    Float fNewton = c1 +
        (c2 + c3 * tNewton) * std::cos(2.f * theta * tNewton) +
        (c4 + c5 * tNewton) * std::sin(2.f * theta * tNewton);
    Float fPrimeNewton =
        (c3 + 2 * (c4 + c5 * tNewton) * theta) *
            std::cos(2.f * tNewton * theta) +
        (c5 - 2 * (c2 + c3 * tNewton) * theta) *
            std::sin(2.f * tNewton * theta);
    if (fNewton == 0 || fPrimeNewton == 0)
        break;
    tNewton = tNewton - fNewton / fPrimeNewton;
}
zeros[*zeroCount] = tNewton;
(*zeroCount)++;</div><p>


</p>
<p>Note that if there were multiple zeros of the function in <tt>tInterval</tt>
when Newton&rsquo;s method is used, then we will only find one of them here.
However, because the interval is quite small at this point, the impact of
this error should be minimal.  In any case, we haven&rsquo;t found this issue to
be a problem in practice.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
  <div class="container-fluid-nav">
    <!--  <ul class="nav navbar-nav navbar-center"> -->
      <span class="navbar-text" style="text-align: center;">
        Thanks to Scott Pilet and 43 others for generously supporting <i>Physically
        Based Rendering</i> online
        through <a href="https://patreon.com/pbrbook">Patreon</a>.
    </span>
  </div>
</nav>

<nav class="navbar navbar-expand-md bg-light navbar-light">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>, &copy; 2004-2021 Matt Pharr, Wenzel Jakob, and Greg Humphreys under the <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a> license. (<a href="https://github.com/mmp/pbr-book-website/">github</a>)</span>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Geometry_and_Transformations/Interactions.html">Geometry and Transformations / Interactions</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
