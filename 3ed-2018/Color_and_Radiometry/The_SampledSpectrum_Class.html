
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">
  <link rel="stylesheet" href="/bootstrap.min.css">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">

  <link rel="stylesheet" href="../pbrstyle.css">
  <script src="/3ed-2018/pbrt-display.js"></script>
        

  <title>The SampledSpectrum Class</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Color_and_Radiometry.html">Color and Radiometry</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">The SampledSpectrum Class</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Color_and_Radiometry/Spectral_Representation.html">(Previous: Spectral Representation)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block">
    <li class="nav-item"><button class="displaymode" onclick="TogglePBRTDisplayMode()"></button></li>
  </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<h2>5.2 The SampledSpectrum Class</h2><p>


</p>
<p><tt>SampledSpectrum</tt> uses the <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum"><tt>CoefficientSpectrum</tt></a> infrastructure to
represent an SPD with uniformly spaced samples between a starting and an
ending wavelength.  The wavelength range covers from 400&nbsp;nm to 700&nbsp;nm&mdash;the
range of the visual spectrum where the human visual system is most
sensitive.  The number of samples, 60, is generally more than enough to
accurately represent complex SPDs for rendering.  (See the &ldquo;Further
Reading&rdquo; section for background on sampling rate requirements for SPDs.)
Thus, the first sample represents the wavelength range <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.56ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4116.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 400 comma 405 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-34"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1001" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1780" y="0"></use>
<g transform="translate(2225,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-34"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1001" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3726" y="0"></use>
</g>
</svg>, the
second represents <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.56ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4116.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 405 comma 410 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-34"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1001" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1780" y="0"></use>
<g transform="translate(2225,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-34"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1001" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3726" y="0"></use>
</g>
</svg>, and so forth.  These values can easily be
changed here as needed.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumUtilityDeclarations-0"></span><div class="fragmentname">&lt;&lt;Spectrum Utility Declarations&gt;&gt;=&nbsp;<a href="#fragment-SpectrumUtilityDeclarations-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static const int <span class="anchor" id="sampledLambdaStart"></span>sampledLambdaStart = 400;
static const int <span class="anchor" id="sampledLambdaEnd"></span>sampledLambdaEnd = 700;
static const int <span class="anchor" id="nSpectralSamples"></span>nSpectralSamples = 60;</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-SpectrumDeclarations-1"></span><div class="fragmentname">&lt;&lt;Spectrum Declarations&gt;&gt;+=&nbsp;<a href="Spectral_Representation.html#fragment-SpectrumDeclarations-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="RGBSpectrum_Implementation.html#fragment-SpectrumDeclarations-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">class <span class="anchor" id="SampledSpectrum"></span>SampledSpectrum : public CoefficientSpectrum&lt;nSpectralSamples&gt; {
public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-SampledSpectrumPublicMethods-0">SampledSpectrum Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-682" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-682"><i></i></a><div id="fragbit-682" class="collapse"><div class="fragmentcode">       SampledSpectrum(Float v = 0.f) : CoefficientSpectrum(v) { }
       SampledSpectrum(const CoefficientSpectrum&lt;nSpectralSamples&gt; &amp;v) 
           : CoefficientSpectrum&lt;nSpectralSamples&gt;(v) { }
       static SampledSpectrum FromSampled(const Float *lambda,
                                          const Float *v, int n) {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Sortsamplesifunorderedusesortedforreturnedspectrum-0">Sort samples if unordered, use sorted for returned spectrum</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-683" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-683"><i></i></a><div id="fragbit-683" class="collapse"><div class="fragmentcode">              if (!<a href="#SpectrumSamplesSorted" class="code">SpectrumSamplesSorted</a>(lambda, v, n)) {
                  std::vector&lt;Float&gt; slambda(&amp;lambda[0], &amp;lambda[n]);
                  std::vector&lt;Float&gt; sv(&amp;v[0], &amp;v[n]);
                  <a href="#SortSpectrumSamples" class="code">SortSpectrumSamples</a>(&amp;slambda[0], &amp;sv[0], n);
                  return <a href="#SampledSpectrum::FromSampled" class="code">FromSampled</a>(&amp;slambda[0], &amp;sv[0], n);
              }</div></div>
           SampledSpectrum r;
           for (int i = 0; i &lt; nSpectralSamples; ++i) {
               &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeaveragevalueofgivenSPDoverithsamplesrange-0">Compute average value of given SPD over <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th sample&rsquo;s range</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-684" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-684"><i></i></a><div id="fragbit-684" class="collapse"><div class="fragmentcode">                  Float lambda0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                                       sampledLambdaStart, sampledLambdaEnd);
                  Float lambda1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i + 1) / Float(nSpectralSamples), 
                                       sampledLambdaStart, sampledLambdaEnd);
                  r.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(lambda, v, n, lambda0, lambda1);</div></div>
           }
           return r;
       }
       static void Init() {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeXYZmatchingfunctionsformonoSampledSpectrum-0">Compute XYZ matching functions for <tt>SampledSpectrum</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-685" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-685"><i></i></a><div id="fragbit-685" class="collapse"><div class="fragmentcode">              for (int i = 0; i &lt; nSpectralSamples; ++i) {
                  Float wl0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                                   sampledLambdaStart, sampledLambdaEnd);
                  Float wl1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i + 1) / Float(nSpectralSamples), 
                                   sampledLambdaStart, sampledLambdaEnd);
                  X.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_X, nCIESamples,
                                                  wl0, wl1);
                  Y.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_Y, nCIESamples,
                                                  wl0, wl1);
                  Z.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_Z, nCIESamples,
                                                  wl0, wl1);
              }</div></div>
           &lt;&lt;<span class="fragmentname">Compute RGB to spectrum functions for <tt>SampledSpectrum</tt></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-686" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-686"><i></i></a><div id="fragbit-686" class="collapse"><div class="fragmentcode">              for (int i = 0; i &lt; nSpectralSamples; ++i) {
                  Float wl0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                                   sampledLambdaStart, sampledLambdaEnd);
                  Float wl1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i+1) / Float(nSpectralSamples), 
                                   sampledLambdaStart, sampledLambdaEnd);
                  rgbRefl2SpectWhite.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectWhite, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbRefl2SpectCyan.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectCyan, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbRefl2SpectMagenta.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectMagenta, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbRefl2SpectYellow.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectYellow, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbRefl2SpectRed.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectRed, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbRefl2SpectGreen.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectGreen, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbRefl2SpectBlue.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectBlue, 
                      nRGB2SpectSamples, wl0, wl1);
              
                  rgbIllum2SpectWhite.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectWhite, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbIllum2SpectCyan.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectCyan, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbIllum2SpectMagenta.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectMagenta, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbIllum2SpectYellow.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectYellow, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbIllum2SpectRed.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectRed, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbIllum2SpectGreen.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectGreen, 
                      nRGB2SpectSamples, wl0, wl1);
                  rgbIllum2SpectBlue.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectBlue, 
                      nRGB2SpectSamples, wl0, wl1);
              }</div></div>
       }
       void <a href="#SampledSpectrum::ToXYZ" class="code">ToXYZ</a>(Float xyz[3]) const {
           xyz[0] = xyz[1] = xyz[2] = 0.f;
           for (int i = 0; i &lt; nSpectralSamples; ++i) {
               xyz[0] += X.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] * <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i];
               xyz[1] += <a href="#SampledSpectrum::Y" class="code">Y</a>.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] * <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i];
               xyz[2] += Z.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] * <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i];
           }
           Float scale = Float(sampledLambdaEnd - sampledLambdaStart) /
                         Float(CIE_Y_integral * nSpectralSamples);
           xyz[0] *= scale;
           xyz[1] *= scale;
           xyz[2] *= scale;
       }
       Float y() const { 
           Float yy = 0.f;
           for (int i = 0; i &lt; nSpectralSamples; ++i)
               yy += <a href="#SampledSpectrum::Y" class="code">Y</a>.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] * <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i];
           return yy * Float(sampledLambdaEnd - sampledLambdaStart) /
               Float(nSpectralSamples);
       }
       void ToRGB(Float rgb[3]) const { 
           Float xyz[3];
           <a href="#SampledSpectrum::ToXYZ" class="code">ToXYZ</a>(xyz);
           <a href="#XYZToRGB" class="code">XYZToRGB</a>(xyz, rgb);
       }
       RGBSpectrum ToRGBSpectrum() const;
       static SampledSpectrum <a href="#SampledSpectrum::FromRGB" class="code">FromRGB</a>(const Float rgb[3],
           SpectrumType type = SpectrumType::Illuminant);
       static SampledSpectrum FromXYZ(const Float xyz[3],
               SpectrumType type = SpectrumType::Reflectance) {
           Float rgb[3];
           <a href="#XYZToRGB" class="code">XYZToRGB</a>(xyz, rgb);
           return <a href="#SampledSpectrum::FromRGB" class="code">FromRGB</a>(rgb, type);
       }
       SampledSpectrum(const RGBSpectrum &amp;r, SpectrumType type = SpectrumType::Reflectance);</div></div>
private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-SampledSpectrumPrivateData-0">SampledSpectrum Private Data</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-687" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-687"><i></i></a><div id="fragbit-687" class="collapse"><div class="fragmentcode">       static SampledSpectrum X, Y, Z;
       static SampledSpectrum rgbRefl2SpectWhite, rgbRefl2SpectCyan;
       static SampledSpectrum rgbRefl2SpectMagenta, rgbRefl2SpectYellow;
       static SampledSpectrum rgbRefl2SpectRed, rgbRefl2SpectGreen;
       static SampledSpectrum rgbRefl2SpectBlue;
       static SampledSpectrum rgbIllum2SpectWhite, rgbIllum2SpectCyan;
       static SampledSpectrum rgbIllum2SpectMagenta, rgbIllum2SpectYellow;
       static SampledSpectrum rgbIllum2SpectRed, rgbIllum2SpectGreen;
       static SampledSpectrum rgbIllum2SpectBlue;</div></div>
};</div><p>


</p>
<p>By inheriting from the <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum"><tt>CoefficientSpectrum</tt></a> class,
<a href="#SampledSpectrum"><tt>SampledSpectrum</tt></a> automatically has all of the basic spectrum
arithmetic operations defined earlier.  The main methods left to define for
it are those that initialize it from spectral data and convert the SPD it
represents to other spectral representations (such as RGB).  The constructor
for initializing it with a constant SPD is straightforward.

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-0"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">SampledSpectrum(Float v = 0.f) : CoefficientSpectrum(v) { }</div><p>


</p>
<p>

</p>
<p>We will often be provided spectral data as a set of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.925ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2981.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis lamda Subscript i Baseline comma v Subscript i Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1317" y="0"></use>
<g transform="translate(1762,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2592" y="0"></use>
</g>
</svg>
samples, where the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th sample has some value <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.927ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 829.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
</svg> at wavelength
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.155ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 927.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">lamda Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
</svg>.  In general, the samples may have an irregular spacing and there
may be more or fewer of them than the <a href="#SampledSpectrum"><tt>SampledSpectrum</tt></a> stores.  (See
the directory <tt>scenes/spds</tt> in the <tt>pbrt</tt> distribution for a variety
of SPDs for use with <tt>pbrt</tt>, many of them with irregular sample spacing.)

</p>
<p>The <tt>FromSampled()</tt> method takes arrays of SPD sample values <tt>v</tt>
at given wavelengths <tt>lambda</tt> and uses them to define a piecewise
linear function to represent the SPD.  For each SPD sample in the
<tt>SampledSpectrum</tt>, it uses the <tt>AverageSpectrumSamples()</tt> utility
function, defined below, to compute the average of the piecewise linear
function over the range of wavelengths that each SPD sample is responsible
for.

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-1"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static SampledSpectrum <span class="anchor" id="SampledSpectrum::FromSampled"></span>FromSampled(const Float *lambda,
                                   const Float *v, int n) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Sortsamplesifunorderedusesortedforreturnedspectrum-0">Sort samples if unordered, use sorted for returned spectrum</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-688" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-688"><i></i></a><div id="fragbit-688" class="collapse"><div class="fragmentcode">       if (!<a href="#SpectrumSamplesSorted" class="code">SpectrumSamplesSorted</a>(lambda, v, n)) {
           std::vector&lt;Float&gt; slambda(&amp;lambda[0], &amp;lambda[n]);
           std::vector&lt;Float&gt; sv(&amp;v[0], &amp;v[n]);
           <a href="#SortSpectrumSamples" class="code">SortSpectrumSamples</a>(&amp;slambda[0], &amp;sv[0], n);
           return <a href="#SampledSpectrum::FromSampled" class="code">FromSampled</a>(&amp;slambda[0], &amp;sv[0], n);
       }</div></div>
    SampledSpectrum r;
    for (int i = 0; i &lt; nSpectralSamples; ++i) {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeaveragevalueofgivenSPDoverithsamplesrange-0">Compute average value of given SPD over <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th sample&rsquo;s range</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-689" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-689"><i></i></a><div id="fragbit-689" class="collapse"><div class="fragmentcode">           Float lambda0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                                sampledLambdaStart, sampledLambdaEnd);
           Float lambda1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i + 1) / Float(nSpectralSamples), 
                                sampledLambdaStart, sampledLambdaEnd);
           r.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(lambda, v, n, lambda0, lambda1);</div></div>
    }
    return r;
}</div><p>


</p>
<p>The <a href="#AverageSpectrumSamples"><tt>AverageSpectrumSamples()</tt></a> function requires that the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.925ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2981.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis lamda Subscript i Baseline comma v Subscript i Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1317" y="0"></use>
<g transform="translate(1762,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2592" y="0"></use>
</g>
</svg> values be sorted by wavelength.  The
<span class="anchor" id="SpectrumSamplesSorted"></span><tt>SpectrumSamplesSorted()</tt> function
checks
that they are; if not, <span class="anchor" id="SortSpectrumSamples"></span>
<tt>SortSpectrumSamples()</tt> sorts them.  Note that we allocate new storage
for the sorted samples and do not modify the values passed in by the
caller; in general, doing so would likely be unexpected behavior for a user
of this function (who shouldn&rsquo;t need to worry about these requirements of
its specific implementation).  We won&rsquo;t include the implementations of
either of these two functions here, as they are straightforward.

</p>
<p></p>
<span class="anchor" id="fragment-Sortsamplesifunorderedusesortedforreturnedspectrum-0"></span><div class="fragmentname">&lt;&lt;Sort samples if unordered, use sorted for returned spectrum&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (!<a href="#SpectrumSamplesSorted" class="code">SpectrumSamplesSorted</a>(lambda, v, n)) {
    std::vector&lt;Float&gt; slambda(&amp;lambda[0], &amp;lambda[n]);
    std::vector&lt;Float&gt; sv(&amp;v[0], &amp;v[n]);
    <a href="#SortSpectrumSamples" class="code">SortSpectrumSamples</a>(&amp;slambda[0], &amp;sv[0], n);
    return <a href="#SampledSpectrum::FromSampled" class="code">FromSampled</a>(&amp;slambda[0], &amp;sv[0], n);
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p>In order to compute the value for the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th spectral sample, we compute the
range of wavelengths that it&rsquo;s responsible for&mdash;<tt>lambda0</tt> to
<tt>lambda1</tt>&mdash;and use the <a href="#AverageSpectrumSamples"><tt>AverageSpectrumSamples()</tt></a> function to compute the
average value of the given piecewise linear SPD over that range.  This is a
1D instance of sampling and reconstruction, a topic that will
be discussed in more detail in Chapter&nbsp;<a href="../Sampling_and_Reconstruction.html#chap:sampling-reconstruction">7</a>.

</p>
<p></p>
<span class="anchor" id="fragment-ComputeaveragevalueofgivenSPDoverithsamplesrange-0"></span><div class="fragmentname">&lt;&lt;Compute average value of given SPD over <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th sample&rsquo;s range&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float lambda0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                     sampledLambdaStart, sampledLambdaEnd);
Float lambda1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i + 1) / Float(nSpectralSamples), 
                     sampledLambdaStart, sampledLambdaEnd);
r.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(lambda, v, n, lambda0, lambda1);</div><p>


</p>
<p>

</p>
<p>Figure&nbsp;<a href="#fig:sampled-spect-resample">5.2</a> shows the basic approach taken by
<tt>AverageSpectrumSamples()</tt>: it iterates over each of the linear
segments between samples that are partially or fully within the range of
wavelengths, <tt>lambdaStart</tt> to <tt>lambdaEnd</tt>.  For each such
segment, it computes the average value over its range, scales the average
by the wavelength range the segment covers, and accumulates a sum of these
values.  The final average value is this sum divided by the total
wavelength range.

</p>
<p> </p>
<span class="anchor" id="fig:sampled-spect-resample"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="Irregular%20SPD%20resample.svg" title=""><img src="Irregular%20SPD%20resample.svg" width=339 height=308 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 5.2: <span class="legend"> When resampling an irregularly defined SPD, we need to
  compute the average value of the piecewise linear function defined by the
  SPD samples.  Here, we want to average the value from 500&nbsp;nm to
  600&nbsp;nm&mdash;the shaded region under the plot.  The <tt>AverageSpectrumSamples()</tt>
  function does this by computing the areas of each of the regions denoted
  by dashed lines in this figure.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="AverageSpectrumSamples"></span>AverageSpectrumSamples(const Float *lambda, const Float *vals,
        int n, Float lambdaStart, Float lambdaEnd) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Handlecaseswithout-of-boundsrangeorsinglesampleonly-0">Handle cases with out-of-bounds range or single sample only</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-690" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-690"><i></i></a><div id="fragbit-690" class="collapse"><div class="fragmentcode">       if (lambdaEnd   &lt;= lambda[0])     return vals[0];
       if (lambdaStart &gt;= lambda[n - 1]) return vals[n - 1];
       if (n == 1) return vals[0];</div></div>
    Float sum = 0;  
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Addcontributionsofconstantsegmentsbeforeaftersamples-0">Add contributions of constant segments before/after samples</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-691" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-691"><i></i></a><div id="fragbit-691" class="collapse"><div class="fragmentcode">       if (lambdaStart &lt; lambda[0])
           sum += vals[0] * (lambda[0] - lambdaStart);
       if (lambdaEnd &gt; lambda[n-1])
           sum += vals[n - 1] * (lambdaEnd - lambda[n - 1]);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Advancetofirstrelevantwavelengthsegment-0">Advance to first relevant wavelength segment</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-692" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-692"><i></i></a><div id="fragbit-692" class="collapse"><div class="fragmentcode">       int i = 0;
       while (lambdaStart &gt; lambda[i + 1]) ++i;
       </div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Loopoverwavelengthsamplesegmentsandaddcontributions-0">Loop over wavelength sample segments and add contributions</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-693" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-693"><i></i></a><div id="fragbit-693" class="collapse"><div class="fragmentcode">       auto interp = [lambda, vals](Float w, int i) {
           return <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>((w - lambda[i]) / (lambda[i + 1] - lambda[i]),
                       vals[i], vals[i + 1]);
       };
       for (; i+1 &lt; n &amp;&amp; lambdaEnd &gt;= lambda[i]; ++i) {
           Float segLambdaStart = std::max(lambdaStart, lambda[i]);
           Float segLambdaEnd =   std::min(lambdaEnd,   lambda[i + 1]);
           sum += 0.5 * (interp(segLambdaStart, i) + interp(segLambdaEnd, i)) *
               (segLambdaEnd - segLambdaStart);
       }</div></div>
    return sum / (lambdaEnd - lambdaStart);
}</div><p>


</p>
<p>The function starts by checking for and handling the edge cases where the
range of wavelengths to average over is outside the range of provided
wavelengths or the case where there is only a single sample, in which case
the average value is trivially computed.  We assume that the SPD has a
constant value (the values at the two respective endpoints) outside of the
provided sample range; if this isn&rsquo;t a reasonable assumption for a
particular set of data, the data provided should have explicit
values of (for example) 0 at the endpoints.

</p>
<p></p>
<span class="anchor" id="fragment-Handlecaseswithout-of-boundsrangeorsinglesampleonly-0"></span><div class="fragmentname">&lt;&lt;Handle cases with out-of-bounds range or single sample only&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (lambdaEnd   &lt;= lambda[0])     return vals[0];
if (lambdaStart &gt;= lambda[n - 1]) return vals[n - 1];
if (n == 1) return vals[0];</div><p>


</p>
<p>Having handled these cases, the next step is to check to see if part of the
range to average over goes beyond the first and/or last sample value.  If
so, we accumulate the contribution of the constant segment(s), scaled by
the out-of-bounds wavelength range.

</p>
<p></p>
<span class="anchor" id="fragment-Addcontributionsofconstantsegmentsbeforeaftersamples-0"></span><div class="fragmentname">&lt;&lt;Add contributions of constant segments before/after samples&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (lambdaStart &lt; lambda[0])
    sum += vals[0] * (lambda[0] - lambdaStart);
if (lambdaEnd &gt; lambda[n-1])
    sum += vals[n - 1] * (lambdaEnd - lambda[n - 1]);</div><p>


</p>
<p>And now we advance to the first index <tt>i</tt> where the starting
wavelength of the interpolation range overlaps the segment from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.155ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 927.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">lamda Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
</svg>
to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.255ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1832.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">lamda Subscript i plus 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
</g>
</svg>.  A more efficient implementation would use a binary
search rather than a linear search here.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="An even more efficient
implementation would take advantage of the fact that the calling code will
generally ask for interpolated values over a series of adjacent wavelength
ranges, and possibly take all of the ranges in a single call.  It
could then incrementally find the starting index for the next interpolation
starting from the end of the previous one.">
      <sup>&dagger;</sup>
    </button>
		  However, this code is currently
only called at scene initialization time, so the lack of these
optimizations doesn&rsquo;t currently impact rendering performance.

</p>
<p></p>
<span class="anchor" id="fragment-Advancetofirstrelevantwavelengthsegment-0"></span><div class="fragmentname">&lt;&lt;Advance to first relevant wavelength segment&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">int i = 0;
while (lambdaStart &gt; lambda[i + 1]) ++i;
</div><p>


</p>
<p>The loop below iterates over each of the linear segments that the averaging
range overlaps.  For each one, it computes the average value over the
wavelength range <tt>segLambdaStart</tt> to <tt>segLambdaEnd</tt> by averaging
the values of the function at those two points.  The values in turn are
computed by <tt>interp()</tt>, a lambda function that linearly interpolates
between the two endpoints at the given wavelength.

</p>
<p>The <tt>std::min()</tt> and <tt>std::max()</tt> calls below compute the wavelength range
to average over within the segment; note that they naturally handle the
cases where <tt>lambdaStart</tt>, <tt>lambdaEnd</tt>, or both of them are
within the current segment.

</p>
<p></p>
<span class="anchor" id="fragment-Loopoverwavelengthsamplesegmentsandaddcontributions-0"></span><div class="fragmentname">&lt;&lt;Loop over wavelength sample segments and add contributions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">auto interp = [lambda, vals](Float w, int i) {
    return <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>((w - lambda[i]) / (lambda[i + 1] - lambda[i]),
                vals[i], vals[i + 1]);
};
for (; i+1 &lt; n &amp;&amp; lambdaEnd &gt;= lambda[i]; ++i) {
    Float segLambdaStart = std::max(lambdaStart, lambda[i]);
    Float segLambdaEnd =   std::min(lambdaEnd,   lambda[i + 1]);
    sum += 0.5 * (interp(segLambdaStart, i) + interp(segLambdaEnd, i)) *
        (segLambdaEnd - segLambdaStart);
}</div><p>


</p>
<p>


</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#XYZColor"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:color-xyz"></span><span id="XYZColor"></span><h3>5.2.1  XYZ Color</h3><p>



</p>
<p>A remarkable property of the human visual system makes it possible to
represent colors for human perception with just three floating-point
numbers.  
The <em>tristimulus theory</em> of color perception says that all visible SPDs
can be accurately represented for human observers with three values, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg>,
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg>.  Given an emissive SPD <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg>, these values are computed by
integrating its product with the <em>spectral matching curves</em> <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.142ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2214 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper X left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="851" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1241" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1824" y="0"></use>
</g>
</svg>,
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.936ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2125 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1735" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.845ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2086 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Z left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1113" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1696" y="0"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:xyz-matching"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.86ex" height="18.509ex" style="vertical-align: -8.486ex; margin-bottom: -0.185ex;" viewBox="0 -4235.8 9842.3 7969.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column x Subscript lamda 2nd Column equals integral Underscript lamda Endscripts upper S left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Row 1st Column y Subscript lamda 2nd Column equals integral Underscript lamda Endscripts upper S left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Row 1st Column z Subscript lamda 2nd Column equals integral Underscript lamda Endscripts upper S left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2791)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
<g transform="translate(82,22)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
<g transform="translate(107,-2747)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
<g transform="translate(1352,0)">
<g transform="translate(0,2791)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="812" y="-1270"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="2310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2955" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3345" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3928" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="4484" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5336" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5725" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6309" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="6865" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7421" y="0"></use>
</g>
<g transform="translate(0,22)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="812" y="-1270"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="2310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2955" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3345" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3928" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="4484" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5247" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5636" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6220" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="6776" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7332" y="0"></use>
</g>
<g transform="translate(0,-2747)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="812" y="-1270"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="2310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2955" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3345" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3928" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="4484" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5208" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5597" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6181" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="6737" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7293" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="7877" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:xyz-matching">5.1</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

These curves were determined by the Commission Internationale 
de l&rsquo;&Eacute;clairage (CIE) standards body after a series of experiments with human test
subjects  and are graphed in Figure&nbsp;<a href="#fig:cie-xyz">5.3</a>.  It is believed
that these matching curves are generally similar to the responses of the
three types of color-sensitive cones in the human retina.
Remarkably, SPDs with substantially different distributions may have very
similar <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg> values.  To the human observer, such SPDs
actually appear the same visually.  Pairs of such spectra are called
<em>metamers</em>.

</p>
<p>
</p>
<span class="anchor" id="fig:cie-xyz"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="matching-xyz.svg" title=""><img src="matching-xyz.svg" width=360 height=231 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 5.3: Computing the XYZ Values for an Arbitrary
SPD. <span class="legend">  The SPD is multiplied by each of the three matching curves
and integrated over their non-zero extent
to compute the values <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg>, using
Equation&nbsp;(<a href="#eq:xyz-matching">5.1</a>).</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>This brings us to a subtle point about representations of spectral power
distributions.  Most color spaces attempt to model colors that are visible
to humans and therefore use only three coefficients, exploiting the
tristimulus theory of color perception.  Although XYZ works well to
represent a given SPD to be displayed for a human observer, it is
<em>not</em> a particularly good set of basis functions for spectral
computation.  For example, although XYZ values would work well to describe
the perceived color of lemon skin or a fluorescent light individually
(recall Figure&nbsp;<a href="../Color_and_Radiometry/Spectral_Representation.html#fig:spds">5.1</a>), the product of their respective XYZ values
is likely to give a noticeably different XYZ color than the XYZ value
computed by multiplying more accurate representations of their SPDs and
<em>then</em> computing the XYZ value.

</p>
<p><tt>pbrt</tt> provides the values of the standard <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.142ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2214 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper X left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="851" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1241" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1824" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.936ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2125 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1735" y="0"></use>
</g>
</svg>, and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.845ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2086 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Z left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1113" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1696" y="0"></use>
</g>
</svg> response curves sampled at 1-nm increments from 360&nbsp;nm to
830&nbsp;nm.  The wavelengths of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th sample in the arrays below are given
by the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th element of <tt>CIE_lambda</tt>; having the wavelengths of the
samples explicitly represented in this way makes it easy to pass the XYZ
samples into functions like <a href="#AverageSpectrumSamples"><tt>AverageSpectrumSamples()</tt></a> that take such
an array of wavelengths as a parameter.

</p>
<p></p>
<span class="anchor" id="fragment-SpectralDataDeclarations-0"></span><div class="fragmentname">&lt;&lt;Spectral Data Declarations&gt;&gt;=&nbsp;<a href="#fragment-SpectralDataDeclarations-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static const int <span class="anchor" id="nCIESamples"></span>nCIESamples = 471;
extern const Float <span class="anchor" id="CIE_X"></span>CIE_X[nCIESamples];
extern const Float <span class="anchor" id="CIE_Y"></span>CIE_Y[nCIESamples];
extern const Float <span class="anchor" id="CIE_Z"></span>CIE_Z[nCIESamples];
extern const Float <span class="anchor" id="CIE_lambda"></span>CIE_lambda[nCIESamples];</div><p>


</p>
<p><a href="#SampledSpectrum"><tt>SampledSpectrum</tt></a> uses these samples to compute the XYZ matching curves
in its spectral representation (i.e., themselves as
<tt>SampledSpectrum</tt>s).

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPrivateData-0"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Private Data&gt;&gt;=&nbsp;<a href="#fragment-SampledSpectrumPrivateData-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static SampledSpectrum <span class="anchor" id="SampledSpectrum::X"></span>X, <span class="anchor" id="SampledSpectrum::Y"></span>Y, <span class="anchor" id="SampledSpectrum::Z"></span>Z;</div><p>


</p>
<p>

</p>
<p>The <tt>SampledSpectrum</tt> XYZ matching curves are computed in the
<tt>SampledSpectrum::Init()</tt> method, which is called at system
startup time by the <a href="../Scene_Description_Interface/Initialization_and_Rendering_Options.html#pbrtInit"><tt>pbrtInit()</tt></a> function defined
in Section&nbsp;<a href="../Scene_Description_Interface/Initialization_and_Rendering_Options.html#sec:api-init-options">A.2</a>.

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-2"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static void <span class="anchor" id="SampledSpectrum::Init"></span>Init() {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeXYZmatchingfunctionsformonoSampledSpectrum-0">Compute XYZ matching functions for <tt>SampledSpectrum</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-694" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-694"><i></i></a><div id="fragbit-694" class="collapse"><div class="fragmentcode">       for (int i = 0; i &lt; nSpectralSamples; ++i) {
           Float wl0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                            sampledLambdaStart, sampledLambdaEnd);
           Float wl1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i + 1) / Float(nSpectralSamples), 
                            sampledLambdaStart, sampledLambdaEnd);
           X.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_X, nCIESamples,
                                           wl0, wl1);
           Y.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_Y, nCIESamples,
                                           wl0, wl1);
           Z.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_Z, nCIESamples,
                                           wl0, wl1);
       }</div></div>
    &lt;&lt;<span class="fragmentname">Compute RGB to spectrum functions for <tt>SampledSpectrum</tt></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-695" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-695"><i></i></a><div id="fragbit-695" class="collapse"><div class="fragmentcode">       for (int i = 0; i &lt; nSpectralSamples; ++i) {
           Float wl0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                            sampledLambdaStart, sampledLambdaEnd);
           Float wl1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i+1) / Float(nSpectralSamples), 
                            sampledLambdaStart, sampledLambdaEnd);
           rgbRefl2SpectWhite.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectWhite, 
               nRGB2SpectSamples, wl0, wl1);
           rgbRefl2SpectCyan.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectCyan, 
               nRGB2SpectSamples, wl0, wl1);
           rgbRefl2SpectMagenta.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectMagenta, 
               nRGB2SpectSamples, wl0, wl1);
           rgbRefl2SpectYellow.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectYellow, 
               nRGB2SpectSamples, wl0, wl1);
           rgbRefl2SpectRed.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectRed, 
               nRGB2SpectSamples, wl0, wl1);
           rgbRefl2SpectGreen.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectGreen, 
               nRGB2SpectSamples, wl0, wl1);
           rgbRefl2SpectBlue.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBRefl2SpectBlue, 
               nRGB2SpectSamples, wl0, wl1);
       
           rgbIllum2SpectWhite.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectWhite, 
               nRGB2SpectSamples, wl0, wl1);
           rgbIllum2SpectCyan.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectCyan, 
               nRGB2SpectSamples, wl0, wl1);
           rgbIllum2SpectMagenta.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectMagenta, 
               nRGB2SpectSamples, wl0, wl1);
           rgbIllum2SpectYellow.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectYellow, 
               nRGB2SpectSamples, wl0, wl1);
           rgbIllum2SpectRed.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectRed, 
               nRGB2SpectSamples, wl0, wl1);
           rgbIllum2SpectGreen.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectGreen, 
               nRGB2SpectSamples, wl0, wl1);
           rgbIllum2SpectBlue.c[i] = AverageSpectrumSamples(RGB2SpectLambda, RGBIllum2SpectBlue, 
               nRGB2SpectSamples, wl0, wl1);
       }</div></div>
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-GeneralpbrtInitialization-0"></span><div class="fragmentname">&lt;&lt;General <tt>pbrt</tt> Initialization&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#SampledSpectrum::Init" class="code">SampledSpectrum</a>::Init();</div><p>


</p>
<p>Given the wavelength range and number of samples for
<tt>SampledSpectrum</tt>, computing the values of the matching functions for
each sample is just a matter of computing the sample&rsquo;s wavelength range and
using the <a href="#AverageSpectrumSamples"><tt>AverageSpectrumSamples()</tt></a> routine.

</p>
<p></p>
<span class="anchor" id="fragment-ComputeXYZmatchingfunctionsformonoSampledSpectrum-0"></span><div class="fragmentname">&lt;&lt;Compute XYZ matching functions for <tt>SampledSpectrum</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">for (int i = 0; i &lt; nSpectralSamples; ++i) {
    Float wl0 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i) / Float(nSpectralSamples), 
                     sampledLambdaStart, sampledLambdaEnd);
    Float wl1 = <a href="../Utilities/Mathematical_Routines.html#Lerp" class="code">Lerp</a>(Float(i + 1) / Float(nSpectralSamples), 
                     sampledLambdaStart, sampledLambdaEnd);
    X.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_X, nCIESamples,
                                    wl0, wl1);
    Y.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_Y, nCIESamples,
                                    wl0, wl1);
    Z.c[i] = <a href="#AverageSpectrumSamples" class="code">AverageSpectrumSamples</a>(CIE_lambda, CIE_Z, nCIESamples,
                                    wl0, wl1);
}</div><p>


</p>
<p>
All <a href="../Color_and_Radiometry/Spectral_Representation.html#Spectrum"><tt>Spectrum</tt></a> implementations in <tt>pbrt</tt> must provide a method that
converts their SPD to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.999ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4735.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x Subscript lamda Baseline comma y Subscript lamda Baseline comma z Subscript lamda Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1474" y="0"></use>
<g transform="translate(1919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2922" y="0"></use>
<g transform="translate(3368,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4346" y="0"></use>
</g>
</svg> coefficients.  This method is
called, for example, in the process of updating pixels in the image.  When
a <tt>Spectrum</tt> representing the light carried along a ray from the
camera is provided to the <a href="../Sampling_and_Reconstruction/Film_and_the_Imaging_Pipeline.html#Film"><tt>Film</tt></a>, the <tt>Film</tt> converts the SPD into
XYZ coefficients as a first step in the process of finally turning them
into RGB values used for storage and/or display.

</p>
<p>To compute XYZ coefficients, <tt>SampledSpectrum</tt> computes the integrals
from Equation&nbsp;(<a href="#eq:xyz-matching">5.1</a>) with a Riemann sum:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.91ex" height="7.343ex" style="vertical-align: -3.005ex;" viewBox="0 -1867.7 12016.8 3161.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda Baseline almost-equals StartFraction lamda Subscript normal e normal n normal d Baseline minus lamda Subscript normal s normal t normal a normal r normal t Baseline Over upper N EndFraction sigma-summation Underscript i equals 0 Overscript upper N minus 1 Endscripts upper X Subscript i Baseline c Subscript i Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D441" d="M881 672c0 -19 -12 -20 -17 -20c-80 -3 -98 -34 -108 -74l-140 -557c-5 -18 -5 -21 -16 -21c-9 0 -12 2 -19 19l-249 589c-5 10 -5 12 -9 18l-132 -528c-3 -11 -4 -16 -4 -23c0 -20 8 -42 66 -44c11 0 20 -1 20 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3 c-33 0 -68 -3 -100 -3c-8 0 -13 4 -13 11c0 19 11 20 17 20c81 3 98 35 108 75l134 537c0 9 -63 9 -68 9c-19 0 -28 0 -28 11c0 20 9 20 29 20h134c23 0 24 -1 32 -19l221 -522l112 445c1 3 3 18 3 21c0 22 -11 43 -68 44c-8 0 -18 0 -18 11c0 20 12 20 18 20 c33 0 68 -3 102 -3c33 0 68 3 101 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="1362" y="0"></use>
<g transform="translate(2136,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5272" height="60" x="0" y="220"></rect>
<g transform="translate(60,677)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6E" x="444" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-64" x="1001" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2007" y="0"></use>
<g transform="translate(3007,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-73" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-74" x="394" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="784" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-72" x="1284" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-74" x="1677" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D441" x="2195" y="-704"></use>
</g>
</g>
<g transform="translate(8093,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="41" y="0"></use>
<g transform="translate(189,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="1124" y="0"></use>
</g>
<g transform="translate(0,1151)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D441" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="881" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1660" y="0"></use>
</g>
</g>
<g transform="translate(9787,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="1171" y="-213"></use>
</g>
<g transform="translate(10960,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="11738" y="0"></use>
</g>
</svg>
</div>
<p>

and so forth.

</p>
<p><span class="anchor" id="Spectrum::ToXYZ"></span>
</p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-3"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="SampledSpectrum::ToXYZ"></span>ToXYZ(Float xyz[3]) const {
    xyz[0] = xyz[1] = xyz[2] = 0.f;
    for (int i = 0; i &lt; nSpectralSamples; ++i) {
        xyz[0] += X.c[i] * c[i];
        xyz[1] += Y.c[i] * c[i];
        xyz[2] += Z.c[i] * c[i];
    }
    Float scale = Float(sampledLambdaEnd - sampledLambdaStart) /
                  Float(CIE_Y_integral * nSpectralSamples);
    xyz[0] *= scale;
    xyz[1] *= scale;
    xyz[2] *= scale;
}</div><p>


</p>
<p>The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> coefficient of XYZ color is closely related to <em>luminance</em>,
which measures the perceived brightness of a color.  Luminance is described
in more detail in Section&nbsp;<a href="../Color_and_Radiometry/Radiometry.html#sec:photometry">5.4.3</a>.  We provide a method to
compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> alone in a separate method as often only the luminance of a
spectrum is desired.  (For example, some of the light transport algorithms
in Chapters&nbsp;<a href="../Light_Transport_I_Surface_Reflection.html#chap:light-transport">14</a>, <a href="../Light_Transport_II_Volume_Rendering.html#chap:volume-integration">15</a>, and&nbsp;<a href="../Light_Transport_III_Bidirectional_Methods.html#chap:bidir-methods">16</a> use
luminance as a measure of the relative importance of light-carrying paths
through the scene.)

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-4"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Spectrum::y"></span>y() const { 
    Float yy = 0.f;
    for (int i = 0; i &lt; nSpectralSamples; ++i)
        yy += <a href="#SampledSpectrum::Y" class="code">Y</a>.<a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i] * <a href="../Color_and_Radiometry/Spectral_Representation.html#CoefficientSpectrum::c" class="code">c</a>[i];
    return yy * Float(sampledLambdaEnd - sampledLambdaStart) /
        Float(nSpectralSamples);
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#RGBColor"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:rgb-to-spd"></span><span id="RGBColor"></span><h3>5.2.2  RGB Color</h3><p>



</p>
<p>When we display an RGB color on a display, the spectrum that is actually
displayed is basically determined by the weighted sum of three spectral
response curves, one for each of red, green, and blue, as emitted by the
display&rsquo;s phosphors, LED or LCD elements, or plasma cells.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="This model is
  admittedly a simplification in that it neglects any additional processing the
  display does; in particular, many displays perform nonlinear remappings
  of the displayed values.">
      <sup>&dagger;</sup>
    </button>
		  Figure&nbsp;<a href="#fig:display-rgb-plots">5.4</a> plots the
red, green, and blue distributions emitted by a LED display and a LCD
display; note that they are remarkably different.

</p>
<p></p>
<span class="anchor" id="fig:display-rgb-plots"></span><div class="card outerfigure"><div class="card-body figure"><p>




</p>
<div class="figure-row">
  <a href="lcd-display-spd.svg" title=""><img src="lcd-display-spd.svg" width=360 height=258 style="max-width: 100%;"></a>
  <a href="led-display-spd.svg" title=""><img src="led-display-spd.svg" width=360 height=260 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 5.4: Red, Green, and Blue Emission Curves for an LCD Display and an LED
  Display. <span class="legend">
  The first plot shows the curves for an LCD display, and the second shows
  them for an LED.
  These two
  displays have quite different emission profiles. <em>(Data courtesy of
    X-Rite, Inc.)</em></span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Figure&nbsp;<a href="#fig:display-rgb-result">5.5</a> in turn shows the SPDs that result from
displaying the RGB color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.792ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5507.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.6 comma 0.3 comma 0.2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1669" y="0"></use>
<g transform="translate(2114,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3393" y="0"></use>
<g transform="translate(3838,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5118" y="0"></use>
</g>
</svg> on those displays.  Not
surprisingly, the resulting SPDs are quite different as well.  This example
illustrates that using RGB values provided by the user to describe a
particular color is actually only meaningful given knowledge of the
characteristics of the display they were using when they selected the RGB
values.

</p>
<p></p>
<span class="anchor" id="fig:display-rgb-result"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="same-rgb-different-display.svg" title=""><img src="same-rgb-different-display.svg" width=360 height=240 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 5.5: SPDs from Displaying the RGB Color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.792ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5507.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.6 comma 0.3 comma 0.2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1669" y="0"></use>
<g transform="translate(2114,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3393" y="0"></use>
<g transform="translate(3838,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5118" y="0"></use>
</g>
</svg>
on LED and LCD Displays. <span class="legend">  The resulting emitted SPDs are remarkably
different, even given the same RGB values, due to the different emission
curves illustrated in Figure&nbsp;<a href="#fig:display-rgb-plots">5.4</a>.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Given an <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.999ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4735.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x Subscript lamda Baseline comma y Subscript lamda Baseline comma z Subscript lamda Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1474" y="0"></use>
<g transform="translate(1919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2922" y="0"></use>
<g transform="translate(3368,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4346" y="0"></use>
</g>
</svg> representation of an SPD, we can convert
it to corresponding RGB coefficients, given the choice of a particular set
of SPDs that define red, green, and blue for a display of interest.  Given
the spectral response curves <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.929ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2122 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper R left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.991ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2149 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper G left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="786" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1176" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1759" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.929ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2122 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper B left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</svg>,
for a particular display, RGB coefficients can be computed by integrating
the response curves with the SPD <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg> and using the tristimulus
theory of color perception:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.057ex" height="11.843ex" style="vertical-align: -5.338ex;" viewBox="0 -2800.6 28441.3 5098.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column r 2nd Column equals integral upper R left-parenthesis lamda right-parenthesis upper S left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline equals integral upper R left-parenthesis lamda right-parenthesis left-parenthesis x Subscript lamda Baseline upper X left-parenthesis lamda right-parenthesis plus y Subscript lamda Baseline upper Y left-parenthesis lamda right-parenthesis plus z Subscript lamda Baseline upper Z left-parenthesis lamda right-parenthesis right-parenthesis normal d lamda Subscript Baseline 2nd Row 1st Column Blank 2nd Column equals x Subscript lamda Baseline integral upper R left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline plus y Subscript lamda Baseline integral upper R left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline plus z Subscript lamda Baseline integral upper R left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="1362"></use>
</g>
<g transform="translate(718,0)">
<g transform="translate(0,1362)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="2166" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2925" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3315" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3898" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="4288" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4933" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5323" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5906" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="6296" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6852" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="7714" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="8770" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="9880" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10640" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="11029" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11613" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="12002" y="0"></use>
<g transform="translate(12392,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="13477" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="14328" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="14718" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15301" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="15913" y="0"></use>
<g transform="translate(16914,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="17917" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="18679" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="19069" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="19652" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="20264" y="0"></use>
<g transform="translate(21265,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="22243" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="22966" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="23356" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="23939" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="24329" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="24885" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="25442" y="0"></use>
</g>
<g transform="translate(0,-1362)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="2308" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="3418" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4177" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4567" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5150" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="5540" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6391" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6781" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7364" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="7920" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8477" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9283" y="0"></use>
<g transform="translate(10283,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="11453" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="12563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="13323" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="13712" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="14296" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="14685" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="15448" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="15837" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="16421" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="16977" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="17533" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="18339" y="0"></use>
<g transform="translate(19340,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="20485" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="21595" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="22354" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="22744" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="23327" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="23717" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="24440" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="24830" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="25413" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="25969" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="26526" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="27109" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

The integrals of the products of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.071ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4336 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper R left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="2122" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2973" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3946" y="0"></use>
</g>
</svg> and so forth can
be precomputed for given response curves, making it possible to express the
full conversion as a matrix:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.954ex" height="10.176ex" style="vertical-align: -4.505ex;" viewBox="0 -2441.8 29688.6 4381.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 3 By 1 Matrix 1st Row  r 2nd Row  g 3rd Row  b EndMatrix equals Start 3 By 3 Matrix 1st Row 1st Column integral upper R left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Column integral upper R left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Column integral upper R left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Row 1st Column integral upper G left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Column integral upper G left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Column integral upper G left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Row 1st Column integral upper B left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Column integral upper B left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Column integral upper B left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline EndMatrix Start 3 By 1 Matrix 1st Row  x Subscript lamda Baseline 2nd Row  y Subscript lamda Baseline 3rd Row  z Subscript lamda Baseline EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-222B" d="M609 722c0 -30 -22 -43 -42 -43c-19 0 -41 13 -41 42c0 14 8 37 37 41c-22 19 -53 21 -63 21c-45 0 -79 -25 -93 -209l-19 -249c-8 -111 -44 -402 -57 -454c-22 -90 -70 -177 -165 -177c-60 0 -110 35 -110 83c0 30 22 43 42 43c19 0 41 -13 41 -42c0 -14 -8 -37 -37 -41 c21 -18 51 -21 64 -21c57 0 93 45 106 209l19 249c9 121 45 403 57 458c17 76 56 173 151 173c60 0 110 -35 110 -83Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="13" y="1353"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="-47"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="24" y="-1453"></use>
</g>
</g>
<g transform="translate(1468,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2413" y="0"></use>
<g transform="translate(3470,0)">
<g transform="translate(0,2319)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2689.51) scale(1,2.49)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-4138"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(13,1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="2954" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3805" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4195" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5168" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5724" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="2981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4805" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5195" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5751" y="0"></use>
<g transform="translate(13,-1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="2954" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3805" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4195" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5168" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5724" y="0"></use>
</g>
</g>
<g transform="translate(7324,0)">
<g transform="translate(13,1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="2954" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3716" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4106" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4689" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5079" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5635" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="2981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3743" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4133" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4716" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5106" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5662" y="0"></use>
<g transform="translate(13,-1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="2954" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3716" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4106" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4689" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5079" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5635" y="0"></use>
</g>
</g>
<g transform="translate(14570,0)">
<g transform="translate(13,1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="2954" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3677" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4067" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4650" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5040" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5596" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="2981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3704" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4094" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4677" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5067" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5623" y="0"></use>
<g transform="translate(13,-1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="2954" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3677" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4067" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4650" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5040" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5596" y="0"></use>
</g>
</g>
</g>
<g transform="translate(21987,2319)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2689.51) scale(1,2.49)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-4138"></use>
</g>
</g>
<g transform="translate(26499,0)">
<g transform="translate(0,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1353)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
<g transform="translate(41,-47)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
<g transform="translate(53,-1453)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2076,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="29410" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>The conversion routines implemented in <tt>pbrt</tt> are based on a standard set
of these RGB spectra that has been defined for high-definition television.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumUtilityDeclarations-1"></span><div class="fragmentname">&lt;&lt;Spectrum Utility Declarations&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumUtilityDeclarations-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumUtilityDeclarations-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">inline void <span class="anchor" id="XYZToRGB"></span>XYZToRGB(const Float xyz[3], Float rgb[3]) {
    rgb[0] =  3.240479f*xyz[0] - 1.537150f*xyz[1] - 0.498535f*xyz[2];
    rgb[1] = -0.969256f*xyz[0] + 1.875991f*xyz[1] + 0.041556f*xyz[2];
    rgb[2] =  0.055648f*xyz[0] - 0.204043f*xyz[1] + 1.057311f*xyz[2];
}</div><p>


</p>
<p>The inverse of this matrix gives coefficients to convert given RGB values
expressed with respect to a particular set of RGB response curves to 
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.999ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4735.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x Subscript lamda Baseline comma y Subscript lamda Baseline comma z Subscript lamda Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1474" y="0"></use>
<g transform="translate(1919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2922" y="0"></use>
<g transform="translate(3368,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4346" y="0"></use>
</g>
</svg> coefficients.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumUtilityDeclarations-2"></span><div class="fragmentname">&lt;&lt;Spectrum Utility Declarations&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumUtilityDeclarations-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumUtilityDeclarations-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">inline void <span class="anchor" id="RGBToXYZ"></span>RGBToXYZ(const Float rgb[3], Float xyz[3]) {
    xyz[0] = 0.412453f*rgb[0] + 0.357580f*rgb[1] + 0.180423f*rgb[2];
    xyz[1] = 0.212671f*rgb[0] + 0.715160f*rgb[1] + 0.072169f*rgb[2];
    xyz[2] = 0.019334f*rgb[0] + 0.119193f*rgb[1] + 0.950227f*rgb[2];
}</div><p>


</p>
<p>Given these functions, a <a href="#SampledSpectrum"><tt>SampledSpectrum</tt></a> can convert to RGB
coefficients by first converting to XYZ and then using the <a href="#XYZToRGB"><tt>XYZToRGB()</tt></a>
utility function.<span class="anchor" id="Spectrum::ToRGB"></span>

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-5"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-4"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-6"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="SampledSpectrum::ToRGB"></span>ToRGB(Float rgb[3]) const { 
    Float xyz[3];
    <a href="#SampledSpectrum::ToXYZ" class="code">ToXYZ</a>(xyz);
    <a href="#XYZToRGB" class="code">XYZToRGB</a>(xyz, rgb);
}</div><p>


</p>
<p>An <a href="../Color_and_Radiometry/RGBSpectrum_Implementation.html#RGBSpectrum"><tt>RGBSpectrum</tt></a> can also be created easily, using the <tt>ToRGBSpectrum()</tt> method.

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-6"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-5"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-7"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">RGBSpectrum <span class="anchor" id="SampledSpectrum::ToRGBSpectrum"></span>ToRGBSpectrum() const;</div><p>


</p>
<p>

</p>
<p>Going the other way and converting from RGB or XYZ values to a SPD isn&rsquo;t as
easy: the problem is highly under-constrained.  Recall that an infinite
number of different SPDs have the same <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.999ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4735.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x Subscript lamda Baseline comma y Subscript lamda Baseline comma z Subscript lamda Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1474" y="0"></use>
<g transform="translate(1919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2922" y="0"></use>
<g transform="translate(3368,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4346" y="0"></use>
</g>
</svg> (and thus
RGB) coefficients.  Thus, given an RGB or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.999ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4735.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x Subscript lamda Baseline comma y Subscript lamda Baseline comma z Subscript lamda Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1474" y="0"></use>
<g transform="translate(1919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2922" y="0"></use>
<g transform="translate(3368,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4346" y="0"></use>
</g>
</svg> value,
there are an infinite number of possible SPDs that could be chosen for it.
There are a number of
desirable criteria that we&rsquo;d like a conversion function to have:
</p>
<ul>
<li> If all of the RGB coefficients have the same value, the resulting SPD
should be constant.
<li> In general, it&rsquo;s desirable that the computed SPD be smooth.  Most
real-world objects have relatively smooth spectra.  (The main source of
spiky spectra is light sources, especially fluorescents.  Fortunately,
actual spectral data are more commonly available for illuminants than they
are for reflectances.)
</ul><p>

The smoothness goal is one of the reasons why constructing an SPD as a
weighted sum of a display&rsquo;s <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.929ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2122 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper R left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.991ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2149 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper G left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="786" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1176" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1759" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.929ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2122 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper B left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</svg>
SPDs is not a good solution: as shown in
Figure&nbsp;<a href="#fig:display-rgb-plots">5.4</a>, those functions are generally irregular
and spiky, and a weighted sum of them will thus not be a very smooth SPD.
Although the result will be a metamer of the given RGB values, it&rsquo;s likely
not an accurate representation of the SPD of the actual object.

</p>
<p>Here we implement a method for converting RGBs to SPDs suggested by Smits (<a href="Further_Reading.html#cite:Smits:1999:ARC">1999</a>) that tries to achieve the goals above.  This approach is based on
the observation that a good start is to compute individual SPDs for red,
green, and blue that are smooth and such that computing the weighted sum of
them with the given RGB coefficients and then converting back to RGB give
a result that is close to the original RGB coefficients.  He found such
spectra through a numerical optimization procedure.

</p>
<p>Smits observed that two additional improvements could be made to this basic
approach.  First, rather than representing constant spectra by the sums of
the computed red, green, and blue SPDs, the sum of which isn&rsquo;t exactly
constant, it&rsquo;s better to represent constant spectra with constant SPDs.
Second, mixtures of colors like yellow (a mixture of red and green) that
are a mixture of two of the primaries are better represented by their own
precomputed smooth SPDs rather than the sum of SPDs for the two corresponding
primaries.

</p>
<p>
The following arrays store SPDs that meet these criteria, with their
samples&rsquo; wavelengths in <tt>RGB2SpectLambda[]</tt>  (these data were generated
by Karl vom Berge).

</p>
<p></p>
<span class="anchor" id="fragment-SpectralDataDeclarations-1"></span><div class="fragmentname">&lt;&lt;Spectral Data Declarations&gt;&gt;+=&nbsp;<a href="#fragment-SpectralDataDeclarations-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectralDataDeclarations-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static const int <span class="anchor" id="nRGB2SpectSamples"></span>nRGB2SpectSamples = 32;
extern const Float <span class="anchor" id="RGB2SpectLambda"></span>RGB2SpectLambda[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectWhite"></span>RGBRefl2SpectWhite[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectCyan"></span>RGBRefl2SpectCyan[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectMagenta"></span>RGBRefl2SpectMagenta[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectYellow"></span>RGBRefl2SpectYellow[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectRed"></span>RGBRefl2SpectRed[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectGreen"></span>RGBRefl2SpectGreen[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBRefl2SpectBlue"></span>RGBRefl2SpectBlue[nRGB2SpectSamples];</div><p>


</p>
<p>If a given RGB color describes illumination from a light source, better
results are achieved if the conversion tables are computed using the
spectral power distribution of a representative illumination source to
define &ldquo;white&rdquo; rather than using a constant spectrum as they are for the
tables above that are used for reflectances.  The <tt>RGBIllum2Spect</tt>
arrays use the D65 spectral power distribution, which has been standardized
by the CIE to represent midday sunlight. (The D65 illuminant will be
discussed more in Section&nbsp;<a href="../Light_Sources/Light_Emission.html#sec:standard-illuminants">12.1.2</a>.)

</p>
<p></p>
<span class="anchor" id="fragment-SpectralDataDeclarations-2"></span><div class="fragmentname">&lt;&lt;Spectral Data Declarations&gt;&gt;+=&nbsp;<a href="#fragment-SpectralDataDeclarations-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">extern const Float <span class="anchor" id="RGBIllum2SpectWhite"></span>RGBIllum2SpectWhite[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBIllum2SpectCyan"></span>RGBIllum2SpectCyan[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBIllum2SpectMagenta"></span>RGBIllum2SpectMagenta[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBIllum2SpectYellow"></span>RGBIllum2SpectYellow[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBIllum2SpectRed"></span>RGBIllum2SpectRed[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBIllum2SpectGreen"></span>RGBIllum2SpectGreen[nRGB2SpectSamples];
extern const Float <span class="anchor" id="RGBIllum2SpectBlue"></span>RGBIllum2SpectBlue[nRGB2SpectSamples];</div><p>


</p>
<p>The fragment &lt;&lt;<span class="fragmentname">Compute RGB to spectrum functions for
  <tt>SampledSpectrum</tt></span>&gt;&gt;, which is called from
<a href="#SampledSpectrum::Init"><tt>SampledSpectrum::Init()</tt></a>, isn&rsquo;t included here; it initializes the
following <tt>SampledSpectrum</tt> values by resampling the
<tt>RGBRefl2Spect</tt> and <tt>RGBIllum2Spect</tt> distributions using the
<a href="#AverageSpectrumSamples"><tt>AverageSpectrumSamples()</tt></a> function.

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPrivateData-1"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Private Data&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPrivateData-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SampledSpectrumPrivateData-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbRefl2SpectWhite"></span>rgbRefl2SpectWhite, <span class="anchor" id="SampledSpectrum::rgbRefl2SpectCyan"></span>rgbRefl2SpectCyan;
static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbRefl2SpectMagenta"></span>rgbRefl2SpectMagenta, <span class="anchor" id="SampledSpectrum::rgbRefl2SpectYellow"></span>rgbRefl2SpectYellow;
static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbRefl2SpectRed"></span>rgbRefl2SpectRed, <span class="anchor" id="SampledSpectrum::rgbRefl2SpectGreen"></span>rgbRefl2SpectGreen;
static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbRefl2SpectBlue"></span>rgbRefl2SpectBlue;</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPrivateData-2"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Private Data&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPrivateData-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbIllum2SpectWhite"></span>rgbIllum2SpectWhite, <span class="anchor" id="SampledSpectrum::rgbIllum2SpectCyan"></span>rgbIllum2SpectCyan;
static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbIllum2SpectMagenta"></span>rgbIllum2SpectMagenta, <span class="anchor" id="SampledSpectrum::rgbIllum2SpectYellow"></span>rgbIllum2SpectYellow;
static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbIllum2SpectRed"></span>rgbIllum2SpectRed, <span class="anchor" id="SampledSpectrum::rgbIllum2SpectGreen"></span>rgbIllum2SpectGreen;
static SampledSpectrum <span class="anchor" id="SampledSpectrum::rgbIllum2SpectBlue"></span>rgbIllum2SpectBlue;</div><p>


</p>
<p>

</p>
<p>The <tt>SampledSpectrum::FromRGB()</tt><span class="anchor" id="Spectrum::FromRGB"></span> method converts
from the given RGB values to a full SPD.  In addition to the RGB values,
it takes an enumeration value that denotes whether the RGB value represents
surface reflectance or an illuminant; the corresponding 
<tt>rgbIllum2Spect</tt> or <tt>rgbRefl2Spect</tt> values are used for the
conversion.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumUtilityDeclarations-3"></span><div class="fragmentname">&lt;&lt;Spectrum Utility Declarations&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumUtilityDeclarations-2"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">enum class <span class="anchor" id="SpectrumType"></span>SpectrumType { <span class="anchor" id="SpectrumType::Reflectance"></span>Reflectance, <span class="anchor" id="SpectrumType::Illuminant"></span>Illuminant };</div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-1"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumMethodDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">SampledSpectrum <span class="anchor" id="SampledSpectrum::FromRGB"></span>SampledSpectrum::FromRGB(const Float rgb[3],
                                         <a href="#SpectrumType::Reflectance" class="code">SpectrumType</a> type) {
    SampledSpectrum r;
    if (type == <a href="#SpectrumType::Reflectance" class="code">SpectrumType</a>::Reflectance) {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-ConvertreflectancespectrumtoRGB-0">Convert reflectance spectrum to RGB</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-696" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-696"><i></i></a><div id="fragbit-696" class="collapse"><div class="fragmentcode">           if (rgb[0] &lt;= rgb[1] &amp;&amp; rgb[0] &lt;= rgb[2]) {
               &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputereflectancemonoSampledSpectrumwithmonorgb0asminimum-0">Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[0]</tt> as minimum</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-697" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-697"><i></i></a><div id="fragbit-697" class="collapse"><div class="fragmentcode">                  r += rgb[0] * <a href="#SampledSpectrum::rgbRefl2SpectWhite" class="code">rgbRefl2SpectWhite</a>;
                  if (rgb[1] &lt;= rgb[2]) {
                      r += (rgb[1] - rgb[0]) * <a href="#SampledSpectrum::rgbRefl2SpectCyan" class="code">rgbRefl2SpectCyan</a>;
                      r += (rgb[2] - rgb[1]) * <a href="#SampledSpectrum::rgbRefl2SpectBlue" class="code">rgbRefl2SpectBlue</a>;
                  } else {
                      r += (rgb[2] - rgb[0]) * <a href="#SampledSpectrum::rgbRefl2SpectCyan" class="code">rgbRefl2SpectCyan</a>;
                      r += (rgb[1] - rgb[2]) * <a href="#SampledSpectrum::rgbRefl2SpectGreen" class="code">rgbRefl2SpectGreen</a>;
                  }</div></div>
           } else if (rgb[1] &lt;= rgb[0] &amp;&amp; rgb[1] &lt;= rgb[2]) {
               &lt;&lt;<span class="fragmentname">Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[1]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-698" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-698"><i></i></a><div id="fragbit-698" class="collapse"><div class="fragmentcode">                  r += rgb[1] * rgbRefl2SpectWhite;
                  if (rgb[0] &lt;= rgb[2]) {
                      r += (rgb[0] - rgb[1]) * rgbRefl2SpectMagenta;
                      r += (rgb[2] - rgb[0]) * rgbRefl2SpectBlue;
                  } else {
                      r += (rgb[2] - rgb[1]) * rgbRefl2SpectMagenta;
                      r += (rgb[0] - rgb[2]) * rgbRefl2SpectRed;
                  }</div></div>
           } else {
               &lt;&lt;<span class="fragmentname">Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[2]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-699" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-699"><i></i></a><div id="fragbit-699" class="collapse"><div class="fragmentcode">                  r += rgb[2] * rgbRefl2SpectWhite;
                  if (rgb[0] &lt;= rgb[1]) {
                      r += (rgb[0] - rgb[2]) * rgbRefl2SpectYellow;
                      r += (rgb[1] - rgb[0]) * rgbRefl2SpectGreen;
                  } else {
                      r += (rgb[1] - rgb[2]) * rgbRefl2SpectYellow;
                      r += (rgb[0] - rgb[1]) * rgbRefl2SpectRed;
                  }</div></div>
           }
           </div></div>
    } else {
        &lt;&lt;<span class="fragmentname">Convert illuminant spectrum to RGB</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-700" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-700"><i></i></a><div id="fragbit-700" class="collapse"><div class="fragmentcode">           if (rgb[0] &lt;= rgb[1] &amp;&amp; rgb[0] &lt;= rgb[2]) {
               &lt;&lt;<span class="fragmentname">Compute illuminant <tt>SampledSpectrum</tt> with <tt>rgb[0]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-701" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-701"><i></i></a><div id="fragbit-701" class="collapse"><div class="fragmentcode">                  r += rgb[0] * rgbIllum2SpectWhite;
                  if (rgb[1] &lt;= rgb[2]) {
                      r += (rgb[1] - rgb[0]) * rgbIllum2SpectCyan;
                      r += (rgb[2] - rgb[1]) * rgbIllum2SpectBlue;
                  } else {
                      r += (rgb[2] - rgb[0]) * rgbIllum2SpectCyan;
                      r += (rgb[1] - rgb[2]) * rgbIllum2SpectGreen;
                  }</div></div>
           } else if (rgb[1] &lt;= rgb[0] &amp;&amp; rgb[1] &lt;= rgb[2]) {
               &lt;&lt;<span class="fragmentname">Compute illuminant <tt>SampledSpectrum</tt> with <tt>rgb[1]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-702" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-702"><i></i></a><div id="fragbit-702" class="collapse"><div class="fragmentcode">                  r += rgb[1] * rgbIllum2SpectWhite;
                  if (rgb[0] &lt;= rgb[2]) {
                      r += (rgb[0] - rgb[1]) * rgbIllum2SpectMagenta;
                      r += (rgb[2] - rgb[0]) * rgbIllum2SpectBlue;
                  } else {
                      r += (rgb[2] - rgb[1]) * rgbIllum2SpectMagenta;
                      r += (rgb[0] - rgb[2]) * rgbIllum2SpectRed;
                  }</div></div>
           } else {
               &lt;&lt;<span class="fragmentname">Compute illuminant <tt>SampledSpectrum</tt> with <tt>rgb[2]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-703" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-703"><i></i></a><div id="fragbit-703" class="collapse"><div class="fragmentcode">                  r += rgb[2] * rgbIllum2SpectWhite;
                  if (rgb[0] &lt;= rgb[1]) {
                      r += (rgb[0] - rgb[2]) * rgbIllum2SpectYellow;
                      r += (rgb[1] - rgb[0]) * rgbIllum2SpectGreen;
                  } else {
                      r += (rgb[1] - rgb[2]) * rgbIllum2SpectYellow;
                      r += (rgb[0] - rgb[1]) * rgbIllum2SpectRed;
                  }</div></div>
           }
           </div></div>
    }
    return r.<a href="../Utilities/Main_Include_File.html#Clamp" class="code">Clamp</a>();
}</div><p>


</p>
<p>Here we&rsquo;ll show the conversion process for reflectances.  The computation
for illuminants is the same, just using the different conversion values.
First, the implementation determines whether the red, green, or blue channel
is the smallest.

</p>
<p></p>
<span class="anchor" id="fragment-ConvertreflectancespectrumtoRGB-0"></span><div class="fragmentname">&lt;&lt;Convert reflectance spectrum to RGB&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (rgb[0] &lt;= rgb[1] &amp;&amp; rgb[0] &lt;= rgb[2]) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputereflectancemonoSampledSpectrumwithmonorgb0asminimum-0">Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[0]</tt> as minimum</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-704" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-704"><i></i></a><div id="fragbit-704" class="collapse"><div class="fragmentcode">       r += rgb[0] * <a href="#SampledSpectrum::rgbRefl2SpectWhite" class="code">rgbRefl2SpectWhite</a>;
       if (rgb[1] &lt;= rgb[2]) {
           r += (rgb[1] - rgb[0]) * <a href="#SampledSpectrum::rgbRefl2SpectCyan" class="code">rgbRefl2SpectCyan</a>;
           r += (rgb[2] - rgb[1]) * <a href="#SampledSpectrum::rgbRefl2SpectBlue" class="code">rgbRefl2SpectBlue</a>;
       } else {
           r += (rgb[2] - rgb[0]) * <a href="#SampledSpectrum::rgbRefl2SpectCyan" class="code">rgbRefl2SpectCyan</a>;
           r += (rgb[1] - rgb[2]) * <a href="#SampledSpectrum::rgbRefl2SpectGreen" class="code">rgbRefl2SpectGreen</a>;
       }</div></div>
} else if (rgb[1] &lt;= rgb[0] &amp;&amp; rgb[1] &lt;= rgb[2]) {
    &lt;&lt;<span class="fragmentname">Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[1]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-705" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-705"><i></i></a><div id="fragbit-705" class="collapse"><div class="fragmentcode">       r += rgb[1] * rgbRefl2SpectWhite;
       if (rgb[0] &lt;= rgb[2]) {
           r += (rgb[0] - rgb[1]) * rgbRefl2SpectMagenta;
           r += (rgb[2] - rgb[0]) * rgbRefl2SpectBlue;
       } else {
           r += (rgb[2] - rgb[1]) * rgbRefl2SpectMagenta;
           r += (rgb[0] - rgb[2]) * rgbRefl2SpectRed;
       }</div></div>
} else {
    &lt;&lt;<span class="fragmentname">Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[2]</tt> as minimum</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-706" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-706"><i></i></a><div id="fragbit-706" class="collapse"><div class="fragmentcode">       r += rgb[2] * rgbRefl2SpectWhite;
       if (rgb[0] &lt;= rgb[1]) {
           r += (rgb[0] - rgb[2]) * rgbRefl2SpectYellow;
           r += (rgb[1] - rgb[0]) * rgbRefl2SpectGreen;
       } else {
           r += (rgb[1] - rgb[2]) * rgbRefl2SpectYellow;
           r += (rgb[0] - rgb[1]) * rgbRefl2SpectRed;
       }</div></div>
}
</div><p>


</p>
<p>Here is the code for the case of a red component being the smallest.  (The
cases for green and blue are analogous and not included in the book here.)
If red is the smallest, we know that green and blue have greater values
than red.  As such, we can start to convert the final SPD to return by
assigning to it the value of the red component times the white spectrum in
<tt>rgbRefl2SpectWhite</tt>.  Having done this, the remaining RGB value left
to process is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.924ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6425.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma g minus r comma b minus r right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2034" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="3035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3487" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="3932" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4584" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="5584" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6036" y="0"></use>
</g>
</svg>.  The code in turn determines which of the
remaining two components is the smallest.  This value, times the cyan
(green and blue) spectrum, is added to the result and we&rsquo;re left with either
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.149ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4800.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma g minus b comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2034" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="3035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3465" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="3910" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4410" y="0"></use>
</g>
</svg> or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.149ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4800.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 comma b minus g right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2932" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="3933" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4410" y="0"></use>
</g>
</svg>.  Based on whether the green or blue channel
is non-zero, the green or blue SPD is scaled by the remainder and the
conversion is complete.

</p>
<p></p>
<span class="anchor" id="fragment-ComputereflectancemonoSampledSpectrumwithmonorgb0asminimum-0"></span><div class="fragmentname">&lt;&lt;Compute reflectance <tt>SampledSpectrum</tt> with <tt>rgb[0]</tt> as minimum&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">r += rgb[0] * <a href="#SampledSpectrum::rgbRefl2SpectWhite" class="code">rgbRefl2SpectWhite</a>;
if (rgb[1] &lt;= rgb[2]) {
    r += (rgb[1] - rgb[0]) * <a href="#SampledSpectrum::rgbRefl2SpectCyan" class="code">rgbRefl2SpectCyan</a>;
    r += (rgb[2] - rgb[1]) * <a href="#SampledSpectrum::rgbRefl2SpectBlue" class="code">rgbRefl2SpectBlue</a>;
} else {
    r += (rgb[2] - rgb[0]) * <a href="#SampledSpectrum::rgbRefl2SpectCyan" class="code">rgbRefl2SpectCyan</a>;
    r += (rgb[1] - rgb[2]) * <a href="#SampledSpectrum::rgbRefl2SpectGreen" class="code">rgbRefl2SpectGreen</a>;
}</div><p>


</p>
<p>

</p>
<p>
Given the method to convert from RGB, converting from XYZ color is easy.
We first convert from XYZ to RGB and then use the <tt>FromRGB()</tt> method.

</p>
<p></p>
<span class="anchor" id="fragment-SampledSpectrumPublicMethods-7"></span><div class="fragmentname">&lt;&lt;SampledSpectrum Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SampledSpectrumPublicMethods-6"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static SampledSpectrum <span class="anchor" id="SampledSpectrum::FromXYZ"></span>FromXYZ(const Float xyz[3],
        SpectrumType type = SpectrumType::Reflectance) {
    Float rgb[3];
    <a href="#XYZToRGB" class="code">XYZToRGB</a>(xyz, rgb);
    return <a href="#SampledSpectrum::FromRGB" class="code">FromRGB</a>(rgb, type);
}</div><p>


</p>
<p>

</p>
<p>Finally, we provide a constructor that converts from an instance of the
<a href="../Color_and_Radiometry/RGBSpectrum_Implementation.html#RGBSpectrum"><tt>RGBSpectrum</tt></a>
class, again using the infrastructure above.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-2"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="RGBSpectrum_Implementation.html#fragment-SpectrumMethodDefinitions-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#SampledSpectrum::FromRGB" class="code">SampledSpectrum</a>::<a href="#SampledSpectrum::FromRGB" class="code">SampledSpectrum</a>(const RGBSpectrum &amp;r, SpectrumType t) {
    Float rgb[3];
    r.<a href="../Color_and_Radiometry/RGBSpectrum_Implementation.html#RGBSpectrum::ToRGB" class="code">ToRGB</a>(rgb);
    *this = <a href="#SampledSpectrum::FromRGB" class="code">SampledSpectrum</a>::FromRGB(rgb, t);
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md">
  <div class="container-fluid-nav">
    <!--  <ul class="nav navbar-nav navbar-center"> -->
      <span class="navbar-text" style="text-align: center;">
        Thanks to Joakim Dahl and 34 others for generously supporting <i>Physically
        Based Rendering</i> online
        through <a href="https://patreon.com/pbrbook">Patreon</a>.
    </span>
  </div>
</nav>

<nav class="navbar navbar-expand-md">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>, &copy; 2004-2021 Matt Pharr, Wenzel Jakob, and Greg Humphreys under the <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a> license. (<a href="https://github.com/mmp/pbr-book-website/">github</a>)</span>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Color_and_Radiometry/RGBSpectrum_Implementation.html">Color and Radiometry / RGBSpectrum Implementation</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
